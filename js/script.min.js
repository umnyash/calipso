"use strict";const DESKTOP_WIDTH_MEDIA_QUERY="(min-width: 1346px)",LAPTOP_WIDTH_MEDIA_QUERY="(min-width: 1260px)",WIDE_TABLET_WIDTH_MEDIA_QUERY="(min-width: 1024px)",KeyCode=Object.freeze({LEFT_ARROW:"ArrowLeft",RIGHT_ARROW:"ArrowRight",DOWN_ARROW:"ArrowDown",UP_ARROW:"ArrowUp",SPACE:"Space",ESCAPE:"Escape"}),pageInnerElement=document.querySelector(".page__inner");function togglePageScroll(){pageInnerElement.classList.toggle("scroll-lock")}function isDownArrowEvent(e){return e.code===KeyCode.DOWN_ARROW}function isEscapeEvent(e){return e.code===KeyCode.ESCAPE}function isLeftArrowEvent(e){return e.code===KeyCode.LEFT_ARROW}function isRightArrowEvent(e){return e.code===KeyCode.RIGHT_ARROW}function isSpaceEvent(e){return e.code===KeyCode.SPACE}function isUpArrowEvent(e){return e.code===KeyCode.UP_ARROW}function createElementByString(e){const t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function getPaginationButtonCreator(e="Слайд"){return(t,n)=>`\n    <button class='${n}' type='button'>\n      <span class='visually-hidden'>${e} ${t+1}.</span>\n    </button>\n  `}function debounce(e,t=500){let n;return(...i)=>{clearTimeout(n),n=setTimeout((()=>e.apply(this,i)),t)}}function throttle(e,t){let n,i=0;return(...o)=>{const r=new Date;clearTimeout(n),n=setTimeout((()=>e.apply(this,o)),t),r-i>=t&&(e.apply(this,o),i=r)}}function getDigitsFromString(e){return e.replace(/\D/g,"")}function showAlert(e,t){const n=createElementByString(`\n    <div class="modal modal--with_alert">\n      <div class="modal__inner">\n        <button class="modal__close-button" type="button">\n          <span class="visually-hidden">Закрыть</span>\n        </button>\n        <section class="alert modal__alert ${"error"===t.status?"alert--error":""}">\n          <h2 class="alert__heading">${t.heading}</h2>\n          ${t.text?`<p class="alert__text">${t.text}</p>`:""}\n          <button class="button alert__button button--secondary" type="button">${t.buttonText||"Закрыть"}</button>\n        </section>\n      </div>\n    </div>\n  `);document.body.append(n),e(n)}function initAllBrands(e){const t=e.querySelector(".all-brands__form"),n=t.querySelector(".text-field__control"),i=t.querySelector(".text-field__clear-button"),o={};function r(e){for(const t in o){const n=o[t];let i=!1;n.links.forEach((t=>{t.textContent.toLowerCase().includes(e.toLowerCase())?(t.parentElement.classList.remove("all-brands__item--hidden"),i=!0):t.parentElement.classList.add("all-brands__item--hidden")})),i?n.group.classList.remove("all-brands__group--hidden"):n.group.classList.add("all-brands__group--hidden")}}e.querySelectorAll(".all-brands__group").forEach((e=>{const t=e.querySelector(".all-brands__group-name").textContent;o[t]={group:e,links:e.querySelectorAll(".all-brands__link")}})),t.addEventListener("submit",(function(e){e.preventDefault()})),n.addEventListener("input",(function({target:e}){r(e.value.trim().toLowerCase())})),i.addEventListener("click",(function(e){e.preventDefault(),n.value="",r("")}))}async function sendData(e,t,n=(()=>{}),i=(()=>{}),o=(()=>{})){try{const i=await fetch(e,{method:"POST",body:t});if(!i.ok)throw new Error(`${i.status} – ${i.statusText}`);try{n(await i.json())}catch(e){n()}}catch(e){i()}finally{o()}}function createArticlePreviewTemplate(e,t){const n=new Intl.DateTimeFormat("ru",{year:"numeric",month:"long",day:"numeric"}).format(Date.parse(e.date)).replace(/ г.$/,"");return`\n    <li class="article-preview ${t||""}">\n      <h3 class="article-preview__heading">\n        <a class="article-preview__link" href="${e.href}">${e.title}</a>\n      </h3>\n      <p class="article-preview__label">${e.type}</p>\n      <picture class="article-preview__image-wrapper">\n        <img class="article-preview__image" src="${e.image}" alt="" loading="lazy"/>\n      </picture>\n      <time class="article-preview__date" datetime="${e.date}">${n}</time>\n    </li>\n  `}function initArticlesSlider(e){const t=e.querySelector(".articles__slider"),n=e.querySelector(".articles__slider-arrows .slider-arrows__button--prev"),i=e.querySelector(".articles__slider-arrows .slider-arrows__button--next"),o=new Swiper(t,{slidesPerView:"auto",spaceBetween:15,navigation:{prevEl:n,nextEl:i},breakpoints:{768:{slidesPerView:4,spaceBetween:20},1346:{slidesPerView:4,spaceBetween:30},1900:{slidesPerView:4,spaceBetween:40}}}),r=e.querySelector(".articles__filter"),s=e.querySelectorAll(".articles__slider-item");r.addEventListener("change",(e=>{const t=e.target.value;s.forEach((e=>{e.classList.toggle("articles__slider-item--hidden",!(e.dataset.tag===t||"all"===t))})),o.update()}))}function initBanners(e){const t=e.querySelector(".banners__slider"),n=e.querySelector(".banners__thumbnails-slider"),i=n.querySelectorAll(".banners__thumbnail"),o=new Swiper(n,{spaceBetween:5,slidesPerView:"auto",watchSlidesProgress:!0});new Swiper(t,{effect:"fade",fadeEffect:{crossFade:!0},loop:!0,autoplay:{delay:6e3,disableOnInteraction:!1},thumbs:{swiper:o,slideThumbActiveClass:"banners__thumbnails-item--active"}}).on("autoplayTimeLeft",((e,t,n)=>{i.forEach((e=>{e.style.setProperty("--thumbnail-progress",1-n)}))}))}function initButtonPrintPdf(e){const t=e.dataset.url;e.addEventListener("click",(()=>{e.disabled=!0,e.classList.add("document-actions__button--pending");const n=document.createElement("iframe");n.style.display="none",n.addEventListener("load",(()=>{n.contentWindow.print(),e.classList.remove("document-actions__button--pending"),e.disabled=!1})),n.src=t,document.body.appendChild(n)}))}function showCartResult({heading:e,text:t,buttonText:n,buttonHref:i}){const o=document.querySelector(".cart__inner");o.querySelector(".cart__heading").remove(),o.querySelector(".cart__form").remove(),o.insertAdjacentHTML("beforeend",`\n    <div class="cart-result">\n      <div class="cart-result__inner container">\n        <h1 class="cart-result__heading heading">${e}</h1>\n        <p class="cart-result__text">${t}</p>\n        <a class="button cart-result__button button--primary" href="${i}">${n}</a>\n      </div>\n    </div>\n  `)}function resetCartForm(){document.querySelector(".cart-form").reset()}class Cart{#e=null;#t=null;#n=null;#i=null;#o=null;#r=null;#s=null;#l=null;#a=null;formElement=null;#c=null;#d=null;#u=null;#m=null;#p=null;#h=null;#_=null;#f=null;#g=null;#S=null;#E=null;#b=null;constructor({cartElement:e,openModal:t,showAlert:n,onCartFormSuccessSubmit:i,onCartFormErrorSubmit:o}){this.#t=e,this.#n=t,this.#i=n,this.#o=i,this.#r=o,this.formElement=this.#t.querySelector(".cart-form"),this.#s=this.#t.querySelector(".page-heading .heading")}#v=async(e,t,n,i,o)=>{try{const i=await fetch(e,{method:"POST",body:t});if(!i.ok)throw new Error(`${i.status} – ${i.statusText}`);n(await i.json())}catch(e){i(e)}finally{o()}};#y=()=>{this.formElement.classList.add("cart-form--checkout"),this.#c.classList.add("cart-form__info--checkout"),this.#s.textContent="Оформление заказа",this.#E.forEach((e=>{e.querySelector('input[type="checkbox"]').checked?e.classList.add("cart-item--checkout"):e.parentElement.classList.add("cart-form__products-item--hidden")})),setTimeout((()=>{this.#l.scrollTo({top:this.#S.offsetTop-this.#e.offsetHeight,behavior:"smooth"})}),100)};#w=()=>{this.#a.querySelector(".cart__heading").remove(),this.formElement.remove()};showResult=({heading:e,text:t,buttonText:n,buttonHref:i})=>{this.#w(),this.#a.insertAdjacentHTML("beforeend",`\n      <div class="cart-result">\n        <div class="cart-result__inner container">\n          <h1 class="cart-result__heading heading">${e}</h1>\n          <p class="cart-result__text">${t}</p>\n          <a class="button cart-result__button button--primary" href="${i}">${n}</a>\n        </div>\n      </div>\n    `)};#q(){const e=this.formElement.querySelector(".cart-form__item--name .text-field__control"),t=this.formElement.querySelector(".cart-form__item--phone .text-field__control"),n=this.formElement.querySelector(".cart-form__item--email .text-field__control"),i=this.formElement.querySelector(".cart-form__item--city .text-field__control"),o=this.formElement.querySelector(".cart-form__item--street .text-field__control"),r=this.formElement.querySelector(".cart-form__item--house .text-field__control");e&&(e.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),e.dataset.pristineRequiredMessage="Заполните это поле.",e.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),t&&(t.dataset.pristineRequiredMessage="Заполните это поле."),n&&(n.dataset.pristineRequiredMessage="Заполните это поле.",n.dataset.pristineEmailMessage="Введите корректный e-mail адрес."),i&&(i.dataset.pristineRequiredMessage="Заполните это поле."),o&&(o.dataset.pristineRequiredMessage="Заполните это поле."),r&&(r.dataset.pristineRequiredMessage="Заполните это поле.")}#C=()=>{this.#b=new Pristine(this.formElement,{classTo:"cart-form__item",errorClass:"invalid",errorTextParent:"cart-form__item",errorTextTag:"p",errorTextClass:"prompt-text"})};#F=()=>{this.#l.scrollHeight-this.#l.scrollTop===this.#l.clientHeight?this.#c.classList.remove("cart-form__info--sticked"):this.#c.classList.add("cart-form__info--sticked")};#x=throttle(this.#F,100);#L=throttle(this.#F,100);#M=e=>{const t=e.target.closest(".cart-form__checkout-link"),n=e.target.closest(".cart-form__promocode-button"),i=e.target.closest(".cart-form__choose-all-button"),o=e.target.closest(".text-field__clear-button"),r=e.target.closest(".counter__button");if(t)return e.preventDefault(),this.#y(),void this.#F();if(n)this.#d.classList.toggle("cart-form__promocode--hidden");else{if(i){const e=this.formElement.querySelectorAll(".cart-item__checkbox .checker__control");let t=i.classList.contains("cart-form__choose-all-button--active");return e.forEach((e=>{e.checked=!t,e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0}))})),void this.#_.classList.toggle("cart-form__choose-all-button--active",!t)}if(o){const e=o.closest(".text-field").querySelector(".text-field__control");return e.value="",void e.focus()}if(r){const e=r.closest(".counter").querySelector(".counter__control"),t=e.value;r.classList.contains("counter__button--plus")?e.stepUp():e.stepDown(),t!==e.value&&(e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})))}}};#k=()=>{const e=this.formElement.querySelectorAll(".cart-item__checkbox .checker__control"),t=Array.from(e).filter((e=>e.checked)),n=e.length===t.length;this.#_.classList.toggle("cart-form__choose-all-button--active",n),this.#g.disabled=!t.length};#T=e=>{e.target.closest(".cart-item__checkbox")&&this.#k()};#R=({target:e})=>{e.closest(".cart-form__receiving-radiobutton--pickup")?(this.#h.classList.remove("cart-form__section-inner-group--hidden"),this.#p.remove(),this.#C()):(this.#h.classList.add("cart-form__section-inner-group--hidden"),this.#u.appendChild(this.#p),this.#C())};#A=()=>{resetCartForm(),showCartResult({heading:"Heading",text:"text",buttonText:"button",buttonHref:"#"})};#P=()=>{this.#i(this.#n,{status:"error",heading:"Ошибка",text:"Текст ошибки."})};#D=e=>{e.preventDefault();const t="button--pending",n=this.#b.validate(),i=this.formElement.getAttribute("action");if(n)this.#f.disabled=!0,this.#f.classList.add(t),this.#v(i,new FormData(e.target),(e=>{(this.#o??this.#A)(e)}),(e=>{(this.#r??this.#P)(e)}),(()=>{this.#f.disabled=!1,this.#f.classList.remove(t)}));else{const e=this.formElement.querySelector(".invalid");e.querySelector("input").focus(),this.#l.scrollTo({top:e.offsetTop-this.#e.offsetHeight,behavior:"smooth"})}};initForm(){this.#e=document.querySelector(".site-header"),this.#l=document.querySelector(".page__inner"),this.#a=this.#t.querySelector(".cart__inner"),this.#c=this.formElement.querySelector(".cart-form__info"),this.#_=this.formElement.querySelector(".cart-form__choose-all-button"),this.#u=this.formElement.querySelector(".cart-form__section--receiving .cart-form__section-inner"),this.#m=this.#u.querySelector(".cart-form__radiobuttons-list--receiving"),this.#p=this.#u.querySelector(".cart-form__section-inner-group--delivery"),this.#h=this.#u.querySelector(".cart-form__section-inner-group--pickup"),this.#d=this.#c.querySelector(".cart-form__promocode"),this.#f=this.formElement.querySelector(".cart-form__submit-button"),this.#g=this.formElement.querySelector(".cart-form__checkout-link"),this.#S=this.formElement.querySelector(".cart-form__section--checkout"),this.#E=this.formElement.querySelectorAll(".cart-item"),this.#q(),this.#C(),this.formElement.addEventListener("click",this.#M),this.formElement.addEventListener("change",this.#T),this.#m.addEventListener("change",this.#R),this.formElement.addEventListener("submit",this.#D),this.#l.addEventListener("scroll",this.#x),window.addEventListener("resize",this.#L),this.#k(),this.#F()}}function initCart(e,t,n,i,o){const r=new Cart({cartElement:e,openModal:t,showAlert:n,onCartFormSuccessSubmit:i,onCartFormErrorSubmit:o});return r.formElement&&r.initForm(),r}class CatalogFiltersModal{#$=new Event("change",{bubbles:!0});#B=new Event("input",{bubbles:!0});#I=null;#H=null;#n=null;#V=null;#O=null;#W=null;#G=null;#j=null;#z=null;#N=null;constructor({modalElement:e,initScrollContainer:t,openModal:n,toggleFoldState:i}){this.#I=e,this.#H=t,this.#n=n,this.#V=i}#U=(e,t,n)=>`<li class="catalog__applied-filter">${e}\n      <button class="catalog__applied-filter-reset-button" data-field-name="${t}" data-field-value="${n}">\n        <span class="visually-hidden">Удалить фильтр</span>\n      </button>\n    </li>`;#K=()=>{const e=[],t=[];this.#j.forEach((n=>{if(!("checkbox"===n.type||"radio"===n.type?n.checked:n.value))return;const i=n.name;let o="";const r=n.value;if(n.dataset.rangeLimit){const e=n.closest(".catalog-filters__folds-item--range"),i=e.dataset.rangeName;if(t.includes(i))return;let r=null,s=null;"min"===n.dataset.rangeLimit?(r=n.value,s=e.querySelector('.number-range__field-control[data-range-limit="max"]').value):(r=e.querySelector('.number-range__field-control[data-range-limit="min"]').value,s=n.value),o=r&&s?`${i} от ${r} до ${s}`:r?`${i} от ${r}`:s?`${i} до ${s}`:"",t.push(i)}else{o=n.closest(".checker, .color").querySelector(".checker__label, .color__name").textContent}const s=this.#U(o,i,r);e.push(s)})),this.#z.innerHTML="";const n=e.join("");this.#z.insertAdjacentHTML("beforeend",n)};#Q=()=>{const e=new Map;this.#j.forEach((t=>{const n="checkbox"===t.type||"radio"===t.type?t.checked:t.value;e.set(t,n)})),this.#N=e};#Y=()=>{this.#N.forEach(((e,t)=>{"checkbox"===t.type||"radio"===t.type?t.checked=e:t.value=e,t.dispatchEvent(this.#$)}))};#J=e=>{e.preventDefault(),this.#Y(),this.#n(this.#I);const t=e.target.dataset.foldName;if(t){const e=this.#O.querySelector(`[data-fold-name="${t}"]`);"true"!==e.ariaExpanded&&this.#V(e);const n=this.#W.scrollHeight-this.#W.offsetHeight;if(n>0){const t=Math.min(n,e.offsetTop);this.#G.setTranslate(-t)}setTimeout((()=>this.#G.update()),300)}};#X=e=>{const t=e.target.closest(".catalog-filter__box-toggle-button"),n=e.target.closest(".catalog-filters__folds-button");if(t){t.closest(".catalog-filter__box").classList.toggle("catalog-filter__box--expand"),setTimeout((()=>this.#G.update()),300)}else n&&setTimeout((()=>this.#G.update()),300)};#Z=e=>{const t=e.target.closest(".catalog-filters__folds-item");if(t)if(t.classList.contains("catalog-filters__folds-item--range")){const e=t.querySelector('.number-range__field-control[data-range-limit="min"]'),n=t.querySelector('.number-range__field-control[data-range-limit="max"]'),i=e.value,o=n.value,r=t.querySelector(".catalog-filters__folds-value-label"),s=t.dataset.rangeName;r.textContent=i&&o?`${s} от ${i} до ${o}`:i?`${s} от ${i}`:o?`${s} до ${o}`:""}else if(t.classList.contains("catalog-filters__folds-item--checkers")){const e=t.querySelector(".catalog-filters__folds-value-label"),n=Array.from(t.querySelectorAll(".checker, .color"));e.textContent=n.filter((e=>e.querySelector("input").checked)).map((e=>e.querySelector(".checker__label, .color__name").textContent)).join(", ")}};#ee=()=>{this.#Q(),this.#K()};#te=()=>{setTimeout((()=>{this.#j.forEach((e=>{e.dispatchEvent(this.#$)}))}),0)};#ne=e=>{const t=e.target.closest(".catalog__applied-filter-reset-button");if(!t)return;const n=t.parentElement,i=t.dataset.fieldName,o=this.#j.filter((e=>e.name===i));if(o[0].dataset.rangeLimit){o[0].closest(".catalog-filters__folds-item--range").querySelectorAll("input").forEach((e=>{e.value="",e.dispatchEvent(this.#B)}))}else if("checkbox"===o[0].type||"radio"===o[0].type){const e=t.dataset.fieldValue,n=Array.from(o).find((t=>t.value===e));n.checked=!1,n.dispatchEvent(this.#B)}n.remove(),this.#Q()};init=()=>{this.#O=this.#I.querySelector(".catalog-filters"),this.#W=this.#O.querySelector(".catalog-filters__scroll-container"),this.#G=this.#H(this.#W),this.#j=Array.from(this.#O.querySelectorAll("input")),this.#z=document.querySelector(".catalog__applied-filters"),this.#Q();document.querySelectorAll(".catalog__filter-opener-button").forEach((e=>{e.addEventListener("click",this.#J)})),this.#O.addEventListener("click",this.#X),this.#O.addEventListener("change",this.#Z),this.#O.addEventListener("submit",this.#ee),this.#O.addEventListener("reset",this.#te),this.#z.addEventListener("click",this.#ne)}}function initCatalogFiltersModal(e,t,n,i){const o=new CatalogFiltersModal({modalElement:e,initScrollContainer:t,openModal:n,toggleFoldState:i});return o.init(),o}function initCatalogSorting(e){const t=e.querySelector(".catalog-sorting__toggle-button"),n=e.querySelector(".catalog-sorting__close-button");t.addEventListener("click",(t=>{t.preventDefault(),e.classList.toggle("catalog-sorting--open")})),n.addEventListener("click",(t=>{t.preventDefault(),e.classList.remove("catalog-sorting--open")}))}class CitiesModal{#I=null;#H=null;#n=null;#ie=null;#oe=null;#re=null;#se=null;#le=null;#ae=null;constructor({modalElement:e,initScrollContainer:t,openModal:n}){this.#I=e,this.#H=t,this.#n=n}open=e=>{e.preventDefault();const t=e.target.closest(".popup");t&&t.remove(),this.#n(this.#I),this.#I.querySelector("input").focus()};#M=e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",this.#re.classList.remove("cities__scroll-container--hidden"),e.focus()}};init(){this.#ie=this.#I.querySelector(".cities__form"),this.#oe=this.#I.querySelector(".cities__list--found"),this.#re=this.#I.querySelector(".cities__scroll-container--popular"),this.#se=this.#I.querySelector(".cities__scroll-container--found"),this.#le=this.#H(this.#re),this.#ae=this.#H(this.#se),this.#ie.addEventListener("click",this.#M);new MutationObserver((()=>{this.#le.update(),this.#ae.update()})).observe(this.#oe,{subtree:!0,characterData:!0,attributes:!0,childList:!0}),document.querySelectorAll('[data-modal-opener="cities"]').forEach((e=>{e.addEventListener("click",this.open)}))}}function initCitiesModal(e,t,n){const i=new CitiesModal({modalElement:e,initScrollContainer:t,openModal:n});return i.init(),i}function initCooperationModal(e,t,n,i,o,r,s){r(e,t,n,i,o,{success:{heading:"Спасибо! Ваша заявка успешно отправлена",text:"Наш менеджер свяжется с вами в течении 3 рабочих дней для обсуждения деталей"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}},s)}function initDateField(e,t){const n=e.querySelector(".text-field__control"),i=e.querySelector(".text-field__calendar-button");let o=null;const r=new AirDatepicker(e,{classes:"calendar text-field__calendar",dateFormat:"dd.MM.yyyy",minDate:e.closest('[data-modal="salon"]')?Date.now():"",navTitles:{classes:"text-field__calendar",days:'MMMM <span class="calendar__title-accent">yyyy</span>',weekends:[0,6]},onSelect({formattedDate:e}){n.value=e||"",n.dispatchEvent(new Event("input")),l()}});function s(e){e&&r.selectDate(e,{updateTime:!1,silent:!0})}function l(){o.classList.remove("text-field__calendar--open"),document.removeEventListener("click",d),i.classList.remove("text-field__calendar-button--active")}function a(){o.classList.contains("text-field__calendar--open")?l():(s(c(n.value)),r.setViewDate(c(n.value)||Date.now()),r.setCurrentView("days"),o.classList.add("text-field__calendar--open"),document.addEventListener("click",d),i.classList.add("text-field__calendar-button--active"))}function c(e){return e.split(".").reverse().join("-")}function d({target:e}){e.closest(".text-field--date")||e.closest(".calendar__title-accent")||l()}o=e.querySelector(".text-field__calendar"),n.addEventListener("input",(()=>{if(!n.value)return;const e=c(n.value);s(e),o.classList.contains("text-field__calendar--open")&&(r.setViewDate(e),r.setCurrentView("days"))})),i.addEventListener("click",(()=>{a()})),n.addEventListener("keydown",(e=>{isSpaceEvent(e)&&(e.preventDefault(),a())})),t(n)}function initDocumentModal(e,t){const n=e.dataset.modal;document.querySelectorAll(`[data-modal-opener="${n}"]`).forEach((n=>{n.addEventListener("click",(n=>{n.preventDefault(),t(e)}))}))}function initFeed(e){const t=e.querySelector(".swiper"),n=e.querySelector(".slider-arrows__button--prev"),i=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:10,navigation:{prevEl:n,nextEl:i},breakpoints:{1900:{spaceBetween:16}}})}function initFeedbackForm(e,t,n,i,o){const r="button--pending",s=e.querySelector(".feedback-form__item--name .text-field__control"),l=e.querySelector(".feedback-form__item--email .text-field__control"),a=e.querySelector(".feedback-form__item--phone .text-field__control"),c=e.querySelector(".feedback-form__item--comment .textarea__control"),d=e.querySelector(".feedback-form__submit-button"),u=e.getAttribute("action");s&&(s.pattern=/^[a-zа-яЁё -]+$/i,s.dataset.pristineRequiredMessage="Заполните это поле.",s.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),a&&(a.dataset.pristineRequiredMessage="Заполните это поле."),l&&(l.dataset.pristineRequiredMessage="Заполните это поле.",l.dataset.pristineEmailMessage="Введите корректный e-mail адрес."),c&&(c.dataset.pristineRequiredMessage="Заполните это поле.");const m=new Pristine(e,{classTo:"feedback-form__item",errorClass:"invalid",errorTextParent:"feedback-form__item",errorTextTag:"p",errorTextClass:"prompt-text"});const p=o??function(){i(n,{heading:"Спасибо за обратную связь!"})};e.addEventListener("click",(e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",e.focus()}})),e.addEventListener("submit",(o=>{o.preventDefault();m.validate()?(d.disabled=!0,d.classList.add(r),t(u,new FormData(o.target),(t=>{e.reset(),p(t)}),(()=>{i(n,{status:"error",heading:"Ошибка",text:"Не удалось отправить сообщение, попробуйте снова."})}),(()=>{d.disabled=!1,d.classList.remove(r)}))):(e.classList.remove("feedback-form--error"),setTimeout((()=>e.classList.add("feedback-form--error")),50))}))}function initFeedbackModal(e,t,n,i,o,r,s){r(e,t,n,i,o,{success:{heading:"Заявка успешно отправлена",text:"Наш менеджер свяжется с вами"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}},s)}function initFileField(e){const t=e.querySelector(".file-field__control");e.addEventListener("change",(({target:t})=>{e.classList.toggle("file-field--empty",!t.value)})),e.addEventListener("click",(({target:n})=>{n.closest(".file-field__reset-button")&&(e.classList.add("file-field--empty"),t.value="")}))}function initFilterSlider(e){new Swiper(e,{slidesPerView:"auto",spaceBetween:10,breakpoints:{1346:{spaceBetween:20}}})}function toggleFoldState(e){const t=e.closest(".folds__item"),n=t.querySelector(".folds__content-wrapper"),i=n.querySelector(".folds__content").getBoundingClientRect().height;n.style.height=`${i}px`,setTimeout((()=>{t.classList.toggle("folds__item--open")}),20),e.ariaExpanded="true"===e.ariaExpanded?"false":"true"}function initFolds(e){e.addEventListener("click",(({target:e})=>{const t=e.closest(".folds__button");t&&toggleFoldState(t)})),e.addEventListener("transitionend",(({target:e})=>{const t=e.closest(".folds__item");t&&t.classList.contains("folds__item--open")&&e.classList.contains("folds__content-wrapper")&&setTimeout((()=>{e.style.height="auto"}),0)}))}function createGalleryModalTemplate(e){return`\n    <div class="modal modal--with_gallery modal--with_review-gallery">\n      <div class="modal__inner">\n        <button class="modal__close-button" type="button"><span class="visually-hidden">Закрыть</span></button>\n        <div class="gallery modal__gallery">\n          <div class="gallery__inner">\n            <div class="gallery__slider">\n              <ul class="slider-arrows gallery__slider-arrows slider-arrows--with-background">\n                <li class="slider-arrows__item">\n                  <button class="slider-arrows__button slider-arrows__button--prev" type="button"><span class="visually-hidden">Предыдущий</span></button>\n                </li>\n                <li class="slider-arrows__item">\n                  <button class="slider-arrows__button slider-arrows__button--next" type="button"><span class="visually-hidden">Следующий</span></button>\n                </li>\n              </ul>\n              <div class="gallery__slider-wrapper swiper">\n                <ul class="gallery__slider-list swiper-wrapper">\n                  ${e.map((e=>`\n                    <li class="gallery__slider-item swiper-slide">\n                      ${"video"===e.type?`\n                        <div class="video gallery__video">\n                          <video class="video__player" src="${e.src}" playsinline controls></video>\n                          <img class="video__poster" src="${e.posterSrc}" alt="">\n                          <div class="video__play-button-wrapper">\n                            <button class="video__play-button"><span class="visually-hidden">Воспроизвести</span></button>\n                          </div>\n                        </div>\n                      `:`\n                        <picture class="gallery__image-wrapper">\n                          <img class="gallery__image" src="${e.src}" alt="">\n                        </picture>\n                      `}\n                    </li>\n                  `)).join("")}\n                </ul>\n              </div>\n            </div>\n            <div class="gallery__thumbnails-slider">\n              <ul class="slider-arrows gallery__thumbnails-slider-arrows">\n                <li class="slider-arrows__item">\n                  <button class="slider-arrows__button slider-arrows__button--prev" type="button"><span class="visually-hidden">Предыдущий</span></button>\n                </li>\n                <li class="slider-arrows__item">\n                  <button class="slider-arrows__button slider-arrows__button--next" type="button"><span class="visually-hidden">Следующий</span></button>\n                </li>\n              </ul>\n              <div class="gallery__thumbnails-slider-wrapper swiper">\n                <ul class="gallery__thumbnails-slider-list swiper-wrapper">\n                  ${e.map((e=>`\n                    <li class="gallery__thumbnails-slider-item swiper-slide">\n                      ${"video"===e.type?`\n                        <div class="gallery__image-wrapper gallery__image-wrapper--video">\n                          <img class="gallery__thumbnails-image" src="${e.posterSrc}" alt=""/>\n                        </div>\n                      `:`\n                        <picture class="gallery__image-wrapper">\n                          <img class="gallery__thumbnails-image" src="${e.src}" alt=""/>\n                        </picture>\n                      `}\n                    </li>\n                  `)).join("")}\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  `}class GalleryModal{#I=null;#n=null;#ce=null;constructor({content:e,openModal:t,initGallery:n,initVideo:i}){this.#n=t,this.#I=createElementByString(createGalleryModalTemplate(e)),document.body.append(this.#I),this.#ce=n(this.#I.querySelector(".gallery")),this.#I.querySelectorAll(".video").forEach(i)}open=(e=0)=>{this.#ce.slideTo(e,0),this.#n(this.#I)}}function initGallery(e){const t=e.querySelector(".gallery__slider-wrapper"),n=e.querySelector(".gallery__slider .slider-arrows__button--prev"),i=e.querySelector(".gallery__slider .slider-arrows__button--next"),o=e.querySelector(".gallery__thumbnails-slider-wrapper"),r=e.querySelector(".gallery__thumbnails-slider .slider-arrows__button--prev"),s=e.querySelector(".gallery__thumbnails-slider .slider-arrows__button--next"),l=t.querySelectorAll("video"),a=new Swiper(o,{spaceBetween:10,watchSlidesProgress:!0,slidesPerView:"auto",breakpoints:{768:{slidesPerView:3},1346:{spaceBetween:20}}});return new Swiper(t,{effect:"fade",fadeEffect:{crossFade:!0},navigation:{prevEl:[n,r],nextEl:[i,s]},thumbs:{swiper:a,slideThumbActiveClass:"gallery__thumbnails-slider-item--active"},on:{slideChange:()=>{l.forEach((e=>e.pause()))}}})}function setInputDateMask(e){function t(e){const t=getDigitsFromString(e);let n="";if(t.length){const e=+t[0];if(e<=3){if(n=e,t.length>1){const e=+t.substring(0,2);n=0===e?"01":e<=31?e.toString().padStart(2,"0"):31}if(t.length>2){const e=+t[2];if(e<=1){if(n=`${n}.${e}`,t.length>3){const e=t.substring(0,2),i=+t.substring(2,4);n=0===i?`${e}.01`:`${e}.${i<=12?i.toString().padStart(2,"0"):12}`}if(t.length>4){n+=`.${t.substring(4,8)}`}}else{if(n=`${t.substring(0,2)}.0${e}`,t.length>3){n+=`.${t.substring(3,7)}`}}}}else if(n=`0${e}`,t.length>1){const e=+t[1];if(e<=1){if(n=`${n}.${e}`,t.length>2){const e=t.substring(0,1).padStart(2,"0"),i=+t.substring(1,3);n=0===i?`${e}.01`:`${e}.${i<=12?i.toString().padStart(2,"0"):12}`}if(t.length>3){n+=`.${t.substring(3,7)}`}}else if(n=`${n}.0${e}`,t.length>2){n+=`.${t.substring(2,6)}`}}}return n}e.addEventListener("input",(n=>{(e.value.length===e.selectionStart||n.data&&/\D/g.test(n.data))&&(e.value=t(e.value))})),e.addEventListener("change",(()=>{e.value=t(e.value)}))}function initInstallmentRequestModal(e,t,n,i,o,r,s){r(e,t,n,i,o,{success:{heading:"Заявка успешно отправлена",text:"Наш менеджер свяжется с вами в течении 3 рабочих дней"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}},s)}async function initMap(e){const t=[44.008906,56.323592],n=e.querySelector(".map__inner");n.classList.remove("map__inner--hidden"),n.style.filter="grayscale(1)",await ymaps3.ready;const{YMap:i,YMapDefaultSchemeLayer:o,YMapMarker:r,YMapDefaultFeaturesLayer:s}=ymaps3,l=new i(n,{location:{center:t,zoom:15}});l.addChild(new o),l.addChild(new s);const a=new r({coordinates:t},document.querySelector("#map-marker-template").content.querySelector(".map-marker").cloneNode(!0)),c=setInterval((()=>{const t=e.querySelector("canvas");t&&(clearInterval(c),t.style.filter="grayscale(1)",n.style.filter="",l.addChild(a))}),1e3)}const MODAL_DISAPPEARANCE_TIME=100,openedModals=[];function openModal(e){e.classList.remove("modal--hidden"),openedModals.push(e),document.addEventListener("keydown",onModalEscapeEvent),document.addEventListener("click",onModalClick),setTimeout((()=>{e.classList.add("modal--open")}),100)}function closeModal(e){e.classList.remove("modal--error"),e.classList.remove("modal--open"),openedModals.pop(),openedModals.length||(document.removeEventListener("keydown",onModalEscapeEvent),document.removeEventListener("click",onModalClick)),setTimeout((()=>{e.classList.add("modal--hidden"),(e.classList.contains("modal--with_alert")||e.classList.contains("modal--with_review-gallery"))&&e.remove()}),MODAL_DISAPPEARANCE_TIME)}function onModalEscapeEvent(e){isEscapeEvent(e)&&(e.preventDefault(),closeModal(openedModals[openedModals.length-1]))}function onModalClick({target:e}){(e.classList.contains("modal__close-button")||e.classList.contains("alert__button"))&&closeModal(openedModals[openedModals.length-1])}function initNavigationShortcuts(e){const t=e.querySelector(".swiper");new Swiper(t,{slidesPerView:"auto",spaceBetween:10})}function initOneClickModal(e,t,n,i,o,r,s){r(e,t,n,i,o,{success:{heading:"Заявка успешно отправлена",text:"Наш менеджер свяжется с вами"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}},s)}class PhoneChangeModal{#de="button--pending";#ue=60;#me=0;#I=null;#n=null;#pe=null;#he=null;#_e=null;#fe=null;#ge=null;#Se=null;#Ee=null;#be=null;#ve=null;#ye=null;#we=null;#qe=null;#Ce=null;#Fe=null;#xe=null;#Le=null;#Me=null;#ke=null;#Te=null;#Re=null;#Ae=null;#Pe=null;constructor({modalElement:e,openModal:t,closeModal:n}){this.#I=e,this.#n=t,this.#pe=n}setRequestCodeTimeInterval=e=>{this.#ue=e};close=()=>{this.#pe(this.#I)};open=()=>{this.#n(this.#I)};setExternalPhone=e=>{this.#he&&(this.#he.value=e),this.#_e&&(this.#_e.textContent=e)};getPhoneFieldValue=()=>this.#Ee.value;resetCodeRequestForm=()=>{this.#fe.reset()};resetCodeSendingForm=()=>{this.#be.reset()};sendData=async(e,t,n,i,o)=>{try{const i=await fetch(e,{method:"POST",body:t});if(!i.ok)throw new Error(`${i.status} – ${i.statusText}`);n(await i.json())}catch(e){i(e)}finally{o()}};#q(){this.#Ee.dataset.pristineRequiredMessage="Заполните это поле.",this.#qe.dataset.pristineRequiredMessage="Заполните это поле."}#C=()=>{this.#Se=new Pristine(this.#fe,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"}),this.#ye=new Pristine(this.#be,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"})};finishWaitingForResend=()=>{this.#Ce.prepend(this.#Fe),this.#xe.remove()};startWaitingForResend=()=>{if(this.#me<=0){this.#me=this.#ue,this.#Le.textContent=this.#me;const e=setInterval((()=>{this.#me--,this.#Le.textContent=this.#me,this.#me<=0&&(clearInterval(e),this.finishWaitingForResend())}),1e3);this.#Fe.remove(),this.#Ce.prepend(this.#xe)}};goToCodeRequestForm=()=>{this.#fe.classList.remove("modal-form__form--hidden"),this.#be.classList.add("modal-form__form--hidden")};goToCodeSendingForm=()=>{this.#fe.classList.add("modal-form__form--hidden"),this.#be.classList.remove("modal-form__form--hidden");const e=this.#Ee.value.replace(/[()]/g,"").replace(/-/g," ");this.#we.textContent=e,this.startWaitingForResend()};#De=e=>{const t=e.target.closest(".text-field__clear-button"),n=e.target.closest(".modal-form__back-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");return e.value="",void e.focus()}n&&(e.preventDefault(),this.goToCodeRequestForm())};#$e=e=>{if(e.preventDefault(),this.#me>0)this.goToCodeSendingForm();else{const t=this.#fe.getAttribute("action");this.#Se.validate()?(this.#ge.disabled=!0,this.#ge.classList.add(this.#de),this.sendData(t,new FormData(e.target),this.#Me,this.#ke,(()=>{this.#ge.disabled=!1,this.#ge.classList.remove(this.#de)}))):(this.#I.classList.remove("modal--error"),setTimeout((()=>this.#I.classList.add("modal--error")),50))}};#Be=e=>{e.preventDefault(),this.#Fe.disabled=!0;const t=this.#fe.getAttribute("action");this.sendData(t,new FormData(this.#fe),this.#Te,this.#Re,(()=>{this.#Fe.disabled=!1}))};#Ie=e=>{e.preventDefault();const t=this.#be.getAttribute("action");this.#ye.validate()?(this.#ve.disabled=!0,this.#ve.classList.add(this.#de),this.sendData(t,new FormData(e.target),this.#Ae,this.#Pe,(()=>{this.#ve.disabled=!1,this.#ve.classList.remove(this.#de)}))):(this.#I.classList.remove("modal--error"),setTimeout((()=>this.#I.classList.add("modal--error")),50))};#He=e=>{e.preventDefault(),this.open()};setCodeRequestSubmitHandlers=(e,t)=>{this.#Me=e,this.#ke=t};setCodeReRequestSubmitHandlers=(e,t)=>{this.#Te=e,this.#Re=t};setCodeSendingSubmitHandlers=(e,t)=>{this.#Ae=e,this.#Pe=t};init(){this.#he=document.querySelector(".profile-form__item--phone .text-field__control"),this.#_e=document.querySelector(".account__phone"),this.#fe=this.#I.querySelector(".modal-form__form--code-request"),this.#ge=this.#fe.querySelector(".modal-form__submit-button"),this.#Ee=this.#fe.querySelector(".modal-form__item--tel .text-field__control"),this.#be=this.#I.querySelector(".modal-form__form--code-sending"),this.#ve=this.#be.querySelector(".modal-form__submit-button"),this.#we=this.#be.querySelector(".modal-form__phone-text"),this.#qe=this.#be.querySelector(".modal-form__item--code .text-field__control"),this.#Ce=this.#be.querySelector(".modal-form__footer"),this.#Fe=this.#be.querySelector(".modal-form__footer-button--resend-code"),this.#xe=this.#be.querySelector(".modal-form__footer-text--resend-code"),this.#Le=this.#xe.querySelector(".modal-form__footer-text-timer"),this.#q(),this.#C(),this.#I.addEventListener("click",this.#De),this.#fe.addEventListener("submit",this.#$e),this.#be.addEventListener("submit",this.#Ie),this.#Fe.addEventListener("click",this.#Be),document.querySelectorAll('[data-modal-opener="phone-change"]').forEach((e=>{e.addEventListener("click",this.#He)}))}}function initPhoneChangeModal(e,t,n){const i=new PhoneChangeModal({modalElement:e,openModal:t,closeModal:n});return i.init(),i}function initPremiumBrandsSlider(e){const t=e.querySelector(".swiper"),n=e.querySelector(".slider-arrows__button--prev"),i=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",loop:!0,navigation:{prevEl:n,nextEl:i}})}function createProductCardTemplate(e,t){const n=new Intl.NumberFormat("ru");let i=null,o=null;e.discount?(o=n.format(e.price),i=n.format(e.price*(100-e.discount)/100)):i=n.format(e.price);const r=Object.values(e.dimensions).join("х");return`\n    <article class="product-card product-card-popup__card ${t||""}">\n      <div class="product-card__heading-and-signs">\n        <h3 class="product-card__heading">\n          <a class="product-card__link" href="${e.href}">${e.title}</a>\n        </h3>\n        <p class="product-card__signs">${r}</p>\n      </div>\n      <div class="product-card__prices">\n        <p class="product-card__price ${e.discount?"accent":""}">${i} ₽</p>\n        ${e.discount?`<s class="product-card__old-price">${o} ₽</s><p class="producr-card__discount">-${e.discount}%</p>`:""}\n      </div>\n      <a class="product-card__slider swiper" href="${e.href}">\n        <ul class="product-card__slider-list swiper-wrapper">\n          ${e.images.map(((e,t)=>`\n            <li class="product-card__slider-item swiper-slide">\n              <img class="product-card__image" src="${e}" alt="" loading="lazy"/>\n            </li>\n          `)).join("")}\n        </ul>\n        <p class="product-card__slider-pagination"></p>\n      </a>\n      <div class="product-card__labels-wrapper">\n        <div class="product-card__labels">\n          ${e.isPremium?'<p class="product-card__premium-label"><span class="product-card__premium-label-text">Premium</span></p>':""}\n          ${"in-stock"===e.status?'<p class="product-card__label">В наличии</p>':""}\n          <p class="product-card__like-button-wrapper">\n            <button class="like-button product-card__like-button ${e.isFavorite?"like-button--active":""}" type="button">\n              <span class="visually-hidden">Нравится</span>\n            </button>\n          </p>\n        </div>\n      </div>\n      <a class="product-card__brand" href="${e.brandHref}">\n        Бренд <span class="product-card__brand-name">${e.brand}</span>\n      </a>\n    </article>\n  `}function initProductCard(e){const t=e.querySelector(".product-card__slider"),n=t.querySelector(".product-card__slider-pagination");new Swiper(t,{pagination:{el:n,bulletClass:"product-card__slider-pagination-button",bulletActiveClass:"product-card__slider-pagination-button--current",renderBullet:getPaginationButtonCreator()}})}function initProductHeaderStickyActionButtons(e){const t=document.querySelector(".page__inner"),n=()=>{t.scrollHeight-t.scrollTop===t.clientHeight?e.classList.remove("product-header__action-buttons--sticked"):e.classList.add("product-header__action-buttons--sticked")};t.addEventListener("scroll",throttle(n,100)),window.addEventListener("resize",throttle(n,100)),n()}function setSliderMode(e,t){e.itself.classList.add(e.modeClass,"swiper"),e.list.classList.add("swiper-wrapper"),e.slides.forEach((e=>e.classList.add("swiper-slide"))),e.swiper=new Swiper(e.itself,t)}function setSliderSimpleMode(e){setSliderMode(e,{pagination:{el:e.pagination,bulletClass:"product-images__slider-pagination-button",bulletActiveClass:"product-images__slider-pagination-button--current",renderBullet:getPaginationButtonCreator()},grabCursor:!0})}function resetSliderMode(e){e?.swiper?.destroy(!0,!0),e.itself.classList.remove("swiper"),e.list.classList.remove("swiper-wrapper"),e.slides.forEach((e=>{e.removeAttribute("aria-label"),e.removeAttribute("role"),e.classList.remove("swiper-slide")})),e.list.removeAttribute("aria-live"),e.pagination.innerHTML="",e.swiper=null}function initProductImages(e){const t={itself:e.querySelector(".product-images__slider"),list:e.querySelector(".product-images__slider-list"),slides:e.querySelectorAll(".product-images__slider-item"),pagination:e.querySelector(".product-images__slider-pagination")},n=window.matchMedia("(min-width: 1346px)"),i=()=>{n.matches?resetSliderMode(t):setSliderSimpleMode(t)};n.addEventListener("change",(()=>{i()})),i()}function initProductQuestionModal(e,t,n,i,o,r,s){r(e,t,n,i,o,{success:{heading:"Ваш вопрос успешно отправлен",text:"Наш менеджер свяжется с вами"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить вопрос, попробуйте снова."}},s)}function initProducts(e){const t=e.querySelector(".swiper"),n=e.querySelector(".slider-arrows__button--prev"),i=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:15,navigation:{prevEl:n,nextEl:i},breakpoints:{768:{spaceBetween:20},1346:{spaceBetween:30},1900:{spaceBetween:40}}})}function initProfileForm(e,t,n,i,o){const r="button--pending",s=e.querySelector(".profile-form__item--name .text-field__control"),l=e.querySelector(".profile-form__item--surname .text-field__control"),a=e.querySelector(".profile-form__item--patronymic .text-field__control"),c=e.querySelector(".profile-form__item--email .text-field__control"),d=e.querySelector(".profile-form__item--date .text-field__control"),u=e.querySelector(".profile-form__item--city .text-field__control"),m=e.querySelector(".profile-form__item--street .text-field__control"),p=e.querySelector(".profile-form__item--house .text-field__control"),h=e.querySelector(".profile-form__submit-button"),_=e.getAttribute("action");function f(){const t=[];return e.querySelectorAll("input").forEach((e=>{"checkbox"===e.type?t.push(e.checked):t.push(e.value.trim())})),t}s&&(s.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),s.dataset.pristineRequiredMessage="Заполните это поле.",s.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),l&&(l.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),l.dataset.pristineRequiredMessage="Заполните это поле.",l.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),a&&(a.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),a.dataset.pristineRequiredMessage="Заполните это поле.",a.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),c&&(c.dataset.pristineRequiredMessage="Заполните это поле.",c.dataset.pristineEmailMessage="Введите корректный e-mail адрес."),d&&(d.pattern=/^(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[0-2])\.\d{4}$/,d.dataset.pristineRequiredMessage="Заполните это поле.",d.dataset.pristinePatternMessage="Введите дату в формате дд.мм.гггг"),u&&(u.dataset.pristineRequiredMessage="Заполните это поле."),m&&(m.dataset.pristineRequiredMessage="Заполните это поле."),p&&(p.dataset.pristineRequiredMessage="Заполните это поле.");let g=f();const S=new Pristine(e,{classTo:"profile-form__item",errorClass:"invalid",errorTextParent:"profile-form__item",errorTextTag:"p",errorTextClass:"prompt-text"});e.addEventListener("click",(e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",e.focus(),e.dispatchEvent(new Event("input",{bubbles:!0}))}})),e.addEventListener("change",(()=>{e.classList.remove("profile-form--error")})),e.addEventListener("input",(()=>{h.disabled=!function(){const e=f().join();return g.join()!==e}()}));const E=o??function(){i(n,{heading:"Данные успешно обновлены"})};e.addEventListener("submit",(o=>{o.preventDefault();S.validate()?(h.disabled=!0,h.classList.add(r),t(_,new FormData(o.target),(e=>{g=f(),E(e)}),(()=>{i(n,{status:"error",heading:"Ошибка",text:"Не удалось обновить данные, попробуйте снова."})}),(()=>{h.disabled=!1,h.classList.remove(r)}))):(e.classList.remove("profile-form--error"),setTimeout((()=>e.classList.add("profile-form--error")),50))}))}const productMockData={id:"1",title:"Тумба Mock",isPremium:!0,isFavorite:!1,status:"in-stock",price:100,discount:0,dimensions:{width:"15",length:"20",height:"60"},images:["img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp"],images2x:["img/products/product-3@2x.webp","img/products/product-3@2x.webp","img/products/product-3@2x.webp","img/products/product-3@2x.webp","img/products/product-3@2x.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"};function createProductCardPopupTemplate(e,t,n){return`\n    <div class="product-card-popup pin__popup">\n      <div class="product-card-popup__inner">\n        <button class="product-card-popup__close-button" type="button"><span class="visually-hidden">Закрыть</span></button>\n        ${t(e,n)}\n        <a class="product-card-popup__link" href="${e.href}">Подробнее</a>\n      </div>\n    </div>\n  `}function closeActivePin(e){const t=e.querySelector(".pin__popup"),n=e.querySelector(".plus-button");t.classList.add("pin__popup--closing"),setTimeout((()=>{t.remove()}),100),n.classList.remove("plus-button--active"),e.classList.remove("pin--active")}function closeAllActivePins(e){e.forEach((e=>{e.classList.contains("pin--active")&&closeActivePin(e)}))}function initProject(e,t,n,i,o){const r=e.querySelectorAll(".pin");e.addEventListener("click",(e=>{const s=e.target.closest(".plus-button"),l=e.target.closest(".product-card-popup__close-button");if(s){const e=s.closest(".pin");if(s.classList.contains("plus-button--active"))closeActivePin(e);else{closeAllActivePins(r),s.disabled=!0;(async(e,t,n,i)=>{try{const n=await fetch(e);if(!n.ok)throw new Error(`${n.status} – ${n.statusText}`);t(await n.json())}catch(e){n()}finally{i()}})(`https://fakestoreapi.com/products/${e.dataset.productId}`,(i=>{const o=createElementByString(createProductCardPopupTemplate(i&&productMockData,t,"product-card--popup"));n(o.querySelector(".product-card")),e.append(o),s.classList.add("plus-button--active"),e.classList.add("pin--active");if(!window.matchMedia("(min-width: 1024px)").matches)return;if(o.getBoundingClientRect().x<100){o.querySelector(".product-card-popup__inner").style.transformOrigin="left bottom",o.style.right="auto",o.style.left="20px"}}),(()=>{o(i,{status:"error",heading:"Ошибка",text:"Не удалось загрузить данные товара, попробуйте снова."})}),(()=>{s.disabled=!1}))}}if(l){closeActivePin(l.closest(".pin"))}}))}function initProjectsSlider(e){const t=e.querySelector(".swiper"),n=e.querySelector(".slider-arrows__button--prev"),i=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:20,navigation:{prevEl:n,nextEl:i},breakpoints:{1346:{spaceBetween:30},1900:{spaceBetween:40}}})}function initReviewModal(e,t,n,i,o,r,s){r(e,t,n,i,o,{success:{heading:"Спасибо, что оценили нашу работу",text:"Ваш отзыв будет проверен модератором сайта, и опубликован в течение 2 рабочих дней"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить отзыв, попробуйте снова."}},s)}const mockReviewGalleryData=[{type:"video",src:"files/video.mp4",posterSrc:"img/reviews/review-1.webp"},{type:"image",src:"img/reviews/review-1.webp"},{type:"image",src:"img/reviews/review-2.webp"},{type:"image",src:"img/reviews/review-3.webp"},{type:"image",src:"img/reviews/review-1.webp"},{type:"image",src:"img/reviews/review-2.webp"},{type:"image",src:"img/reviews/review-3.webp"}];class ReviewsList{#Ve=null;#Oe=null;#We=null;#Ge=null;#n=null;#je=null;constructor({listElement:e,galleryModal:t,initGallery:n,initVideo:i,openModal:o}){this.#Ve=e,this.#Oe=t,this.#We=n,this.#Ge=i,this.#n=o}updateReviewsTextWrappersList=()=>{this.#je=this.#Ve.querySelectorAll(".review__text-wrapper")};#ze=()=>{this.#je.forEach((e=>{const t=e.classList.contains("review__text-wrapper--clipped");e.classList.add("review__text-wrapper--clipped");const n=e.querySelector(".review__text");n.scrollHeight>n.offsetHeight?e.classList.add("review__text-wrapper--clippable"):e.classList.remove("review__text-wrapper--clippable"),t||e.classList.remove("review__text-wrapper--clipped")}))};#L=throttle(this.#ze,500);#Ne=e=>{const t=e.target.closest(".review__toggle-button"),n=e.target.closest(".feed__slider-item");if(t){t.closest(".review__text-wrapper").classList.toggle("review__text-wrapper--clipped")}if(n){e.preventDefault();const t=n.parentElement;t.classList.add("no-click");const i=Array.from(t.children).indexOf(n),o=n.closest(".review");new this.#Oe({content:reviewsGalleryData[o.dataset.id],openModal:this.#n,initGallery:this.#We,initVideo:this.#Ge}).open(i),t.classList.remove("no-click")}};init=()=>{this.updateReviewsTextWrappersList(),this.#ze(),window.addEventListener("resize",this.#L),this.#Ve.addEventListener("click",this.#Ne)}}function initReviewsList(e,t,n,i,o){const r=new ReviewsList({listElement:e,galleryModal:t,initGallery:n,initVideo:i,openModal:o});return r.init(),r}function initSalonModal(e,t,n,i,o,r,s){r(e,t,n,i,o,{success:{heading:"Заявка успешно отправлена",text:"Наш менеджер свяжется с вами"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}},s)}function initScrollContainer(e){const t=e.querySelector(".swiper-scrollbar");return new Swiper(e,{direction:"vertical",slidesPerView:"auto",freeMode:!0,autoHeight:!0,scrollbar:{el:t,draggable:!0},mousewheel:!0})}const searchResultMockData={products:[{id:"1",title:"Стул Tosca",isPremium:!0,isFavorite:!1,status:"in-stock",price:12e3,discount:0,dimensions:{width:"15",length:"20",height:"60"},images:["img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"},{id:"2",title:"Стул Tosca",isPremium:!0,isFavorite:!1,status:"in-stock",price:15e3,discount:0,dimensions:{width:"15",length:"20",height:"60"},images:["img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"},{id:"3",title:"Тумба Mock",isPremium:!0,isFavorite:!1,status:"in-stock",price:2e4,discount:10,dimensions:{width:"15",length:"20",height:"60"},images:["img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"},{id:"1",title:"Стул Tosca",isPremium:!0,isFavorite:!1,status:"in-stock",price:12e3,discount:0,dimensions:{width:"15",length:"20",height:"60"},images:["img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"},{id:"2",title:"Стул Tosca",isPremium:!0,isFavorite:!1,status:"in-stock",price:15e3,discount:0,dimensions:{width:"15",length:"20",height:"60"},images:["img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"}],articles:[{title:"Смена экспозиции в&nbsp;выставочном зале",type:"Блог",image:"img/articles/previews/preview-1.webp",image2x:"img/articles/previews/preview-1@2x.webp 2x",date:"2023-05-10",href:"article.html"}]};class SearchModal{#Ue=4;#I=null;#n=null;#Ke=null;#Qe=null;#ie=null;#Ye=null;#Je=null;#Xe=null;#Ze=null;constructor({modalElement:e,openModal:t,createProductCardTemplate:n,initProductCard:i,createArticlePreviewTemplate:o}){this.#I=e,this.#n=t,this.#Je=n,this.#Xe=i,this.#Ze=o}#v=async(e,t,n,i)=>{try{const i=await fetch(e,{method:"POST",body:t});if(!i.ok)throw new Error(`${i.status} – ${i.statusText}`);n(await i.json())}catch(e){i()}};#De=e=>{const t=e.target.closest(".text-field__clear-button"),n=e.target.closest(".search-modal__popular-list-link");t&&(this.#Qe.value="",this.#Qe.focus(),this.#Qe.dispatchEvent(new Event("input",{bubbles:!0}))),n&&(this.#Qe.value=n.textContent,this.#Qe.focus(),this.#Qe.dispatchEvent(new Event("input",{bubbles:!0})))};#et(e,t,n){return`\n      <section class="search-modal__result-group">\n        <header class="search-modal__result-group-header">\n          <h3 class="search-modal__result-group-heading">По вашему запросу найдены «${e}»</h3>\n          ${t?`\n      <a class="search-modal__result-group__link link link--small" href="${t}">Ещё результаты</a>\n    `:""}\n        </header>\n        ${n}\n      </section>\n    `}#tt=()=>{if(this.#Qe.value.trim().length<3)return this.#Ke.classList.remove("search-modal--with-result"),void(this.#Ye.innerHTML="");this.#Ke.classList.add("search-modal--with-result");const e=this.#ie.getAttribute("action");this.#v(e,new FormData(this.#ie),(e=>{this.#Ye.innerHTML="";const t=e&&[];if(t?.products?.length||t?.articles?.length){if(t.products.length){const e=`\n            <ul class="products-list products-list--size_xs search-modal__result-group-list">\n              ${t.products.slice(0,this.#Ue).map((e=>this.#Je(e,"product-card--size_xs"))).join("")}\n            </ul>\n          `,n=t.products.length>this.#Ue?`search.html?query=${this.#Qe.value.trim()}`:null,i=createElementByString(this.#et("Товары",n,e));i.querySelectorAll(".product-card").forEach(this.#Xe),this.#Ye.append(i)}if(t.articles.length){const e=`\n            <ul class="articles-list articles-list--size_s search-modal__result-group-list">\n              ${t.articles.map((e=>this.#Ze(e,"article-preview--size_s"))).join("")}\n            </ul>\n          `,n=t.articles.length>this.#Ue?`search.html?query=${this.#Qe.value.trim()}`:null,i=createElementByString(this.#et("Статьи",n,e));this.#Ye.append(i)}}else this.#Ye.insertAdjacentHTML("beforeend",'<p class="search-modal__result-placeholder">По вашему запросу ничего не найдено</p>')}),(()=>{this.#Ye.innerHTML="",this.#Ye.insertAdjacentHTML("beforeend",'<p class="search-modal__result-placeholder search-modal__result-placeholder--error">Ошибка. Не удалось произвести поиск.</p>')}))};#nt=debounce(this.#tt,500);open=e=>{e.preventDefault(),this.#n(this.#I),this.#I.querySelector("input").focus()};init=()=>{this.#Ke=this.#I.querySelector(".search-modal"),this.#ie=this.#Ke.querySelector(".search-modal__form"),this.#Qe=this.#ie.querySelector(".text-field__control"),this.#Ye=this.#Ke.querySelector(".search-modal__result"),document.querySelectorAll('[data-modal-opener="search"]').forEach((e=>{e.addEventListener("click",this.open)})),this.#Ke.addEventListener("click",this.#De),this.#Qe.addEventListener("input",this.#nt)}}function initSearchModal(e,t,n,i,o){const r=new SearchModal({modalElement:e,openModal:t,createProductCardTemplate:n,initProductCard:i,createArticlePreviewTemplate:o});return r.init(),r}function initSelectionSlider(e){const t=e.querySelector(".swiper"),n=e.querySelector(".slider-arrows__button--prev"),i=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:20,navigation:{prevEl:n,nextEl:i},breakpoints:{1346:{spaceBetween:30},1900:{spaceBetween:40}}})}class SignInModal{#de="button--pending";#ue=60;#me=0;#I=null;#n=null;#pe=null;#fe=null;#ge=null;#Se=null;#Ee=null;#be=null;#ve=null;#ye=null;#we=null;#qe=null;#Ce=null;#Fe=null;#xe=null;#Le=null;#Me=null;#ke=null;#Te=null;#Re=null;#Ae=null;#Pe=null;constructor({modalElement:e,openModal:t,closeModal:n}){this.#I=e,this.#n=t,this.#pe=n}setRequestCodeTimeInterval=e=>{this.#ue=e};close=()=>{this.#pe(this.#I)};open=()=>{this.#n(this.#I)};resetCodeRequestForm=()=>{this.#fe.reset()};resetCodeSendingForm=()=>{this.#be.reset()};sendData=async(e,t,n,i,o)=>{try{const i=await fetch(e,{method:"POST",body:t});if(!i.ok)throw new Error(`${i.status} – ${i.statusText}`);n(await i.json())}catch(e){i(e)}finally{o()}};#q(){this.#Ee.dataset.pristineRequiredMessage="Заполните это поле.",this.#qe.dataset.pristineRequiredMessage="Заполните это поле."}#C=()=>{this.#Se=new Pristine(this.#fe,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"}),this.#ye=new Pristine(this.#be,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"})};finishWaitingForResend=()=>{this.#Ce.prepend(this.#Fe),this.#xe.remove()};startWaitingForResend=()=>{if(this.#me<=0){this.#me=this.#ue,this.#Le.textContent=this.#me;const e=setInterval((()=>{this.#me--,this.#Le.textContent=this.#me,this.#me<=0&&(clearInterval(e),this.finishWaitingForResend())}),1e3);this.#Fe.remove(),this.#Ce.prepend(this.#xe)}};goToCodeRequestForm=()=>{this.#fe.classList.remove("modal-form__form--hidden"),this.#be.classList.add("modal-form__form--hidden")};goToCodeSendingForm=()=>{this.#fe.classList.add("modal-form__form--hidden"),this.#be.classList.remove("modal-form__form--hidden");const e=this.#Ee.value.replace(/[()]/g,"").replace(/-/g," ");this.#we.textContent=e,this.startWaitingForResend()};#De=e=>{const t=e.target.closest(".text-field__clear-button"),n=e.target.closest(".modal-form__back-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");return e.value="",void e.focus()}n&&(e.preventDefault(),this.goToCodeRequestForm())};#$e=e=>{if(e.preventDefault(),this.#me>0)this.goToCodeSendingForm();else{const t=this.#fe.getAttribute("action");this.#Se.validate()?(this.#ge.disabled=!0,this.#ge.classList.add(this.#de),this.sendData(t,new FormData(e.target),this.#Me,this.#ke,(()=>{this.#ge.disabled=!1,this.#ge.classList.remove(this.#de)}))):(this.#I.classList.remove("modal--error"),setTimeout((()=>this.#I.classList.add("modal--error")),50))}};#Be=e=>{e.preventDefault(),this.#Fe.disabled=!0;const t=this.#fe.getAttribute("action");this.sendData(t,new FormData(this.#fe),this.#Te,this.#Re,(()=>{this.#Fe.disabled=!1}))};#Ie=e=>{e.preventDefault();const t=this.#be.getAttribute("action");this.#ye.validate()?(this.#ve.disabled=!0,this.#ve.classList.add(this.#de),this.sendData(t,new FormData(e.target),this.#Ae,this.#Pe,(()=>{this.#ve.disabled=!1,this.#ve.classList.remove(this.#de)}))):(this.#I.classList.remove("modal--error"),setTimeout((()=>this.#I.classList.add("modal--error")),50))};#He=e=>{e.preventDefault(),this.open()};setCodeRequestSubmitHandlers=(e,t)=>{this.#Me=e,this.#ke=t};setCodeReRequestSubmitHandlers=(e,t)=>{this.#Te=e,this.#Re=t};setCodeSendingSubmitHandlers=(e,t)=>{this.#Ae=e,this.#Pe=t};init(){this.#fe=this.#I.querySelector(".modal-form__form--code-request"),this.#ge=this.#fe.querySelector(".modal-form__submit-button"),this.#Ee=this.#fe.querySelector(".modal-form__item--tel .text-field__control"),this.#be=this.#I.querySelector(".modal-form__form--code-sending"),this.#ve=this.#be.querySelector(".modal-form__submit-button"),this.#we=this.#be.querySelector(".modal-form__phone-text"),this.#qe=this.#be.querySelector(".modal-form__item--code .text-field__control"),this.#Ce=this.#be.querySelector(".modal-form__footer"),this.#Fe=this.#be.querySelector(".modal-form__footer-button--resend-code"),this.#xe=this.#be.querySelector(".modal-form__footer-text--resend-code"),this.#Le=this.#xe.querySelector(".modal-form__footer-text-timer"),this.#q(),this.#C(),this.#I.addEventListener("click",this.#De),this.#fe.addEventListener("submit",this.#$e),this.#be.addEventListener("submit",this.#Ie),this.#Fe.addEventListener("click",this.#Be),document.querySelectorAll('[data-modal-opener="sign-in"]').forEach((e=>{e.addEventListener("click",this.#He)}))}}function initSignInModal(e,t,n){const i=new SignInModal({modalElement:e,openModal:t,closeModal:n});return i.init(),i}function initSimpleModalForm(e,t,n,i,o,r,s){const l="button--pending",a=e.dataset.modal,c=e.querySelector(".modal__form"),d=c.querySelector(".modal-form__submit-button"),u=e.querySelector(".modal-form__item--name .text-field__control"),m=e.querySelector(".modal-form__item--surname .text-field__control"),p=e.querySelector(".modal-form__item--patronymic .text-field__control"),h=e.querySelector(".modal-form__item--phone .text-field__control"),_=e.querySelector(".modal-form__item--email .text-field__control"),f=e.querySelector(".modal-form__item--date .text-field__control"),g=e.querySelector(".modal-form__item--comment .textarea__control");u&&(u.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),u.dataset.pristineRequiredMessage="Заполните это поле.",u.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),m&&(m.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),m.dataset.pristineRequiredMessage="Заполните это поле.",m.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),p&&(p.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),p.dataset.pristineRequiredMessage="Заполните это поле.",p.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),h&&(h.dataset.pristineRequiredMessage="Заполните это поле.",h.dataset.pristineEmailMessage="Введите корректный номер телефона."),_&&(_.dataset.pristineRequiredMessage="Заполните это поле.",_.dataset.pristineEmailMessage="Введите корректный e-mail адрес."),f&&(f.pattern=/^(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[0-2])\.\d{4}$/,f.dataset.pristineRequiredMessage="Заполните это поле.",f.dataset.pristinePatternMessage="Введите дату в формате дд.мм.гггг"),g&&(g.dataset.pristineRequiredMessage="Заполните это поле.");const S=c.getAttribute("action"),E=new Pristine(c,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"});const b=s??function(){o(n,r.success)};c.addEventListener("click",(e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",e.focus()}})),c.addEventListener("submit",(s=>{s.preventDefault();E.validate()?(d.disabled=!0,d.classList.add(l),t(S,new FormData(s.target),(t=>{i(e),b(t),c.reset()}),(()=>{i(e),o(n,r.error)}),(()=>{d.disabled=!1,d.classList.remove(l)}))):(e.classList.remove("modal--error"),setTimeout((()=>e.classList.add("modal--error")),50))})),document.querySelectorAll(`[data-modal-opener="${a}"]`).forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault(),E.reset(),e.classList.remove("modal--error"),n(e),e.querySelector("input").focus()}))}))}function initSiteHeader(e){const t=e.querySelector(".site-header__menu-button"),n=e.querySelector(".site-header__navigation"),i=window.matchMedia("(min-width: 1260px)");t.addEventListener("click",(()=>{t.classList.toggle("site-header__menu-button--close"),t.ariaExpanded="true"===t.ariaExpanded?"false":"true",n.classList.toggle("site-header__navigation--open"),e.classList.toggle("page__site-header--expand"),togglePageScroll()}));const o=n.querySelector(".site-navigation__panels"),r=n.querySelector(".site-navigation__back-button"),s=n.querySelector(".site-navigation__title");n.querySelector(".site-navigation__close-button").addEventListener("click",(i=>{i.preventDefault(),n.classList.remove("site-header__navigation--open"),e.classList.remove("page__site-header--expand"),t.classList.remove("site-header__menu-button--animated"),t.classList.remove("site-header__menu-button--close"),t.ariaExpanded="false"}));const l=n.querySelector(".site-navigation__top-link--opener");let a=null,c=null,d=null;function u(e){const t=o.querySelector(`#${e.dataset.panelId}`);t&&(a&&m(),d&&p(),s.textContent=e.textContent,e.classList.add("site-navigation__top-link--active"),t.classList.add("site-navigation__panel--active"),n.classList.add("site-navigation--inside"),a=t,c=e)}function m(){a.classList.remove("site-navigation__panel--active"),c.classList.remove("site-navigation__top-link--active"),n.classList.remove("site-navigation--inside"),a=null,c=null}function p(){d.classList.remove("site-navigation__item--opened");const e=d.parentElement.children;s.textContent=c?.textContent;for(const t of e)t!==d&&t.classList.remove("site-navigation__item--hidden");d=null}!a&&i.matches&&u(l),i.addEventListener("change",(()=>{!a&&i.matches&&u(l)})),n.addEventListener("click",(e=>{if(!i.matches){const t=e.target.closest(".site-navigation__top-link--opener"),n=e.target.closest(".site-navigation__middle-link--opener");t&&(e.preventDefault(),u(t)),n&&(e.preventDefault(),d&&p(),function(e){d&&p();s.textContent=e.textContent,d=e.parentElement;const t=d.parentElement.children;d.classList.add("site-navigation__item--opened");for(const e of t)e!==d&&e.classList.add("site-navigation__item--hidden")}(n))}})),n.addEventListener("mouseover",(e=>{if(i.matches){const t=e.target.closest(".site-navigation__top-link--opener");t&&u(t)}})),r.addEventListener("click",(e=>{e.preventDefault(),d?p():a&&m()}));let h=0;const _=document.querySelector(".page__inner");_.addEventListener("scroll",throttle((()=>{const t=e.offsetHeight;_.scrollTop>0&&e.classList.add("site-header--sticked"),_.scrollTop>h&&_.scrollTop>t?e.classList.add("page__site-header--hidden"):(e.classList.remove("page__site-header--hidden"),0===_.scrollTop&&e.classList.remove("site-header--sticked")),h=_.scrollTop}),100))}function initStaticGalleryModal(e,t,n,i){const o=e.querySelector(".modal__gallery");let r=null;o&&(r=n(o)),document.querySelectorAll(i).forEach((n=>{n.addEventListener("click",(n=>{n.preventDefault();const i=n.target.closest("li");if(i&&r){const e=i.parentElement,t=Array.from(e.children).indexOf(i);r.slideTo(t,0)}t(e),r&&setTimeout((()=>{r.update()}),100)}))}))}function initSubscriptionForm(e,t,n,i,o){const r="button--pending",s=e.querySelector(".subscription__form-item .text-field__control"),l=e.querySelector(".subscription__form-submit-button"),a=e.getAttribute("action");s.dataset.pristineRequiredMessage="Заполните это поле.",s.dataset.pristineEmailMessage="Введите корректный e-mail адрес.";const c=new Pristine(e,{classTo:"subscription__form-item",errorClass:"invalid",errorTextParent:"subscription__form-item",errorTextTag:"p",errorTextClass:"prompt-text"});const d=o??function(){i(n,{heading:"Вы подписались"})};e.addEventListener("click",(e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",e.focus()}})),e.addEventListener("submit",(o=>{o.preventDefault();c.validate()?(l.disabled=!0,l.classList.add(r),t(a,new FormData(o.target),(t=>{e.reset(),d(t)}),(()=>{i(n,{status:"error",heading:"Ошибка",text:"Не удалось подписаться, попробуйте снова."})}),(()=>{l.disabled=!1,l.classList.remove(r)}))):(e.classList.remove("subscription__form--error"),setTimeout((()=>e.classList.add("subscription__form--error")),50))}))}function initTaber(e,t){const n=e.querySelector(".taber__list"),i=Array.from(n.querySelectorAll(".taber__tab")),o=e.querySelectorAll(".taber__panel");n.setAttribute("role","tablist"),i.forEach(((e,n)=>{e.role="tab",e.id=`${t}-tab-${n+1}`,e.tabIndex=-1,e.parentNode.role="presentation"})),o.forEach(((e,t)=>{e.role="tabpanel",e.tabIndex=-1,e.setAttribute("aria-labelledby",i[t].id),e.classList.add("taber__panel--hidden")}));const r=(e,t,n)=>{if(e){e.ariaSelected=null,e.tabIndex=-1,e.classList.remove("taber__tab--active");const t=i.indexOf(e);o[t].classList.add("taber__panel--hidden")}n||t.focus(),t.tabIndex=0,t.ariaSelected=!0,t.classList.add("taber__tab--active");const r=i.indexOf(t);o[r].classList.remove("taber__panel--hidden")};(()=>{const e=window.location.hash,t=i.find((t=>t.hash===e));r(null,t||i[0],!0)})(),n.addEventListener("click",(e=>{e.preventDefault();const t=e.target.closest(".taber__tab");if(!t)return;const i=n.querySelector("[aria-selected]");t!==i&&r(i,t)}));const s=window.matchMedia("(min-width: 1346px)");n.addEventListener("keydown",(t=>{const n=i.indexOf(t.target);if(e.classList.contains("taber--vertical")&&s.matches){if(!isDownArrowEvent(t)&&!isRightArrowEvent(t)&&!isUpArrowEvent(t))return;if(t.preventDefault(),isRightArrowEvent(t))o[n].focus();else{const e=isUpArrowEvent(t)?n-1:n+1;if(!i[e])return;r(t.target,i[e])}}else if(isDownArrowEvent(t)||isLeftArrowEvent(t)||isRightArrowEvent(t))if(t.preventDefault(),isDownArrowEvent(t))o[n].focus();else{const e=isLeftArrowEvent(t)?n-1:n+1;if(!i[e])return;r(t.target,i[e])}}))}function initTelField(e){function t(e){return e.value.replace(/\D/g,"")}e.addEventListener("input",(function(e){const n=e.target;let i=t(n),o="";const r=n.selectionStart;if(!i)return void(n.value="");if(n.value.length!==r)return void(e.data&&/\D/g.test(e.data)&&(n.value=i));if(!["7","8","9"].includes(i[0]))return void(n.value=`+${i}`.substring(0,16));"9"===i[0]&&(i=`7${i}`),o=`${"8"===i[0]?"8":"+7"} `,i.length>1&&(o+=`(${i.substring(1,4)}`),i.length>=5&&(o+=`) ${i.substring(4,7)}`),i.length>=8&&(o+=`-${i.substring(7,9)}`),i.length>=10&&(o+=`-${i.substring(9,11)}`),n.value=o})),e.addEventListener("keydown",(function(e){const n=e.target;"Backspace"===e.code&&1===t(n).length&&(n.value="")})),e.addEventListener("paste",(function(e){const n=e.clipboardData||window.clipboardData,i=e.target,o=t(i);if(n){const e=n.getData("Text");/\D/g.test(e)&&(i.value=o)}}))}function initTextFieldWithList(e){const t=e.querySelector(".text-field__control"),n=e.querySelector(".text-field__data-list");function i(){n.classList.remove("text-field__data-list--open"),document.removeEventListener("click",o)}function o({target:e}){e.closest(".text-field")||i()}t.addEventListener("click",(()=>{n.classList.add("text-field__data-list--open"),document.addEventListener("click",o)})),n.addEventListener("click",(({target:e})=>{const n=e.closest(".text-field__data-link");n&&(t.value=n.textContent,t.dispatchEvent(new Event("input",{bubbles:!0})),i())}))}function initUserNavigation(e){const t=document.querySelector(".shortcuts__link--user");function n({target:e}){e.closest(".user-navigation")||e===t||i()}function i(){e.classList.remove("site-header__user-navigation--open"),document.removeEventListener("click",n)}t.addEventListener("click",(o=>{t.dataset.modalOpener||(o.preventDefault(),e.classList.contains("site-header__user-navigation--open")?i():(e.classList.add("site-header__user-navigation--open"),document.addEventListener("click",n)))}))}function initVideoReiewsSlider(e){const t=e.querySelector(".swiper"),n=e.querySelector(".slider-arrows__button--prev"),i=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:20,navigation:{prevEl:n,nextEl:i},watchSlidesProgress:!0,breakpoints:{1346:{spaceBetween:30},1900:{spaceBetween:40}}})}function initVideo(e){const t=e.querySelector(".video__poster"),n=e.querySelector(".video__play-button-wrapper"),i=e.querySelector(".video__play-button"),o=e.querySelector(".video__player");i.addEventListener("click",(()=>{o.play(),n.classList.add("video__play-button-wrapper--hidden"),t.classList.add("video__poster--hidden")})),o.addEventListener("ended",(()=>{n.classList.remove("video__play-button-wrapper--hidden"),t.classList.remove("video__poster--hidden")})),o.addEventListener("play",(()=>{document.querySelectorAll("video").forEach((e=>{e!==o&&e.pause()}))}))}document.querySelectorAll(".cart").forEach((e=>{initCart(e,openModal,showAlert,"undefined"!=typeof onCartFormSuccessSubmit?onCartFormSuccessSubmit:null,"undefined"!=typeof onCartFormErrorSubmit?onCartFormErrorSubmit:null)})),document.querySelectorAll(".reviews__list").forEach((e=>{initReviewsList(e,GalleryModal,initGallery,initVideo,openModal)})),document.querySelectorAll(".site-header").forEach(initSiteHeader),document.querySelectorAll(".premium-brands__slider").forEach(initPremiumBrandsSlider),document.querySelectorAll(".selection__slider").forEach(initSelectionSlider),document.querySelectorAll(".taber").forEach(((e,t)=>{initTaber(e,`taber-${t+1}`)})),document.querySelectorAll(".filter__slider").forEach(initFilterSlider),document.querySelectorAll(".banners").forEach(initBanners),document.querySelectorAll(".map").forEach(initMap),document.querySelectorAll(".product-card").forEach(initProductCard),document.querySelectorAll(".products").forEach(initProducts),document.querySelectorAll(".articles--with-slider").forEach(initArticlesSlider),document.querySelectorAll(".navigation-shortcuts").forEach(initNavigationShortcuts),document.querySelectorAll(".catalog-sorting").forEach(initCatalogSorting),document.querySelectorAll(".product-images").forEach(initProductImages),document.querySelectorAll(".product-header__action-buttons").forEach(initProductHeaderStickyActionButtons),document.querySelectorAll(".folds").forEach(initFolds),document.querySelectorAll(".text-field--date").forEach((e=>{initDateField(e,setInputDateMask)})),document.querySelectorAll(".scroll-container").forEach(initScrollContainer),document.querySelectorAll(".file-field").forEach(initFileField),document.querySelectorAll(".feed").forEach(initFeed),document.querySelectorAll(".video-reviews").forEach(initVideoReiewsSlider),document.querySelectorAll(".video").forEach(initVideo),document.querySelectorAll(".projects-slider").forEach(initProjectsSlider),document.querySelectorAll('input[type="tel"]').forEach(initTelField),document.querySelectorAll(".all-brands").forEach(initAllBrands),document.querySelectorAll(".profile-form").forEach((e=>{initProfileForm(e,sendData,openModal,showAlert,"undefined"!=typeof onProfileFormSuccessSubmit?onProfileFormSuccessSubmit:null)})),document.querySelectorAll(".feedback-form").forEach((e=>{initFeedbackForm(e,sendData,openModal,showAlert,"undefined"!=typeof onFeedbackFormSuccessSubmit?onFeedbackFormSuccessSubmit:null)})),document.querySelectorAll(".subscription__form").forEach((e=>{initSubscriptionForm(e,sendData,openModal,showAlert,"undefined"!=typeof onSubscriptionFormSuccessSubmit?onSubscriptionFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="cooperation"]').forEach((e=>{initCooperationModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onCooperationFormSuccessSubmit?onCooperationFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="feedback"]').forEach((e=>{initFeedbackModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onFeedbackFormSuccessSubmit?onFeedbackFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="salon"]').forEach((e=>{initSalonModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onSalonFormSuccessSubmit?onSalonFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="installment-request"]').forEach((e=>{initInstallmentRequestModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onInstallmentRequestFormSuccessSubmit?onInstallmentRequestFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="product-question"]').forEach((e=>{initProductQuestionModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onProductQuestionFormSuccessSubmit?onProductQuestionFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="one-click"]').forEach((e=>{initOneClickModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onOneClickFormSuccessSubmit?onOneClickFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="review"]').forEach((e=>{initReviewModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onReviewFormSuccessSubmit?onReviewFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="catalog-filters"]').forEach((e=>{initCatalogFiltersModal(e,initScrollContainer,openModal,toggleFoldState)})),document.querySelectorAll(".modal--with_product-gallery").forEach((e=>{initStaticGalleryModal(e,openModal,initGallery,".product__images")})),document.querySelectorAll(".modal--with_selection-gallery").forEach((e=>{initStaticGalleryModal(e,openModal,initGallery,".selection__slider-list")})),document.querySelectorAll('[data-modal$="-document"]').forEach((e=>{initDocumentModal(e,openModal)})),document.querySelectorAll(".project").forEach((e=>{initProject(e,createProductCardTemplate,initProductCard,openModal,showAlert)})),document.querySelectorAll('[data-modal="search"]').forEach((e=>{initSearchModal(e,openModal,createProductCardTemplate,initProductCard,createArticlePreviewTemplate)})),document.querySelectorAll(".user-navigation").forEach(initUserNavigation),document.querySelectorAll('[data-modal="cities"]').forEach((e=>{initCitiesModal(e,initScrollContainer,openModal)})),document.querySelectorAll(".document-actions__button--print").forEach(initButtonPrintPdf);const signInModalElement=document.querySelector('[data-modal="sign-in"]');let signInModal;signInModalElement&&(signInModal=initSignInModal(signInModalElement,openModal,closeModal));const phoneChangeModalElement=document.querySelector('[data-modal="phone-change"]');let phoneChangeModal;phoneChangeModalElement&&(phoneChangeModal=initPhoneChangeModal(phoneChangeModalElement,openModal,closeModal));