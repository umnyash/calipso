"use strict";const DESKTOP_WIDTH_MEDIA_QUERY="(min-width: 1346px)",LAPTOP_WIDTH_MEDIA_QUERY="(min-width: 1260px)",WIDE_TABLET_WIDTH_MEDIA_QUERY="(min-width: 1024px)",KeyCode=Object.freeze({LEFT_ARROW:"ArrowLeft",RIGHT_ARROW:"ArrowRight",DOWN_ARROW:"ArrowDown",SPACE:"Space",ESCAPE:"Escape"});function isDownArrowEvent(e){return e.code===KeyCode.DOWN_ARROW}function isEscapeEvent(e){return e.code===KeyCode.ESCAPE}function isLeftArrowEvent(e){return e.code===KeyCode.LEFT_ARROW}function isRightArrowEvent(e){return e.code===KeyCode.RIGHT_ARROW}function isSpaceEvent(e){return e.code===KeyCode.SPACE}function createElementByString(e){const t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function getPaginationButtonCreator(e="Слайд"){return(t,i)=>`\n    <button class='${i}' type='button'>\n      <span class='visually-hidden'>${e} ${t+1}.</span>\n    </button>\n  `}function debounce(e,t=500){let i;return(...r)=>{clearTimeout(i),i=setTimeout((()=>e.apply(this,r)),t)}}function throttle(e,t){let i,r=0;return(...o)=>{const n=new Date;clearTimeout(i),i=setTimeout((()=>e.apply(this,o)),t),n-r>=t&&(e.apply(this,o),r=n)}}function getDigitsFromString(e){return e.replace(/\D/g,"")}function showAlert(e,t){const i=createElementByString(`\n    <div class="modal modal--with_alert">\n      <div class="modal__inner">\n        <button class="modal__close-button" type="button">\n          <span class="visually-hidden">Закрыть</span>\n        </button>\n        <section class="alert modal__alert ${"error"===t.status?"alert--error":""}">\n          <h2 class="alert__heading">${t.heading}</h2>\n          ${t.text?`<p class="alert__text">${t.text}</p>`:""}\n          <button class="button alert__button button--secondary" type="button">${t.buttonText||"Закрыть"}</button>\n        </section>\n      </div>\n    </div>\n  `);document.body.append(i),e(i)}function initAllBrands(e){const t=e.querySelector(".all-brands__form"),i=t.querySelector(".text-field__control"),r=t.querySelector(".text-field__clear-button"),o={};function n(e){for(const t in o){const i=o[t];let r=!1;i.links.forEach((t=>{t.textContent.toLowerCase().includes(e.toLowerCase())?(t.parentElement.classList.remove("all-brands__item--hidden"),r=!0):t.parentElement.classList.add("all-brands__item--hidden")})),r?i.group.classList.remove("all-brands__group--hidden"):i.group.classList.add("all-brands__group--hidden")}}e.querySelectorAll(".all-brands__group").forEach((e=>{const t=e.querySelector(".all-brands__group-name").textContent;o[t]={group:e,links:e.querySelectorAll(".all-brands__link")}})),t.addEventListener("submit",(function(e){e.preventDefault()})),i.addEventListener("input",(function({target:e}){n(e.value.trim().toLowerCase())})),r.addEventListener("click",(function(e){e.preventDefault(),i.value="",n("")}))}async function sendData(e,t,i=(()=>{}),r=(()=>{}),o=(()=>{})){try{const r=await fetch(e,{method:"POST",body:t});if(!r.ok)throw new Error(`${r.status} – ${r.statusText}`);i()}catch(e){r()}finally{o()}}function createArticlePreviewTemplate(e,t){const i=new Intl.DateTimeFormat("ru",{year:"numeric",month:"long",day:"numeric"}).format(Date.parse(e.date)).replace(/ г.$/,"");return`\n    <li class="article-preview ${t||""}">\n      <h3 class="article-preview__heading">\n        <a class="article-preview__link" href="${e.href}">${e.title}</a>\n      </h3>\n      <p class="article-preview__label">${e.type}</p>\n      <picture class="article-preview__image-wrapper">\n        <img class="article-preview__image" src="${e.image}" srcset="${e.image2x} 2x" alt="" loading="lazy"/>\n      </picture>\n      <time class="article-preview__date" datetime="${e.date}">${i}</time>\n    </li>\n  `}function initArticlesSlider(e){const t=e.querySelector(".articles__slider"),i=e.querySelector(".articles__slider-arrows .slider-arrows__button--prev"),r=e.querySelector(".articles__slider-arrows .slider-arrows__button--next"),o=new Swiper(t,{slidesPerView:"auto",spaceBetween:15,navigation:{prevEl:i,nextEl:r},breakpoints:{768:{slidesPerView:4,spaceBetween:20},1346:{slidesPerView:4,spaceBetween:30},1900:{slidesPerView:4,spaceBetween:40}}}),n=e.querySelector(".articles__filter"),s=e.querySelectorAll(".articles__slider-item");n.addEventListener("change",(e=>{const t=e.target.value;s.forEach((e=>{e.classList.toggle("articles__slider-item--hidden",!(e.dataset.tag===t||"all"===t))})),o.update()}))}function initBanners(e){const t=e.querySelector(".banners__slider"),i=e.querySelector(".banners__thumbnails-slider"),r=i.querySelectorAll(".banners__thumbnail"),o=new Swiper(i,{spaceBetween:5,slidesPerView:"auto",watchSlidesProgress:!0});new Swiper(t,{effect:"fade",fadeEffect:{crossFade:!0},loop:!0,autoplay:{delay:6e3,disableOnInteraction:!1},thumbs:{swiper:o,slideThumbActiveClass:"banners__thumbnails-item--active"}}).on("autoplayTimeLeft",((e,t,i)=>{r.forEach((e=>{e.style.setProperty("--thumbnail-progress",1-i)}))}))}class Cart{#e=null;#t=null;#i=null;#r=null;#o=null;#n=null;formElement=null;#s=null;#l=null;#a=null;#d=null;#c=null;#u=null;#m=null;#p=null;#h=null;constructor({cartElement:e,openModal:t,showAlert:i}){this.#e=e,this.#t=t,this.#i=i,this.formElement=this.#e.querySelector(".cart-form"),this.#r=this.#e.querySelector(".page-heading .heading")}#_=async(e,t,i,r,o)=>{try{const r=await fetch(e,{method:"POST",body:t});if(!r.ok)throw new Error(`${r.status} – ${r.statusText}`);i(await r.json())}catch(e){r()}finally{o()}};#f=()=>{this.formElement.classList.add("cart-form--checkout"),this.#s.classList.add("cart-form__info--checkout"),this.#r.textContent="Оформление заказа"};#g=()=>{this.#n.querySelector(".cart__heading").remove(),this.formElement.remove()};showResult=e=>{this.#g(),this.#n.insertAdjacentHTML("beforeend",`\n      <div class="cart-result">\n        <div class="cart-result__inner container">\n          <h1 class="cart-result__heading heading">Заказ № ${e} успешно оформлен!</h1>\n          <p class="cart-result__text">Уведомления о&nbsp;заказе будут приходить на&nbsp;почту. Более подробно следить за&nbsp;состоянием заказа вы&nbsp;сможете через личный кабинет:</p><a class="button cart-result__button button--primary" href="#!">Войти в личный кабинет</a>\n        </div>\n      </div>\n    `)};#E(){const e=this.formElement.querySelector(".cart-form__item--name .text-field__control"),t=this.formElement.querySelector(".cart-form__item--phone .text-field__control"),i=this.formElement.querySelector(".cart-form__item--email .text-field__control"),r=this.formElement.querySelector(".cart-form__item--city .text-field__control"),o=this.formElement.querySelector(".cart-form__item--street .text-field__control"),n=this.formElement.querySelector(".cart-form__item--house .text-field__control");e&&(e.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),e.dataset.pristineRequiredMessage="Заполните это поле.",e.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),t&&(t.dataset.pristineRequiredMessage="Заполните это поле."),i&&(i.dataset.pristineRequiredMessage="Заполните это поле.",i.dataset.pristineEmailMessage="Введите корректный e-mail адрес."),r&&(r.dataset.pristineRequiredMessage="Заполните это поле."),o&&(o.dataset.pristineRequiredMessage="Заполните это поле."),n&&(n.dataset.pristineRequiredMessage="Заполните это поле.")}#v=()=>{this.#h=new Pristine(this.formElement,{classTo:"cart-form__item",errorClass:"invalid",errorTextParent:"cart-form__item",errorTextTag:"p",errorTextClass:"prompt-text"})};#b=()=>{this.#o.scrollHeight-this.#o.scrollTop===this.#o.clientHeight?this.#s.classList.remove("cart-form__info--sticked"):this.#s.classList.add("cart-form__info--sticked")};#S=throttle(this.#b,100);#w=throttle(this.#b,100);#y=e=>{const t=e.target.closest(".cart-form__checkout-link"),i=e.target.closest(".cart-form__promocode-button"),r=e.target.closest(".cart-form__choose-all-button"),o=e.target.closest(".text-field__clear-button"),n=e.target.closest(".counter__button");if(t)return e.preventDefault(),this.#f(),void this.#b();if(i)this.#l.classList.toggle("cart-form__promocode--hidden");else{if(r){return this.formElement.querySelectorAll(".cart-item__checkbox .checker__control").forEach((e=>{e.checked=!0,e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0}))})),void this.#u.classList.add("cart-form__choose-all-button--active")}if(o){const e=o.closest(".text-field").querySelector(".text-field__control");return e.value="",void e.focus()}if(n){const e=n.closest(".counter").querySelector(".counter__control"),t=e.value;n.classList.contains("counter__button--plus")?e.stepUp():e.stepDown(),t!==e.value&&(e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})))}}};#x=e=>{e.target.closest(".cart-item__checkbox")&&this.#u.classList.remove("cart-form__choose-all-button--active")};#q=({target:e})=>{e.closest(".cart-form__receiving-radiobutton--pickup")?(this.#c.classList.remove("cart-form__section-inner-group--hidden"),this.#d.classList.add("cart-form__section-inner-group--hidden")):(this.#c.classList.add("cart-form__section-inner-group--hidden"),this.#d.classList.remove("cart-form__section-inner-group--hidden"))};#C=e=>{e.preventDefault();const t="button--pending";this.#h.validate()?(this.#m.disabled=!0,this.#m.classList.add(t),this.#p.disabled=!0,this.#p.classList.add(t),this.#_("https://fakestoreapi.com/products",new FormData(e.target),(e=>{this.formElement.reset();const t=e.number||"45678";this.showResult(t)}),(()=>{this.#i(this.#t,{status:"error",heading:"Ошибка",text:"Не удалось отправить сообщение, попробуйте снова."})}),(()=>{this.#m.disabled=!1,this.#m.classList.remove(t),this.#p.disabled=!1,this.#p.classList.remove(t)}))):(this.formElement.classList.remove("feedback-form--error"),setTimeout((()=>this.formElement.classList.add("feedback-form--error")),50))};initForm(){this.#o=document.querySelector(".page__inner"),this.#n=this.#e.querySelector(".cart__inner"),this.#s=this.formElement.querySelector(".cart-form__info"),this.#u=this.formElement.querySelector(".cart-form__choose-all-button"),this.#a=this.formElement.querySelector(".cart-form__radiobuttons-list--receiving"),this.#d=this.formElement.querySelector(".cart-form__section-inner-group--delivery"),this.#c=this.formElement.querySelector(".cart-form__section-inner-group--pickup"),this.#l=this.#s.querySelector(".cart-form__promocode"),this.#m=this.formElement.querySelector(".cart-form__submit-button"),this.#p=this.formElement.querySelector(".cart-form__section-submit-button"),this.#E(),this.#v(),this.formElement.addEventListener("click",this.#y),this.formElement.addEventListener("change",this.#x),this.#a.addEventListener("change",this.#q),this.formElement.addEventListener("submit",this.#C),this.#o.addEventListener("scroll",this.#S),window.addEventListener("resize",this.#w),this.#b()}}function initCart(e,t,i){const r=new Cart({cartElement:e,openModal:t,showAlert:i});return r.formElement&&r.initForm(),r}class CatalogFiltersModal{#L=new Event("change",{bubbles:!0});#M=new Event("input",{bubbles:!0});#F=null;#T=null;#t=null;#k=null;#A=null;#P=null;#R=null;#$=null;#D=null;#B=null;constructor({modalElement:e,initScrollContainer:t,openModal:i,toggleFoldState:r}){this.#F=e,this.#T=t,this.#t=i,this.#k=r}#I=(e,t,i)=>`<li class="catalog__applied-filter">${e}\n      <button class="catalog__applied-filter-reset-button" data-field-name="${t}" data-field-value="${i}">\n        <span class="visually-hidden">Удалить фильтр</span>\n      </button>\n    </li>`;#V=()=>{const e=[],t=[];this.#$.forEach((i=>{if(!("checkbox"===i.type||"radio"===i.type?i.checked:i.value))return;const r=i.name;let o="";const n=i.value;if(i.dataset.rangeLimit){const e=i.closest(".catalog-filters__folds-item--range"),r=e.dataset.rangeName;if(t.includes(r))return;let n=null,s=null;"min"===i.dataset.rangeLimit?(n=i.value,s=e.querySelector('.number-range__field-control[data-range-limit="max"]').value):(n=e.querySelector('.number-range__field-control[data-range-limit="min"]').value,s=i.value),o=n&&s?`${r} от ${n} до ${s}`:n?`${r} от ${n}`:s?`${r} до ${s}`:"",t.push(r)}else{o=i.closest(".checker, .color").querySelector(".checker__label, .color__name").textContent}const s=this.#I(o,r,n);e.push(s)})),this.#D.innerHTML="";const i=e.join("");this.#D.insertAdjacentHTML("beforeend",i)};#W=()=>{const e=new Map;this.#$.forEach((t=>{const i="checkbox"===t.type||"radio"===t.type?t.checked:t.value;e.set(t,i)})),this.#B=e};#H=()=>{this.#B.forEach(((e,t)=>{"checkbox"===t.type||"radio"===t.type?t.checked=e:t.value=e,t.dispatchEvent(this.#L)}))};#O=e=>{e.preventDefault(),this.#H(),this.#t(this.#F);const t=e.target.dataset.foldName;if(t){const e=this.#A.querySelector(`[data-fold-name="${t}"]`);"true"!==e.ariaExpanded&&this.#k(e);const i=this.#P.scrollHeight-this.#P.offsetHeight;if(i>0){const t=Math.min(i,e.offsetTop);this.#R.setTranslate(-t)}setTimeout((()=>this.#R.update()),300)}};#G=e=>{const t=e.target.closest(".catalog-filter__box-toggle-button"),i=e.target.closest(".catalog-filters__folds-button");if(t){t.closest(".catalog-filter__box").classList.toggle("catalog-filter__box--expand"),setTimeout((()=>this.#R.update()),300)}else i&&setTimeout((()=>this.#R.update()),300)};#j=e=>{const t=e.target.closest(".catalog-filters__folds-item");if(t)if(t.classList.contains("catalog-filters__folds-item--range")){const e=t.querySelector('.number-range__field-control[data-range-limit="min"]'),i=t.querySelector('.number-range__field-control[data-range-limit="max"]'),r=e.value,o=i.value,n=t.querySelector(".catalog-filters__folds-value-label"),s=t.dataset.rangeName;n.textContent=r&&o?`${s} от ${r} до ${o}`:r?`${s} от ${r}`:o?`${s} до ${o}`:""}else if(t.classList.contains("catalog-filters__folds-item--checkers")){const e=t.querySelector(".catalog-filters__folds-value-label"),i=Array.from(t.querySelectorAll(".checker, .color"));e.textContent=i.filter((e=>e.querySelector("input").checked)).map((e=>e.querySelector(".checker__label, .color__name").textContent)).join(", ")}};#z=()=>{this.#W(),this.#V()};#N=()=>{setTimeout((()=>{this.#$.forEach((e=>{e.dispatchEvent(this.#L)}))}),0)};#K=e=>{const t=e.target.closest(".catalog__applied-filter-reset-button");if(!t)return;const i=t.parentElement,r=t.dataset.fieldName,o=this.#$.filter((e=>e.name===r));if(o[0].dataset.rangeLimit){o[0].closest(".catalog-filters__folds-item--range").querySelectorAll("input").forEach((e=>{e.value="",e.dispatchEvent(this.#M)}))}else if("checkbox"===o[0].type||"radio"===o[0].type){const e=t.dataset.fieldValue,i=Array.from(o).find((t=>t.value===e));i.checked=!1,i.dispatchEvent(this.#M)}i.remove(),this.#W()};init=()=>{this.#A=this.#F.querySelector(".catalog-filters"),this.#P=this.#A.querySelector(".catalog-filters__scroll-container"),this.#R=this.#T(this.#P),this.#$=Array.from(this.#A.querySelectorAll("input")),this.#D=document.querySelector(".catalog__applied-filters"),this.#W();document.querySelectorAll(".catalog__filter-opener-button").forEach((e=>{e.addEventListener("click",this.#O)})),this.#A.addEventListener("click",this.#G),this.#A.addEventListener("change",this.#j),this.#A.addEventListener("submit",this.#z),this.#A.addEventListener("reset",this.#N),this.#D.addEventListener("click",this.#K)}}function initCatalogFiltersModal(e,t,i,r){const o=new CatalogFiltersModal({modalElement:e,initScrollContainer:t,openModal:i,toggleFoldState:r});return o.init(),o}function initCatalogSorting(e){const t=e.querySelector(".catalog-sorting__toggle-button"),i=e.querySelector(".catalog-sorting__close-button");t.addEventListener("click",(t=>{t.preventDefault(),e.classList.toggle("catalog-sorting--open")})),i.addEventListener("click",(t=>{t.preventDefault(),e.classList.remove("catalog-sorting--open")}))}class CitiesModal{#F=null;#T=null;#t=null;#Y=null;#U=null;#Q=null;#J=null;#X=null;#Z=null;constructor({modalElement:e,initScrollContainer:t,openModal:i}){this.#F=e,this.#T=t,this.#t=i}open=e=>{e.preventDefault();const t=e.target.closest(".popup");t&&t.remove(),this.#t(this.#F),this.#F.querySelector("input").focus()};#y=e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",this.#Q.classList.remove("cities__scroll-container--hidden"),e.focus()}};init(){this.#Y=this.#F.querySelector(".cities__form"),this.#U=this.#F.querySelector(".cities__list-wrapper"),this.#Q=this.#F.querySelector(".cities__scroll-container--popular"),this.#J=this.#F.querySelector(".cities__scroll-container--found"),this.#X=this.#T(this.#Q),this.#Z=this.#T(this.#J),this.#Y.addEventListener("click",this.#y);new MutationObserver((()=>{this.#X.update(),this.#Z.update()})).observe(this.#U,{subtree:!0,characterData:!0,attributes:!0,childList:!0}),document.querySelectorAll('[data-modal-opener="cities"]').forEach((e=>{e.addEventListener("click",this.open)}))}}function initCitiesModal(e,t,i){const r=new CitiesModal({modalElement:e,initScrollContainer:t,openModal:i});return r.init(),r}function initCooperationModal(e,t,i,r,o,n){n(e,t,i,r,o,{success:{heading:"Спасибо! Ваша заявка успешно отправлена",text:"Наш менеджер свяжется с вами в течении 3 рабочих дней для обсуждения деталей"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}})}function initDateField(e,t){const i=e.querySelector(".text-field__control"),r=e.querySelector(".text-field__calendar-button");let o=null;const n=new AirDatepicker(e,{classes:"calendar text-field__calendar",dateFormat:"dd.MM.yyyy",minDate:e.closest('[data-modal="salon"]')?Date.now():"",navTitles:{classes:"text-field__calendar",days:'MMMM <span class="calendar__title-accent">yyyy</span>',weekends:[0,6]},onSelect({formattedDate:e}){i.value=e||"",i.dispatchEvent(new Event("input")),l()}});function s(e){e&&n.selectDate(e,{updateTime:!1,silent:!0})}function l(){o.classList.remove("text-field__calendar--open"),document.removeEventListener("click",c),r.classList.remove("text-field__calendar-button--active")}function a(){o.classList.contains("text-field__calendar--open")?l():(s(d(i.value)),n.setViewDate(d(i.value)||Date.now()),n.setCurrentView("days"),o.classList.add("text-field__calendar--open"),document.addEventListener("click",c),r.classList.add("text-field__calendar-button--active"))}function d(e){return e.split(".").reverse().join("-")}function c({target:e}){e.closest(".text-field--date")||e.closest(".calendar__title-accent")||l()}o=e.querySelector(".text-field__calendar"),i.addEventListener("input",(()=>{if(!i.value)return;const e=d(i.value);s(e),o.classList.contains("text-field__calendar--open")&&(n.setViewDate(e),n.setCurrentView("days"))})),r.addEventListener("click",(()=>{a()})),i.addEventListener("keydown",(e=>{isSpaceEvent(e)&&(e.preventDefault(),a())})),t(i)}function initDocumentModal(e,t){const i=e.dataset.modal;document.querySelectorAll(`[data-modal-opener="${i}"]`).forEach((i=>{i.addEventListener("click",(i=>{i.preventDefault(),t(e)}))}))}function initFeed(e){const t=e.querySelector(".swiper"),i=e.querySelector(".slider-arrows__button--prev"),r=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:10,navigation:{prevEl:i,nextEl:r},breakpoints:{1900:{spaceBetween:16}}})}function initFeedbackForm(e,t,i,r){const o="button--pending",n=e.querySelector(".feedback-form__item--name .text-field__control"),s=e.querySelector(".feedback-form__item--email .text-field__control"),l=e.querySelector(".feedback-form__item--phone .text-field__control"),a=e.querySelector(".feedback-form__item--comment .textarea__control"),d=e.querySelector(".feedback-form__submit-button"),c=e.getAttribute("action");n&&(n.pattern=/^[a-zа-яЁё -]+$/i,n.dataset.pristineRequiredMessage="Заполните это поле.",n.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),l&&(l.dataset.pristineRequiredMessage="Заполните это поле."),s&&(s.dataset.pristineRequiredMessage="Заполните это поле.",s.dataset.pristineEmailMessage="Введите корректный e-mail адрес."),a&&(a.dataset.pristineRequiredMessage="Заполните это поле.");const u=new Pristine(e,{classTo:"feedback-form__item",errorClass:"invalid",errorTextParent:"feedback-form__item",errorTextTag:"p",errorTextClass:"prompt-text"});e.addEventListener("click",(e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",e.focus()}})),e.addEventListener("submit",(n=>{n.preventDefault();u.validate()?(d.disabled=!0,d.classList.add(o),t(c,new FormData(n.target),(()=>{e.reset(),r(i,{heading:"Спасибо за обратную связь!"})}),(()=>{r(i,{status:"error",heading:"Ошибка",text:"Не удалось отправить сообщение, попробуйте снова."})}),(()=>{d.disabled=!1,d.classList.remove(o)}))):(e.classList.remove("feedback-form--error"),setTimeout((()=>e.classList.add("feedback-form--error")),50))}))}function initFeedbackModal(e,t,i,r,o,n){n(e,t,i,r,o,{success:{heading:"Заявка успешно отправлена",text:"Наш менеджер свяжется с вами"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}})}function initFileField(e){const t=e.querySelector(".file-field__control");e.addEventListener("change",(({target:t})=>{e.classList.toggle("file-field--empty",!t.value)})),e.addEventListener("click",(({target:i})=>{i.closest(".file-field__reset-button")&&(e.classList.add("file-field--empty"),t.value="")}))}function initFilterSlider(e){new Swiper(e,{slidesPerView:"auto",spaceBetween:10,breakpoints:{1346:{spaceBetween:20}}})}function toggleFoldState(e){const t=e.closest(".folds__item"),i=t.querySelector(".folds__content-wrapper"),r=i.querySelector(".folds__content").getBoundingClientRect().height;i.style.height=`${r}px`,setTimeout((()=>{t.classList.toggle("folds__item--open")}),20),e.ariaExpanded="true"===e.ariaExpanded?"false":"true"}function initFolds(e){e.addEventListener("click",(({target:e})=>{const t=e.closest(".folds__button");t&&toggleFoldState(t)})),e.addEventListener("transitionend",(({target:e})=>{const t=e.closest(".folds__item");t&&t.classList.contains("folds__item--open")&&e.classList.contains("folds__content-wrapper")&&setTimeout((()=>{e.style.height="auto"}),0)}))}function createGalleryModalTemplate(e){return`\n    <div class="modal modal--with_gallery modal--with_review-gallery">\n      <div class="modal__inner">\n        <button class="modal__close-button" type="button"><span class="visually-hidden">Закрыть</span></button>\n        <div class="gallery modal__gallery">\n          <div class="gallery__inner">\n            <div class="gallery__slider">\n              <ul class="slider-arrows gallery__slider-arrows slider-arrows--with-background">\n                <li class="slider-arrows__item">\n                  <button class="slider-arrows__button slider-arrows__button--prev" type="button"><span class="visually-hidden">Предыдущий</span></button>\n                </li>\n                <li class="slider-arrows__item">\n                  <button class="slider-arrows__button slider-arrows__button--next" type="button"><span class="visually-hidden">Следующий</span></button>\n                </li>\n              </ul>\n              <div class="gallery__slider-wrapper swiper">\n                <ul class="gallery__slider-list swiper-wrapper">\n                  ${e.map((e=>`\n                    <li class="gallery__slider-item swiper-slide">\n                      ${"video"===e.type?`\n                        <div class="video gallery__video">\n                          <video class="video__player" src="${e.src}" controls="controls"></video>\n                          <img class="video__poster" src="${e.posterSrc}" alt="" loading="lazy">\n                          <div class="video__play-button-wrapper">\n                            <button class="video__play-button"><span class="visually-hidden">Воспроизвести</span></button>\n                          </div>\n                        </div>\n                      `:`\n                        <picture class="gallery__image-wrapper">\n                          <img class="gallery__image" src="${e.src}" alt="" loading="lazy">\n                        </picture>\n                      `}\n                    </li>\n                  `)).join("")}\n                </ul>\n              </div>\n            </div>\n            <div class="gallery__thumbnails-slider">\n              <ul class="slider-arrows gallery__thumbnails-slider-arrows">\n                <li class="slider-arrows__item">\n                  <button class="slider-arrows__button slider-arrows__button--prev" type="button"><span class="visually-hidden">Предыдущий</span></button>\n                </li>\n                <li class="slider-arrows__item">\n                  <button class="slider-arrows__button slider-arrows__button--next" type="button"><span class="visually-hidden">Следующий</span></button>\n                </li>\n              </ul>\n              <div class="gallery__thumbnails-slider-wrapper swiper">\n                <ul class="gallery__thumbnails-slider-list swiper-wrapper">\n                  ${e.map((e=>`\n                    <li class="gallery__thumbnails-slider-item swiper-slide">\n                      ${"video"===e.type?`\n                        <div class="gallery__image-wrapper gallery__image-wrapper--video">\n                          <img class="gallery__thumbnails-image" src="${e.posterSrc}" alt=""/>\n                        </div>\n                      `:`\n                        <picture class="gallery__image-wrapper">\n                          <img class="gallery__thumbnails-image" src="${e.src}" alt="" loading="lazy"/>\n                        </picture>\n                      `}\n                    </li>\n                  `)).join("")}\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  `}class GalleryModal{#F=null;#t=null;#ee=null;constructor({content:e,openModal:t,initGallery:i,initVideo:r}){this.#t=t,this.#F=createElementByString(createGalleryModalTemplate(e)),document.body.append(this.#F),this.#ee=i(this.#F.querySelector(".gallery")),this.#F.querySelectorAll(".video").forEach(r)}open=(e=0)=>{this.#ee.slideTo(e,0),this.#t(this.#F)}}function initGallery(e){const t=e.querySelector(".gallery__slider-wrapper"),i=e.querySelector(".gallery__slider .slider-arrows__button--prev"),r=e.querySelector(".gallery__slider .slider-arrows__button--next"),o=e.querySelector(".gallery__thumbnails-slider-wrapper"),n=e.querySelector(".gallery__thumbnails-slider .slider-arrows__button--prev"),s=e.querySelector(".gallery__thumbnails-slider .slider-arrows__button--next"),l=t.querySelectorAll("video"),a=new Swiper(o,{spaceBetween:10,watchSlidesProgress:!0,slidesPerView:"auto",breakpoints:{768:{slidesPerView:3},1346:{spaceBetween:20}}});return new Swiper(t,{effect:"fade",fadeEffect:{crossFade:!0},navigation:{prevEl:[i,n],nextEl:[r,s]},thumbs:{swiper:a,slideThumbActiveClass:"gallery__thumbnails-slider-item--active"},on:{slideChange:()=>{l.forEach((e=>e.pause()))}}})}function setInputDateMask(e){function t(e){const t=getDigitsFromString(e);let i="";if(t.length){const e=+t[0];if(e<=3){if(i=e,t.length>1){const e=+t.substring(0,2);i=0===e?"01":e<=31?e.toString().padStart(2,"0"):31}if(t.length>2){const e=+t[2];if(e<=1){if(i=`${i}.${e}`,t.length>3){const e=t.substring(0,2),r=+t.substring(2,4);i=0===r?`${e}.01`:`${e}.${r<=12?r.toString().padStart(2,"0"):12}`}if(t.length>4){i+=`.${t.substring(4,8)}`}}else{if(i=`${t.substring(0,2)}.0${e}`,t.length>3){i+=`.${t.substring(3,7)}`}}}}else if(i=`0${e}`,t.length>1){const e=+t[1];if(e<=1){if(i=`${i}.${e}`,t.length>2){const e=t.substring(0,1).padStart(2,"0"),r=+t.substring(1,3);i=0===r?`${e}.01`:`${e}.${r<=12?r.toString().padStart(2,"0"):12}`}if(t.length>3){i+=`.${t.substring(3,7)}`}}else if(i=`${i}.0${e}`,t.length>2){i+=`.${t.substring(2,6)}`}}}return i}e.addEventListener("input",(i=>{(e.value.length===e.selectionStart||i.data&&/\D/g.test(i.data))&&(e.value=t(e.value))})),e.addEventListener("change",(()=>{e.value=t(e.value)}))}function initInstallmentRequestModal(e,t,i,r,o,n){n(e,t,i,r,o,{success:{heading:"Заявка успешно отправлена",text:"Наш менеджер свяжется с вами в течении 3 рабочих дней"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}})}async function initMap(e){const t=[44.008906,56.323592],i=e.querySelector(".map__inner");setTimeout((()=>{i.classList.remove("map__inner--hidden")}),8e3),await ymaps3.ready;const{YMap:r,YMapDefaultSchemeLayer:o,YMapMarker:n,YMapDefaultFeaturesLayer:s}=ymaps3,l=new r(i,{location:{center:t,zoom:15}});l.addChild(new o({customization:customizationFile})),l.addChild(new s);const a=new n({coordinates:t},document.querySelector("#map-marker-template").content.querySelector(".map-marker").cloneNode(!0));l.addChild(a)}const MODAL_DISAPPEARANCE_TIME=100,openedModals=[];function openModal(e){e.classList.remove("modal--hidden"),openedModals.push(e),document.addEventListener("keydown",onModalEscapeEvent),document.addEventListener("click",onModalClick),setTimeout((()=>{e.classList.add("modal--open")}),100)}function closeModal(e){e.classList.remove("modal--error"),e.classList.remove("modal--open"),openedModals.pop(),openedModals.length||(document.removeEventListener("keydown",onModalEscapeEvent),document.removeEventListener("click",onModalClick)),setTimeout((()=>{e.classList.add("modal--hidden"),(e.classList.contains("modal--with_alert")||e.classList.contains("modal--with_review-gallery"))&&e.remove()}),MODAL_DISAPPEARANCE_TIME)}function onModalEscapeEvent(e){isEscapeEvent(e)&&(e.preventDefault(),closeModal(openedModals[openedModals.length-1]))}function onModalClick({target:e}){(e.classList.contains("modal__close-button")||e.classList.contains("alert__button"))&&closeModal(openedModals[openedModals.length-1])}function initNavigationShortcuts(e){const t=e.querySelector(".swiper");new Swiper(t,{slidesPerView:"auto",spaceBetween:10})}function initOneClickModal(e,t,i,r,o,n){n(e,t,i,r,o,{success:{heading:"Заявка успешно отправлена",text:"Наш менеджер свяжется с вами"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}})}class PhoneChangeModal{#te="button--pending";#ie=5;#re=0;#F=null;#t=null;#oe=null;#i=null;#ne=null;#se=null;#le=null;#ae=null;#de=null;#ce=null;#ue=null;#me=null;#pe=null;#he=null;#_e=null;#fe=null;#ge=null;#Ee=null;#ve=null;constructor({modalElement:e,openModal:t,closeModal:i,showAlert:r}){this.#F=e,this.#t=t,this.#oe=i,this.#i=r}close=()=>{this.#oe(this.#F)};open=()=>{this.#t(this.#F)};sendData=async(e,t,i,r,o)=>{try{const r=await fetch(e,{method:"POST",body:t});if(!r.ok)throw new Error(`${r.status} – ${r.statusText}`);i(await r.json())}catch(e){r()}finally{o()}};#E(){this.#ce.dataset.pristineRequiredMessage="Заполните это поле.",this.#_e.dataset.pristineRequiredMessage="Заполните это поле."}#v=()=>{this.#de=new Pristine(this.#le,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"}),this.#pe=new Pristine(this.#ue,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"})};finishWaitingForResend=()=>{this.#fe.prepend(this.#ge),this.#Ee.remove()};startWaitingForResend=()=>{this.#re=this.#ie,this.#ve.textContent=this.#re;const e=setInterval((()=>{this.#re--,this.#ve.textContent=this.#re,this.#re<=0&&(clearInterval(e),this.finishWaitingForResend())}),1e3);this.#ge.remove(),this.#fe.prepend(this.#Ee)};goToCodeRequestForm=()=>{this.#le.classList.remove("modal-form__form--hidden"),this.#ue.classList.add("modal-form__form--hidden")};goToCodeSendingForm=()=>{this.#le.classList.add("modal-form__form--hidden"),this.#ue.classList.remove("modal-form__form--hidden");const e=this.#ce.value.replace(/[()]/g,"").replace(/-/g," ");this.#he.textContent=e,this.startWaitingForResend()};#be=e=>{const t=e.target.closest(".text-field__clear-button"),i=e.target.closest(".modal-form__back-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");return e.value="",void e.focus()}i&&(e.preventDefault(),this.goToCodeRequestForm())};#Se=e=>{e.preventDefault();this.#de.validate()?(this.#ae.disabled=!0,this.#ae.classList.add(this.#te),this.sendData("https://fakestoreapi.com/products",new FormData(e.target),(()=>{this.goToCodeSendingForm()}),(()=>{this.close(),this.#i(this.#t,{status:"error",heading:"Ошибка",text:"Не удалось получить код, попробуйте снова."})}),(()=>{this.#ae.disabled=!1,this.#ae.classList.remove(this.#te)}))):(this.#F.classList.remove("modal--error"),setTimeout((()=>this.#F.classList.add("modal--error")),50))};#we=e=>{e.preventDefault(),this.#ge.disabled=!0;this.sendData("https://fakestoreapi.com/products",new FormData(this.#le),(()=>{this.startWaitingForResend(),this.#i(this.#t,{heading:"Код отправлен повторно"})}),(()=>{this.#i(this.#t,{status:"error",heading:"Ошибка",text:"Не удалось получить код, попробуйте снова."})}),(()=>{this.#ge.disabled=!1}))};#ye=e=>{e.preventDefault();this.#pe.validate()?(this.#me.disabled=!0,this.#me.classList.add(this.#te),this.sendData("https://fakestoreapi.com/products",new FormData(e.target),(()=>{const e=this.#ce.value;this.#le.reset(),this.#ue.reset(),this.close(),this.goToCodeRequestForm(),this.#i(this.#t,{heading:"Телефон успешно изменен",buttonText:"Принять"}),this.#ne&&(this.#ne.value=e),this.#se&&(this.#se.textContent=e)}),(()=>{this.#i(this.#t,{status:"error",heading:"Ошибка",text:"Не удалось подтвердить код, попробуйте снова."})}),(()=>{this.#me.disabled=!1,this.#me.classList.remove(this.#te)}))):(this.#F.classList.remove("modal--error"),setTimeout((()=>this.#F.classList.add("modal--error")),50))};#xe=e=>{e.preventDefault(),this.open()};init(){this.#ne=document.querySelector(".profile-form__item--phone .text-field__control"),this.#se=document.querySelector(".account__phone"),this.#le=this.#F.querySelector(".modal-form__form--code-request"),this.#ae=this.#le.querySelector(".modal-form__submit-button"),this.#ce=this.#le.querySelector(".modal-form__item--tel .text-field__control"),this.#ue=this.#F.querySelector(".modal-form__form--code-sending"),this.#me=this.#ue.querySelector(".modal-form__submit-button"),this.#he=this.#ue.querySelector(".modal-form__phone-text"),this.#_e=this.#ue.querySelector(".modal-form__item--code .text-field__control"),this.#fe=this.#ue.querySelector(".modal-form__footer"),this.#ge=this.#ue.querySelector(".modal-form__footer-button--resend-code"),this.#Ee=this.#ue.querySelector(".modal-form__footer-text--resend-code"),this.#ve=this.#Ee.querySelector(".modal-form__footer-text-timer"),this.#E(),this.#v(),this.#F.addEventListener("click",this.#be),this.#le.addEventListener("submit",this.#Se),this.#ue.addEventListener("submit",this.#ye),this.#ge.addEventListener("click",this.#we),document.querySelectorAll('[data-modal-opener="phone-change"]').forEach((e=>{e.addEventListener("click",this.#xe)}))}}function initPhoneChangeModal(e,t,i,r){const o=new PhoneChangeModal({modalElement:e,openModal:t,closeModal:i,showAlert:r});return o.init(),o}function initPremiumBrandsSlider(e){const t=e.querySelector(".swiper"),i=e.querySelector(".slider-arrows__button--prev"),r=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",loop:!0,navigation:{prevEl:i,nextEl:r}})}function createProductCardTemplate(e,t){const i=new Intl.NumberFormat("ru");let r=null,o=null;e.discount?(o=i.format(e.price),r=i.format(e.price*(100-e.discount)/100)):r=i.format(e.price);const n=Object.values(e.dimensions).join("х");return`\n    <article class="product-card product-card-popup__card ${t||""}">\n      <div class="product-card__heading-and-signs">\n        <h3 class="product-card__heading">\n          <a class="product-card__link" href="${e.href}">${e.title}</a>\n        </h3>\n        <p class="product-card__signs">${n}</p>\n      </div>\n      <div class="product-card__prices">\n        <p class="product-card__price ${e.discount?"accent":""}">${r} ₽</p>\n        ${e.discount?`<s class="product-card__old-price">${o} ₽</s><p class="producr-card__discount">-${e.discount}%</p>`:""}\n      </div>\n      <a class="product-card__slider swiper" href="${e.href}">\n        <ul class="product-card__slider-list swiper-wrapper">\n          ${e.images.map(((t,i)=>`\n            <li class="product-card__slider-item swiper-slide">\n              <img class="product-card__image" src="${t}" srcset="${e.images2x[i]} 2x" alt="" loading="lazy"/>\n            </li>\n          `)).join("")}\n        </ul>\n        <p class="product-card__slider-pagination"></p>\n      </a>\n      <div class="product-card__labels-wrapper">\n        <div class="product-card__labels">\n          ${e.isPremium?'<p class="product-card__premium-label"><span class="product-card__premium-label-text">Premium</span></p>':""}\n          ${"in-stock"===e.status?'<p class="product-card__label">В наличии</p>':""}\n          <p class="product-card__like-button-wrapper">\n            <button class="like-button product-card__like-button ${e.isFavorite?"like-button--active":""}" type="button">\n              <span class="visually-hidden">Нравится</span>\n            </button>\n          </p>\n        </div>\n      </div>\n      <a class="product-card__brand" href="${e.brandHref}">\n        Бренд <span class="product-card__brand-name">${e.brand}</span>\n      </a>\n    </article>\n  `}function initProductCard(e){const t=e.querySelector(".product-card__slider"),i=t.querySelector(".product-card__slider-pagination");new Swiper(t,{pagination:{el:i,bulletClass:"product-card__slider-pagination-button",bulletActiveClass:"product-card__slider-pagination-button--current",renderBullet:getPaginationButtonCreator()}})}function initProductHeaderStickyFormButtons(e){const t=document.querySelector(".page__inner"),i=()=>{t.scrollHeight-t.scrollTop===t.clientHeight?e.classList.remove("product-header__form-buttons--sticked"):e.classList.add("product-header__form-buttons--sticked")};t.addEventListener("scroll",throttle(i,100)),window.addEventListener("resize",throttle(i,100)),i()}function setSliderMode(e,t){e.itself.classList.add(e.modeClass,"swiper"),e.list.classList.add("swiper-wrapper"),e.slides.forEach((e=>e.classList.add("swiper-slide"))),e.swiper=new Swiper(e.itself,t)}function setSliderSimpleMode(e){setSliderMode(e,{pagination:{el:e.pagination,bulletClass:"product-images__slider-pagination-button",bulletActiveClass:"product-images__slider-pagination-button--current",renderBullet:getPaginationButtonCreator()},grabCursor:!0})}function resetSliderMode(e){e?.swiper?.destroy(!0,!0),e.itself.classList.remove("swiper"),e.list.classList.remove("swiper-wrapper"),e.slides.forEach((e=>{e.removeAttribute("aria-label"),e.removeAttribute("role"),e.classList.remove("swiper-slide")})),e.list.removeAttribute("aria-live"),e.pagination.innerHTML="",e.swiper=null}function initProductImages(e){const t={itself:e.querySelector(".product-images__slider"),list:e.querySelector(".product-images__slider-list"),slides:e.querySelectorAll(".product-images__slider-item"),pagination:e.querySelector(".product-images__slider-pagination")},i=window.matchMedia("(min-width: 1346px)"),r=()=>{i.matches?resetSliderMode(t):setSliderSimpleMode(t)};i.addEventListener("change",(()=>{r()})),r()}function initProductQuestionModal(e,t,i,r,o,n){n(e,t,i,r,o,{success:{heading:"Ваш вопрос успешно отправлен",text:"Наш менеджер свяжется с вами"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить вопрос, попробуйте снова."}})}function initProducts(e){const t=e.querySelector(".swiper"),i=e.querySelector(".slider-arrows__button--prev"),r=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:15,navigation:{prevEl:i,nextEl:r},breakpoints:{768:{spaceBetween:20},1346:{spaceBetween:30},1900:{spaceBetween:40}}})}function initProfileForm(e,t,i,r){const o="button--pending",n=e.querySelector(".profile-form__item--name .text-field__control"),s=e.querySelector(".profile-form__item--surname .text-field__control"),l=e.querySelector(".profile-form__item--patronymic .text-field__control"),a=e.querySelector(".profile-form__item--email .text-field__control"),d=e.querySelector(".profile-form__item--date .text-field__control"),c=e.querySelector(".profile-form__item--city .text-field__control"),u=e.querySelector(".profile-form__item--street .text-field__control"),m=e.querySelector(".profile-form__item--house .text-field__control"),p=e.querySelector(".profile-form__submit-button"),h=e.getAttribute("action");function _(){const t=[];return e.querySelectorAll("input").forEach((e=>{"checkbox"===e.type?t.push(e.checked):t.push(e.value.trim())})),t}n&&(n.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),n.dataset.pristineRequiredMessage="Заполните это поле.",n.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),s&&(s.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),s.dataset.pristineRequiredMessage="Заполните это поле.",s.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),l&&(l.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),l.dataset.pristineRequiredMessage="Заполните это поле.",l.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),a&&(a.dataset.pristineRequiredMessage="Заполните это поле.",a.dataset.pristineEmailMessage="Введите корректный e-mail адрес."),d&&(d.pattern=/^(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[0-2])\.\d{4}$/,d.dataset.pristineRequiredMessage="Заполните это поле.",d.dataset.pristinePatternMessage="Введите дату в формате дд.мм.гггг"),c&&(c.dataset.pristineRequiredMessage="Заполните это поле."),u&&(u.dataset.pristineRequiredMessage="Заполните это поле."),m&&(m.dataset.pristineRequiredMessage="Заполните это поле.");let f=_();const g=new Pristine(e,{classTo:"profile-form__item",errorClass:"invalid",errorTextParent:"profile-form__item",errorTextTag:"p",errorTextClass:"prompt-text"});e.addEventListener("click",(e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",e.focus(),e.dispatchEvent(new Event("input",{bubbles:!0}))}})),e.addEventListener("change",(()=>{e.classList.remove("profile-form--error")})),e.addEventListener("input",(()=>{p.disabled=!function(){const e=_().join();return f.join()!==e}()})),e.addEventListener("submit",(n=>{n.preventDefault();g.validate()?(p.disabled=!0,p.classList.add(o),t(h,new FormData(n.target),(()=>{f=_(),r(i,{heading:"Данные успешно обновлены"})}),(()=>{r(i,{status:"error",heading:"Ошибка",text:"Не удалось обновить данные, попробуйте снова."})}),(()=>{p.disabled=!1,p.classList.remove(o)}))):(e.classList.remove("profile-form--error"),setTimeout((()=>e.classList.add("profile-form--error")),50))}))}const productMockData={id:"1",title:"Тумба Mock",isPremium:!0,isFavorite:!1,status:"in-stock",price:100,discount:0,dimensions:{width:"15",length:"20",height:"60"},images:["img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp"],images2x:["img/products/product-3@2x.webp","img/products/product-3@2x.webp","img/products/product-3@2x.webp","img/products/product-3@2x.webp","img/products/product-3@2x.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"};function createProductCardPopupTemplate(e,t,i){return`\n    <div class="product-card-popup pin__popup">\n      <div class="product-card-popup__inner">\n        <button class="product-card-popup__close-button" type="button"><span class="visually-hidden">Закрыть</span></button>\n        ${t(e,i)}\n        <a class="product-card-popup__link" href="${e.href}">Подробнее</a>\n      </div>\n    </div>\n  `}function closeActivePin(e){const t=e.querySelector(".pin__popup"),i=e.querySelector(".plus-button");t.classList.add("pin__popup--closing"),setTimeout((()=>{t.remove()}),100),i.classList.remove("plus-button--active"),e.classList.remove("pin--active")}function closeAllActivePins(e){e.forEach((e=>{e.classList.contains("pin--active")&&closeActivePin(e)}))}function initProject(e,t,i,r,o){const n=e.querySelectorAll(".pin");e.addEventListener("click",(e=>{const s=e.target.closest(".plus-button"),l=e.target.closest(".product-card-popup__close-button");if(s){const e=s.closest(".pin");if(s.classList.contains("plus-button--active"))closeActivePin(e);else{closeAllActivePins(n),s.disabled=!0;(async(e,t,i,r)=>{try{const i=await fetch(e);if(!i.ok)throw new Error(`${i.status} – ${i.statusText}`);t(await i.json())}catch(e){i()}finally{r()}})(`https://fakestoreapi.com/products/${e.dataset.productId}`,(r=>{const o=createElementByString(createProductCardPopupTemplate(r&&productMockData,t,"product-card--popup"));i(o.querySelector(".product-card")),e.append(o),s.classList.add("plus-button--active"),e.classList.add("pin--active");if(!window.matchMedia("(min-width: 1024px)").matches)return;if(o.getBoundingClientRect().x<100){o.querySelector(".product-card-popup__inner").style.transformOrigin="left bottom",o.style.right="auto",o.style.left="20px"}}),(()=>{o(r,{status:"error",heading:"Ошибка",text:"Не удалось загрузить данные товара, попробуйте снова."})}),(()=>{s.disabled=!1}))}}if(l){closeActivePin(l.closest(".pin"))}}))}function initProjectsSlider(e){const t=e.querySelector(".swiper"),i=e.querySelector(".slider-arrows__button--prev"),r=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:20,navigation:{prevEl:i,nextEl:r},breakpoints:{1346:{spaceBetween:30},1900:{spaceBetween:40}}})}function initReviewModal(e,t,i,r,o,n){n(e,t,i,r,o,{success:{heading:"Спасибо, что оценили нашу работу",text:"Ваш отзыв будет проверен модератором сайта, и опубликован в течение 2 рабочих дней"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить отзыв, попробуйте снова."}})}const mockReviewGalleryData=[{type:"video",src:"files/video.mp4",posterSrc:"img/reviews/review-1.webp"},{type:"image",src:"img/reviews/review-1.webp"},{type:"image",src:"img/reviews/review-2.webp"},{type:"image",src:"img/reviews/review-3.webp"},{type:"image",src:"img/reviews/review-1.webp"},{type:"image",src:"img/reviews/review-2.webp"},{type:"image",src:"img/reviews/review-3.webp"}];class ReviewsList{#qe=null;#Ce=null;#Le=null;#Me=null;#t=null;#i=null;#Fe=null;constructor({listElement:e,galleryModal:t,initGallery:i,initVideo:r,openModal:o,showAlert:n}){this.#qe=e,this.#Ce=t,this.#Le=i,this.#Me=r,this.#t=o,this.#i=n}#Te=async(e,t,i,r)=>{try{const i=await fetch(e);if(!i.ok)throw new Error(`${i.status} – ${i.statusText}`);t(await i.json())}catch(e){i()}finally{r()}};updateReviewsTextWrappersList=()=>{this.#Fe=this.#qe.querySelectorAll(".review__text-wrapper")};#ke=()=>{this.#Fe.forEach((e=>{const t=e.classList.contains("review__text-wrapper--clipped");e.classList.add("review__text-wrapper--clipped");const i=e.querySelector(".review__text");i.scrollHeight>i.offsetHeight?e.classList.add("review__text-wrapper--clippable"):e.classList.remove("review__text-wrapper--clippable"),t||e.classList.remove("review__text-wrapper--clipped")}))};#w=throttle(this.#ke,500);#Ae=e=>{const t=e.target.closest(".review__toggle-button"),i=e.target.closest(".feed__slider-item");if(t){t.closest(".review__text-wrapper").classList.toggle("review__text-wrapper--clipped")}if(i){e.preventDefault();const t=i.parentElement;t.classList.add("no-click");const r=Array.from(t.children).indexOf(i),o=`https://fakestoreapi.com/products/${i.closest(".review").dataset.id}`;this.#Te(o,(e=>{new this.#Ce({content:e&&mockReviewGalleryData,openModal:this.#t,initGallery:this.#Le,initVideo:this.#Me}).open(r)}),(()=>{this.#i(this.#t,{status:"error",heading:"Ошибка",text:"Не удалось загрузить данные, попробуйте снова."})}),(()=>{t.classList.remove("no-click")}))}};init=()=>{this.updateReviewsTextWrappersList(),this.#ke(),window.addEventListener("resize",this.#w),this.#qe.addEventListener("click",this.#Ae)}}function initReviewsList(e,t,i,r,o,n){const s=new ReviewsList({listElement:e,galleryModal:t,initGallery:i,initVideo:r,openModal:o,showAlert:n});return s.init(),s}function initSalonModal(e,t,i,r,o,n){n(e,t,i,r,o,{success:{heading:"Заявка успешно отправлена",text:"Наш менеджер свяжется с вами"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}})}function initScrollContainer(e){const t=e.querySelector(".swiper-scrollbar");return new Swiper(e,{direction:"vertical",slidesPerView:"auto",freeMode:!0,autoHeight:!0,scrollbar:{el:t,draggable:!0},mousewheel:!0})}const searchResultMockData={products:[{id:"1",title:"Стул Tosca",isPremium:!0,isFavorite:!1,status:"in-stock",price:12e3,discount:0,dimensions:{width:"15",length:"20",height:"60"},images:["img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp"],images2x:["img/products/product-1@2x.webp","img/products/product-1@2x.webp","img/products/product-1@2x.webp","img/products/product-1@2x.webp","img/products/product-1@2x.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"},{id:"2",title:"Стул Tosca",isPremium:!0,isFavorite:!1,status:"in-stock",price:15e3,discount:0,dimensions:{width:"15",length:"20",height:"60"},images:["img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp"],images2x:["img/products/product-2@2x.webp","img/products/product-2@2x.webp","img/products/product-2@2x.webp","img/products/product-2@2x.webp","img/products/product-2@2x.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"},{id:"3",title:"Тумба Mock",isPremium:!0,isFavorite:!1,status:"in-stock",price:2e4,discount:10,dimensions:{width:"15",length:"20",height:"60"},images:["img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp"],images2x:["img/products/product-3@2x.webp","img/products/product-3@2x.webp","img/products/product-3@2x.webp","img/products/product-3@2x.webp","img/products/product-3@2x.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"},{id:"1",title:"Стул Tosca",isPremium:!0,isFavorite:!1,status:"in-stock",price:12e3,discount:0,dimensions:{width:"15",length:"20",height:"60"},images:["img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp"],images2x:["img/products/product-1@2x.webp","img/products/product-1@2x.webp","img/products/product-1@2x.webp","img/products/product-1@2x.webp","img/products/product-1@2x.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"},{id:"2",title:"Стул Tosca",isPremium:!0,isFavorite:!1,status:"in-stock",price:15e3,discount:0,dimensions:{width:"15",length:"20",height:"60"},images:["img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp"],images2x:["img/products/product-2@2x.webp","img/products/product-2@2x.webp","img/products/product-2@2x.webp","img/products/product-2@2x.webp","img/products/product-2@2x.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"}],articles:[{title:"Смена экспозиции в&nbsp;выставочном зале",type:"Блог",image:"img/articles/previews/preview-1.webp",image2x:"img/articles/previews/preview-1@2x.webp 2x",date:"2023-05-10",href:"article.html"}]};class SearchModal{#Pe=4;#F=null;#t=null;#Re=null;#$e=null;#Y=null;#De=null;#Be=null;#Ie=null;#Ve=null;constructor({modalElement:e,openModal:t,createProductCardTemplate:i,initProductCard:r,createArticlePreviewTemplate:o}){this.#F=e,this.#t=t,this.#Be=i,this.#Ie=r,this.#Ve=o}#_=async(e,t,i,r)=>{try{const r=await fetch(e,{method:"POST",body:t});if(!r.ok)throw new Error(`${r.status} – ${r.statusText}`);i(await r.json())}catch(e){r()}};#be=e=>{const t=e.target.closest(".text-field__clear-button"),i=e.target.closest(".search-modal__popular-list-link");t&&(this.#$e.value="",this.#$e.focus(),this.#$e.dispatchEvent(new Event("input",{bubbles:!0}))),i&&(this.#$e.value=i.textContent,this.#$e.focus(),this.#$e.dispatchEvent(new Event("input",{bubbles:!0})))};#We(e,t,i){return`\n      <section class="search-modal__result-group">\n        <header class="search-modal__result-group-header">\n          <h3 class="search-modal__result-group-heading">По вашему запросу найдены «${e}»</h3>\n          ${t?`\n      <a class="search-modal__result-group__link link link--small" href="${t}">Ещё результаты</a>\n    `:""}\n        </header>\n        ${i}\n      </section>\n    `}#He=()=>{if(this.#$e.value.trim().length<3)return this.#Re.classList.remove("search-modal--with-result"),void(this.#De.innerHTML="");this.#Re.classList.add("search-modal--with-result");this.#_("https://fakestoreapi.com/products",new FormData(this.#Y),(e=>{this.#De.innerHTML="";const t=e&&searchResultMockData;if(t.products.length||t.articles.length){if(t.products.length){const e=`\n            <ul class="products-list products-list--size_xs search-modal__result-group-list">\n              ${t.products.slice(0,this.#Pe).map((e=>this.#Be(e,"product-card--size_xs"))).join("")}\n            </ul>\n          `,i=t.products.length>this.#Pe?`search.html?query=${this.#$e.value.trim()}`:null,r=createElementByString(this.#We("Товары",i,e));r.querySelectorAll(".product-card").forEach(this.#Ie),this.#De.append(r)}if(t.articles.length){const e=`\n            <ul class="articles-list articles-list--size_s search-modal__result-group-list">\n              ${t.articles.map((e=>this.#Ve(e,"article-preview--size_s"))).join("")}\n            </ul>\n          `,i=t.articles.length>this.#Pe?`search.html?query=${this.#$e.value.trim()}`:null,r=createElementByString(this.#We("Статьи",i,e));this.#De.append(r)}}else this.#De.insertAdjacentHTML("beforeend",'<p class="search-modal__result-placeholder">По вашему запросу ничего не найдено</p>')}),(()=>{this.#De.innerHTML="",this.#De.insertAdjacentHTML("beforeend",'<p class="search-modal__result-placeholder search-modal__result-placeholder--error">Ошибка. Не удалось произвести поиск.</p>')}))};#Oe=debounce(this.#He,500);open=e=>{e.preventDefault(),this.#t(this.#F),this.#F.querySelector("input").focus()};init=()=>{this.#Re=this.#F.querySelector(".search-modal"),this.#Y=this.#Re.querySelector(".search-modal__form"),this.#$e=this.#Y.querySelector(".text-field__control"),this.#De=this.#Re.querySelector(".search-modal__result"),document.querySelectorAll('[data-modal-opener="search"]').forEach((e=>{e.addEventListener("click",this.open)})),this.#Re.addEventListener("click",this.#be),this.#$e.addEventListener("input",this.#Oe)}}function initSearchModal(e,t,i,r,o){const n=new SearchModal({modalElement:e,openModal:t,createProductCardTemplate:i,initProductCard:r,createArticlePreviewTemplate:o});return n.init(),n}function initSelectionSlider(e){const t=e.querySelector(".swiper"),i=e.querySelector(".slider-arrows__button--prev"),r=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:20,navigation:{prevEl:i,nextEl:r},breakpoints:{1346:{spaceBetween:30},1900:{spaceBetween:40}}})}class SignInModal{#te="button--pending";#ie=5;#re=0;#F=null;#t=null;#oe=null;#i=null;#le=null;#ae=null;#de=null;#ce=null;#ue=null;#me=null;#pe=null;#he=null;#_e=null;#fe=null;#ge=null;#Ee=null;#ve=null;constructor({modalElement:e,openModal:t,closeModal:i,showAlert:r}){this.#F=e,this.#t=t,this.#oe=i,this.#i=r}close=()=>{this.#oe(this.#F)};open=()=>{this.#t(this.#F)};sendData=async(e,t,i,r,o)=>{try{const r=await fetch(e,{method:"POST",body:t});if(!r.ok)throw new Error(`${r.status} – ${r.statusText}`);i(await r.json())}catch(e){r()}finally{o()}};#E(){this.#ce.dataset.pristineRequiredMessage="Заполните это поле.",this.#_e.dataset.pristineRequiredMessage="Заполните это поле."}#v=()=>{this.#de=new Pristine(this.#le,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"}),this.#pe=new Pristine(this.#ue,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"})};finishWaitingForResend=()=>{this.#fe.prepend(this.#ge),this.#Ee.remove()};startWaitingForResend=()=>{this.#re=this.#ie,this.#ve.textContent=this.#re;const e=setInterval((()=>{this.#re--,this.#ve.textContent=this.#re,this.#re<=0&&(clearInterval(e),this.finishWaitingForResend())}),1e3);this.#ge.remove(),this.#fe.prepend(this.#Ee)};goToCodeRequestForm=()=>{this.#le.classList.remove("modal-form__form--hidden"),this.#ue.classList.add("modal-form__form--hidden")};goToCodeSendingForm=()=>{this.#le.classList.add("modal-form__form--hidden"),this.#ue.classList.remove("modal-form__form--hidden");const e=this.#ce.value.replace(/[()]/g,"").replace(/-/g," ");this.#he.textContent=e,this.startWaitingForResend()};#be=e=>{const t=e.target.closest(".text-field__clear-button"),i=e.target.closest(".modal-form__back-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");return e.value="",void e.focus()}i&&(e.preventDefault(),this.goToCodeRequestForm())};#Se=e=>{e.preventDefault();this.#de.validate()?(this.#ae.disabled=!0,this.#ae.classList.add(this.#te),this.sendData("https://fakestoreapi.com/products",new FormData(e.target),(()=>{this.goToCodeSendingForm()}),(()=>{this.close(),this.#i(this.#t,{status:"error",heading:"Ошибка",text:"Не удалось получить код, попробуйте снова."})}),(()=>{this.#ae.disabled=!1,this.#ae.classList.remove(this.#te)}))):(this.#F.classList.remove("modal--error"),setTimeout((()=>this.#F.classList.add("modal--error")),50))};#we=e=>{e.preventDefault(),this.#ge.disabled=!0;this.sendData("https://fakestoreapi.com/products",new FormData(this.#le),(()=>{this.startWaitingForResend(),this.#i(this.#t,{heading:"Код отправлен повторно"})}),(()=>{this.#i(this.#t,{status:"error",heading:"Ошибка",text:"Не удалось получить код, попробуйте снова."})}),(()=>{this.#ge.disabled=!1}))};#ye=e=>{e.preventDefault();this.#pe.validate()?(this.#me.disabled=!0,this.#me.classList.add(this.#te),this.sendData("https://fakestoreapi.com/products",new FormData(e.target),(()=>{this.#le.reset(),this.#ue.reset(),this.close(),this.goToCodeRequestForm()}),(()=>{this.#i(this.#t,{status:"error",heading:"Ошибка",text:"Не удалось подтвердить код, попробуйте снова."})}),(()=>{this.#me.disabled=!1,this.#me.classList.remove(this.#te)}))):(this.#F.classList.remove("modal--error"),setTimeout((()=>this.#F.classList.add("modal--error")),50))};#xe=e=>{e.preventDefault(),this.open()};init(){this.#le=this.#F.querySelector(".modal-form__form--code-request"),this.#ae=this.#le.querySelector(".modal-form__submit-button"),this.#ce=this.#le.querySelector(".modal-form__item--tel .text-field__control"),this.#ue=this.#F.querySelector(".modal-form__form--code-sending"),this.#me=this.#ue.querySelector(".modal-form__submit-button"),this.#he=this.#ue.querySelector(".modal-form__phone-text"),this.#_e=this.#ue.querySelector(".modal-form__item--code .text-field__control"),this.#fe=this.#ue.querySelector(".modal-form__footer"),this.#ge=this.#ue.querySelector(".modal-form__footer-button--resend-code"),this.#Ee=this.#ue.querySelector(".modal-form__footer-text--resend-code"),this.#ve=this.#Ee.querySelector(".modal-form__footer-text-timer"),this.#E(),this.#v(),this.#F.addEventListener("click",this.#be),this.#le.addEventListener("submit",this.#Se),this.#ue.addEventListener("submit",this.#ye),this.#ge.addEventListener("click",this.#we),document.querySelectorAll('[data-modal-opener="sign-in"]').forEach((e=>{e.addEventListener("click",this.#xe)}))}}function initSignInModal(e,t,i,r){const o=new SignInModal({modalElement:e,openModal:t,closeModal:i,showAlert:r});return o.init(),o}function initSimpleModalForm(e,t,i,r,o,n){const s="button--pending",l=e.dataset.modal,a=e.querySelector(".modal__form"),d=a.querySelector(".modal-form__submit-button"),c=e.querySelector(".modal-form__item--name .text-field__control"),u=e.querySelector(".modal-form__item--surname .text-field__control"),m=e.querySelector(".modal-form__item--patronymic .text-field__control"),p=e.querySelector(".modal-form__item--phone .text-field__control"),h=e.querySelector(".modal-form__item--email .text-field__control"),_=e.querySelector(".modal-form__item--date .text-field__control"),f=e.querySelector(".modal-form__item--comment .textarea__control");c&&(c.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),c.dataset.pristineRequiredMessage="Заполните это поле.",c.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),u&&(u.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),u.dataset.pristineRequiredMessage="Заполните это поле.",u.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),m&&(m.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),m.dataset.pristineRequiredMessage="Заполните это поле.",m.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),p&&(p.dataset.pristineRequiredMessage="Заполните это поле.",p.dataset.pristineEmailMessage="Введите корректный номер телефона."),h&&(h.dataset.pristineRequiredMessage="Заполните это поле.",h.dataset.pristineEmailMessage="Введите корректный e-mail адрес."),_&&(_.pattern=/^(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[0-2])\.\d{4}$/,_.dataset.pristineRequiredMessage="Заполните это поле.",_.dataset.pristinePatternMessage="Введите дату в формате дд.мм.гггг"),f&&(f.dataset.pristineRequiredMessage="Заполните это поле.");const g=a.getAttribute("action"),E=new Pristine(a,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"});a.addEventListener("click",(e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",e.focus()}})),a.addEventListener("submit",(l=>{l.preventDefault();E.validate()?(d.disabled=!0,d.classList.add(s),t(g,new FormData(l.target),(()=>{r(e),o(i,n.success),a.reset()}),(()=>{r(e),o(i,n.error)}),(()=>{d.disabled=!1,d.classList.remove(s)}))):(e.classList.remove("modal--error"),setTimeout((()=>e.classList.add("modal--error")),50))})),document.querySelectorAll(`[data-modal-opener="${l}"]`).forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault(),E.reset(),e.classList.remove("modal--error"),i(e),e.querySelector("input").focus()}))}))}function initSiteHeader(e){const t=e.querySelector(".site-header__menu-button"),i=e.querySelector(".site-header__navigation"),r=window.matchMedia("(min-width: 1260px)");t.addEventListener("click",(()=>{t.classList.toggle("site-header__menu-button--close"),t.ariaExpanded="true"===t.ariaExpanded?"false":"true",i.classList.toggle("site-header__navigation--open"),e.classList.toggle("page__site-header--expand")}));const o=i.querySelector(".site-navigation__panels"),n=i.querySelector(".site-navigation__back-button"),s=i.querySelector(".site-navigation__title");i.querySelector(".site-navigation__close-button").addEventListener("click",(r=>{r.preventDefault(),i.classList.remove("site-header__navigation--open"),e.classList.remove("page__site-header--expand"),t.classList.remove("site-header__menu-button--animated"),t.classList.remove("site-header__menu-button--close"),t.ariaExpanded="false"}));const l=i.querySelector(".site-navigation__top-link--opener");let a=null,d=null,c=null;function u(e){const t=o.querySelector(`#${e.dataset.panelId}`);t&&(a&&m(),c&&p(),s.textContent=e.textContent,e.classList.add("site-navigation__top-link--active"),t.classList.add("site-navigation__panel--active"),i.classList.add("site-navigation--inside"),a=t,d=e)}function m(){a.classList.remove("site-navigation__panel--active"),d.classList.remove("site-navigation__top-link--active"),i.classList.remove("site-navigation--inside"),a=null,d=null}function p(){c.classList.remove("site-navigation__item--opened");const e=c.parentElement.children;s.textContent=d?.textContent;for(const t of e)t!==c&&t.classList.remove("site-navigation__item--hidden");c=null}!a&&r.matches&&u(l),r.addEventListener("change",(()=>{!a&&r.matches&&u(l)})),i.addEventListener("click",(e=>{if(!r.matches){const t=e.target.closest(".site-navigation__top-link--opener"),i=e.target.closest(".site-navigation__middle-link--opener");t&&(e.preventDefault(),u(t)),i&&(e.preventDefault(),c&&p(),function(e){c&&p();s.textContent=e.textContent,c=e.parentElement;const t=c.parentElement.children;c.classList.add("site-navigation__item--opened");for(const e of t)e!==c&&e.classList.add("site-navigation__item--hidden")}(i))}})),i.addEventListener("mouseover",(e=>{if(r.matches){const t=e.target.closest(".site-navigation__top-link--opener");t&&u(t)}})),n.addEventListener("click",(e=>{e.preventDefault(),c?p():a&&m()}));let h=0;const _=document.querySelector(".page__inner");_.addEventListener("scroll",throttle((()=>{const t=e.offsetHeight;_.scrollTop>0&&e.classList.add("site-header--sticked"),_.scrollTop>h&&_.scrollTop>t?e.classList.add("page__site-header--hidden"):(e.classList.remove("page__site-header--hidden"),0===_.scrollTop&&e.classList.remove("site-header--sticked")),h=_.scrollTop}),100))}function initStaticGalleryModal(e,t,i,r){const o=e.querySelector(".modal__gallery");let n=null;o&&(n=i(o)),document.querySelectorAll(r).forEach((i=>{i.addEventListener("click",(i=>{i.preventDefault();const r=i.target.closest("li");if(r&&n){const e=r.parentElement,t=Array.from(e.children).indexOf(r);n.slideTo(t,0)}t(e)}))}))}function initSubscriptionForm(e,t,i,r){const o="button--pending",n=e.querySelector(".subscription__form-item .text-field__control"),s=e.querySelector(".subscription__form-submit-button"),l=e.getAttribute("action");n.dataset.pristineRequiredMessage="Заполните это поле.",n.dataset.pristineEmailMessage="Введите корректный e-mail адрес.";const a=new Pristine(e,{classTo:"subscription__form-item",errorClass:"invalid",errorTextParent:"subscription__form-item",errorTextTag:"p",errorTextClass:"prompt-text"});e.addEventListener("click",(e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",e.focus()}})),e.addEventListener("submit",(n=>{n.preventDefault();a.validate()?(s.disabled=!0,s.classList.add(o),t(l,new FormData(n.target),(()=>{e.reset(),r(i,{heading:"Вы подписались"})}),(()=>{r(i,{status:"error",heading:"Ошибка",text:"Не удалось подписаться, попробуйте снова."})}),(()=>{s.disabled=!1,s.classList.remove(o)}))):(e.classList.remove("subscription__form--error"),setTimeout((()=>e.classList.add("subscription__form--error")),50))}))}function initTaber(e,t){const i=e.querySelector(".taber__list"),r=Array.from(i.querySelectorAll(".taber__tab")),o=e.querySelectorAll(".taber__panel");i.setAttribute("role","tablist"),r.forEach(((e,i)=>{e.role="tab",e.id=`${t}-tab-${i+1}`,e.tabIndex=-1,e.parentNode.role="presentation"})),o.forEach(((e,t)=>{e.role="tabpanel",e.tabIndex=-1,e.setAttribute("aria-labelledby",r[t].id),e.classList.add("taber__panel--hidden")}));const n=(e,t,i)=>{if(e){e.ariaSelected=null,e.tabIndex=-1,e.classList.remove("taber__tab--active");const t=r.indexOf(e);o[t].classList.add("taber__panel--hidden")}i||t.focus(),t.tabIndex=0,t.ariaSelected=!0,t.classList.add("taber__tab--active");const n=r.indexOf(t);o[n].classList.remove("taber__panel--hidden")};(()=>{const e=window.location.hash,t=r.find((t=>t.hash===e));n(null,t||r[0],!0)})(),i.addEventListener("click",(e=>{e.preventDefault();const t=e.target.closest(".taber__tab");if(!t)return;const r=i.querySelector("[aria-selected]");t!==r&&n(r,t)})),i.addEventListener("keydown",(e=>{const t=r.indexOf(e.target);if(isDownArrowEvent(e)||isLeftArrowEvent(e)||isRightArrowEvent(e))if(e.preventDefault(),isDownArrowEvent(e))o[t].focus();else{const i=isLeftArrowEvent(e)?t-1:t+1;if(!r[i])return;n(e.target,r[i])}}))}function initTelField(e){function t(e){return e.value.replace(/\D/g,"")}e.addEventListener("input",(function(e){const i=e.target;let r=t(i),o="";const n=i.selectionStart;if(!r)return void(i.value="");if(i.value.length!==n)return void(e.data&&/\D/g.test(e.data)&&(i.value=r));if(!["7","8","9"].includes(r[0]))return void(i.value=`+${r}`.substring(0,16));"9"===r[0]&&(r=`7${r}`),o=`${"8"===r[0]?"8":"+7"} `,r.length>1&&(o+=`(${r.substring(1,4)}`),r.length>=5&&(o+=`) ${r.substring(4,7)}`),r.length>=8&&(o+=`-${r.substring(7,9)}`),r.length>=10&&(o+=`-${r.substring(9,11)}`),i.value=o})),e.addEventListener("keydown",(function(e){const i=e.target;"Backspace"===e.code&&1===t(i).length&&(i.value="")})),e.addEventListener("paste",(function(e){const i=e.clipboardData||window.clipboardData,r=e.target,o=t(r);if(i){const e=i.getData("Text");/\D/g.test(e)&&(r.value=o)}}))}function initTextFieldWithList(e){const t=e.querySelector(".text-field__control"),i=e.querySelector(".text-field__data-list");function r(){i.classList.remove("text-field__data-list--open"),document.removeEventListener("click",o)}function o({target:e}){e.closest(".text-field")||r()}t.addEventListener("click",(()=>{i.classList.add("text-field__data-list--open"),document.addEventListener("click",o)})),i.addEventListener("click",(({target:e})=>{const i=e.closest(".text-field__data-link");i&&(t.value=i.textContent,t.dispatchEvent(new Event("input",{bubbles:!0})),r())}))}function initUserNavigation(e){const t=document.querySelector(".shortcuts__link--user");function i({target:e}){e.closest(".user-navigation")||e===t||r()}function r(){e.classList.remove("site-header__user-navigation--open"),document.removeEventListener("click",i)}t.addEventListener("click",(o=>{t.dataset.modalOpener||(o.preventDefault(),e.classList.contains("site-header__user-navigation--open")?r():(e.classList.add("site-header__user-navigation--open"),document.addEventListener("click",i)))}))}function initVideoReiewsSlider(e){const t=e.querySelector(".swiper"),i=e.querySelector(".slider-arrows__button--prev"),r=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:20,navigation:{prevEl:i,nextEl:r},watchSlidesProgress:!0,breakpoints:{1346:{spaceBetween:30},1900:{spaceBetween:40}}})}function initVideo(e){const t=e.querySelector(".video__poster"),i=e.querySelector(".video__play-button-wrapper"),r=e.querySelector(".video__play-button"),o=e.querySelector(".video__player");r.addEventListener("click",(()=>{o.play(),i.classList.add("video__play-button-wrapper--hidden"),t.classList.add("video__poster--hidden")})),o.addEventListener("ended",(()=>{i.classList.remove("video__play-button-wrapper--hidden"),t.classList.remove("video__poster--hidden")})),o.addEventListener("play",(()=>{document.querySelectorAll("video").forEach((e=>{e!==o&&e.pause()}))}))}document.querySelectorAll(".cart").forEach((e=>{initCart(e,openModal,showAlert)})),document.querySelectorAll(".reviews__list").forEach((e=>{initReviewsList(e,GalleryModal,initGallery,initVideo,openModal,showAlert)})),document.querySelectorAll(".site-header").forEach(initSiteHeader),document.querySelectorAll(".premium-brands__slider").forEach(initPremiumBrandsSlider),document.querySelectorAll(".selection__slider").forEach(initSelectionSlider),document.querySelectorAll(".taber").forEach(((e,t)=>{initTaber(e,`taber-${t+1}`)})),document.querySelectorAll(".filter__slider").forEach(initFilterSlider),document.querySelectorAll(".banners").forEach(initBanners),document.querySelectorAll(".map").forEach(initMap),document.querySelectorAll(".product-card").forEach(initProductCard),document.querySelectorAll(".products").forEach(initProducts),document.querySelectorAll(".articles--with-slider").forEach(initArticlesSlider),document.querySelectorAll(".navigation-shortcuts").forEach(initNavigationShortcuts),document.querySelectorAll(".catalog-sorting").forEach(initCatalogSorting),document.querySelectorAll(".product-images").forEach(initProductImages),document.querySelectorAll(".product-header__form-buttons").forEach(initProductHeaderStickyFormButtons),document.querySelectorAll(".folds").forEach(initFolds),document.querySelectorAll(".text-field--date").forEach((e=>{initDateField(e,setInputDateMask)})),document.querySelectorAll(".scroll-container").forEach(initScrollContainer),document.querySelectorAll(".file-field").forEach(initFileField),document.querySelectorAll(".feed").forEach(initFeed),document.querySelectorAll(".video-reviews").forEach(initVideoReiewsSlider),document.querySelectorAll(".video").forEach(initVideo),document.querySelectorAll(".projects-slider").forEach(initProjectsSlider),document.querySelectorAll('input[type="tel"]').forEach(initTelField),document.querySelectorAll(".all-brands").forEach(initAllBrands),document.querySelectorAll(".text-field--with-list").forEach(initTextFieldWithList),document.querySelectorAll(".profile-form").forEach((e=>{initProfileForm(e,sendData,openModal,showAlert)})),document.querySelectorAll(".feedback-form").forEach((e=>{initFeedbackForm(e,sendData,openModal,showAlert)})),document.querySelectorAll(".subscription__form").forEach((e=>{initSubscriptionForm(e,sendData,openModal,showAlert)})),document.querySelectorAll('[data-modal="cooperation"]').forEach((e=>{initCooperationModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm)})),document.querySelectorAll('[data-modal="feedback"]').forEach((e=>{initFeedbackModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm)})),document.querySelectorAll('[data-modal="salon"]').forEach((e=>{initSalonModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm)})),document.querySelectorAll('[data-modal="installment-request"]').forEach((e=>{initInstallmentRequestModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm)})),document.querySelectorAll('[data-modal="product-question"]').forEach((e=>{initProductQuestionModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm)})),document.querySelectorAll('[data-modal="one-click"]').forEach((e=>{initOneClickModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm)})),document.querySelectorAll('[data-modal="review"]').forEach((e=>{initReviewModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm)})),document.querySelectorAll('[data-modal="catalog-filters"]').forEach((e=>{initCatalogFiltersModal(e,initScrollContainer,openModal,toggleFoldState)})),document.querySelectorAll(".modal--with_product-gallery").forEach((e=>{initStaticGalleryModal(e,openModal,initGallery,".product__images")})),document.querySelectorAll('[data-modal$="-document"]').forEach((e=>{initDocumentModal(e,openModal)})),document.querySelectorAll(".project").forEach((e=>{initProject(e,createProductCardTemplate,initProductCard,openModal,showAlert)})),document.querySelectorAll('[data-modal="search"]').forEach((e=>{initSearchModal(e,openModal,createProductCardTemplate,initProductCard,createArticlePreviewTemplate)})),document.querySelectorAll('[data-modal="phone-change"]').forEach((e=>{initPhoneChangeModal(e,openModal,closeModal,showAlert)})),document.querySelectorAll('[data-modal="sign-in"]').forEach((e=>{initSignInModal(e,openModal,closeModal,showAlert)})),document.querySelectorAll(".user-navigation").forEach(initUserNavigation),document.querySelectorAll('[data-modal="cities"]').forEach((e=>{initCitiesModal(e,initScrollContainer,openModal)}));