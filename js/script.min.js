"use strict";const DESKTOP_WIDTH_MEDIA_QUERY="(min-width: 1346px)",LAPTOP_WIDTH_MEDIA_QUERY="(min-width: 1260px)",WIDE_TABLET_WIDTH_MEDIA_QUERY="(min-width: 1024px)",CODE_LENGTH=4,KeyCode=Object.freeze({LEFT_ARROW:"ArrowLeft",RIGHT_ARROW:"ArrowRight",DOWN_ARROW:"ArrowDown",UP_ARROW:"ArrowUp",SPACE:"Space",ESCAPE:"Escape"}),pageInnerElement=document.querySelector(".page__inner");function togglePageScroll(){pageInnerElement.classList.toggle("scroll-lock")}function isDownArrowEvent(e){return e.code===KeyCode.DOWN_ARROW}function isEscapeEvent(e){return e.code===KeyCode.ESCAPE}function isLeftArrowEvent(e){return e.code===KeyCode.LEFT_ARROW}function isRightArrowEvent(e){return e.code===KeyCode.RIGHT_ARROW}function isSpaceEvent(e){return e.code===KeyCode.SPACE}function isUpArrowEvent(e){return e.code===KeyCode.UP_ARROW}function createElementByString(e){const t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function getPaginationButtonCreator(e="Слайд"){return(t,o)=>`\n    <button class='${o}' type='button'>\n      <span class='visually-hidden'>${e} ${t+1}.</span>\n    </button>\n  `}function debounce(e,t=500){let o;return(...n)=>{clearTimeout(o),o=setTimeout((()=>e.apply(this,n)),t)}}function throttle(e,t){let o,n=0;return(...r)=>{const i=new Date;clearTimeout(o),o=setTimeout((()=>e.apply(this,r)),t),i-n>=t&&(e.apply(this,r),n=i)}}function getDigitsFromString(e){return e.replace(/\D/g,"")}function showAlert(e,t){const o=createElementByString(`\n    <div class="modal modal--with_alert">\n      <div class="modal__inner">\n        <button class="modal__close-button" type="button">\n          <span class="visually-hidden">Закрыть</span>\n        </button>\n        <section class="alert modal__alert ${"error"===t.status?"alert--error":""}">\n          <h2 class="alert__heading">${t.heading}</h2>\n          ${t.text?`<p class="alert__text">${t.text}</p>`:""}\n          <button class="button alert__button button--secondary" type="button">${t.buttonText||"Закрыть"}</button>\n        </section>\n      </div>\n    </div>\n  `);document.body.append(o),e(o)}function initAllBrands(e){const t=e.querySelector(".all-brands__form"),o=t.querySelector(".text-field__control"),n=t.querySelector(".text-field__clear-button"),r={};function i(e){for(const t in r){const o=r[t];let n=!1;o.links.forEach((t=>{t.textContent.toLowerCase().includes(e.toLowerCase())?(t.parentElement.classList.remove("all-brands__item--hidden"),n=!0):t.parentElement.classList.add("all-brands__item--hidden")})),n?o.group.classList.remove("all-brands__group--hidden"):o.group.classList.add("all-brands__group--hidden")}}e.querySelectorAll(".all-brands__group").forEach((e=>{const t=e.querySelector(".all-brands__group-name").textContent;r[t]={group:e,links:e.querySelectorAll(".all-brands__link")}})),t.addEventListener("submit",(function(e){e.preventDefault()})),o.addEventListener("input",(function({target:e}){i(e.value.trim().toLowerCase())})),n.addEventListener("click",(function(e){e.preventDefault(),o.value="",i("")}))}async function sendData(e,t,o=(()=>{}),n=(()=>{}),r=(()=>{})){try{const n=await fetch(e,{method:"POST",body:t});if(!n.ok)throw new Error(`${n.status} – ${n.statusText}`);try{o(await n.json())}catch(e){o()}}catch(e){n()}finally{r()}}function createArticlePreviewTemplate(e,t){const o=new Intl.DateTimeFormat("ru",{year:"numeric",month:"long",day:"numeric"}).format(Date.parse(e.date)).replace(/ г.$/,"");return`\n    <li class="article-preview ${t||""}">\n      <h3 class="article-preview__heading">\n        <a class="article-preview__link" href="${e.href}">${e.title}</a>\n      </h3>\n      <p class="article-preview__label">${e.type}</p>\n      <picture class="article-preview__image-wrapper">\n        <img class="article-preview__image" src="${e.image}" alt="" loading="lazy"/>\n      </picture>\n      <time class="article-preview__date" datetime="${e.date}">${o}</time>\n    </li>\n  `}function initArticlesSlider(e){const t=e.querySelector(".articles__slider"),o=e.querySelector(".articles__slider-arrows .slider-arrows__button--prev"),n=e.querySelector(".articles__slider-arrows .slider-arrows__button--next"),r=new Swiper(t,{slidesPerView:"auto",spaceBetween:15,navigation:{prevEl:o,nextEl:n},breakpoints:{768:{slidesPerView:4,spaceBetween:20},1346:{slidesPerView:4,spaceBetween:30},1900:{slidesPerView:4,spaceBetween:40}}}),i=e.querySelector(".articles__filter"),s=e.querySelectorAll(".articles__slider-item");i.addEventListener("change",(e=>{const t=e.target.value;s.forEach((e=>{e.classList.toggle("articles__slider-item--hidden",!(e.dataset.tag===t||"all"===t))})),r.update()}))}function initBanners(e){const t=e.querySelector(".banners__slider"),o=e.querySelector(".banners__thumbnails-slider"),n=o.querySelectorAll(".banners__thumbnail"),r=new Swiper(o,{spaceBetween:5,slidesPerView:"auto",watchSlidesProgress:!0});new Swiper(t,{effect:"fade",fadeEffect:{crossFade:!0},loop:!0,autoplay:{delay:6e3,disableOnInteraction:!1},thumbs:{swiper:r,slideThumbActiveClass:"banners__thumbnails-item--active"}}).on("autoplayTimeLeft",((e,t,o)=>{n.forEach((e=>{e.style.setProperty("--thumbnail-progress",1-o)}))}))}function initButtonPrintPdf(e){const t=e.dataset.url;e.addEventListener("click",(()=>{e.disabled=!0,e.classList.add("document-actions__button--pending");const o=document.createElement("iframe");o.style.display="none",o.addEventListener("load",(()=>{o.contentWindow.print(),e.classList.remove("document-actions__button--pending"),e.disabled=!1})),o.src=t,document.body.appendChild(o)}))}function showCartResult({heading:e,text:t,buttonText:o,buttonHref:n}){const r=document.querySelector(".cart__inner");r.querySelector(".cart__heading").remove(),r.querySelector(".cart__form").remove(),r.insertAdjacentHTML("beforeend",`\n    <div class="cart-result">\n      <div class="cart-result__inner container">\n        <h1 class="cart-result__heading heading">${e}</h1>\n        <p class="cart-result__text">${t}</p>\n        ${n?`<a class="button cart-result__button button--primary" href="${n}">${o}</a>`:""}\n      </div>\n    </div>\n  `)}function resetCartForm(){document.querySelector(".cart-form").reset()}class Cart{#e=null;#t=null;#o=null;#n=null;#r=null;#i=null;#s=null;#l=null;#a=null;#c=null;formElement=null;#d=null;#u=null;#m=null;#p=null;#h=null;#_=null;#f=null;#g=null;#S=null;#E=null;#b=null;#v=null;constructor({cartElement:e,openModal:t,showAlert:o,onCartFormSuccessSubmit:n,onCartFormErrorSubmit:r}){this.#o=e,this.#n=t,this.#r=o,this.#i=n,this.#s=r,this.formElement=this.#o.querySelector(".cart-form"),this.#l=this.#o.querySelector(".page-heading .heading")}#y=async(e,t,o,n,r)=>{try{const n=await fetch(e,{method:"POST",body:t});if(!n.ok)throw new Error(`${n.status} – ${n.statusText}`);o(23)}catch(e){n(e)}finally{r()}};#w=()=>{this.formElement.classList.add("cart-form--checkout"),this.#d.classList.add("cart-form__info--checkout"),this.#l.textContent="Оформление заказа",this.#b.forEach((e=>{e.querySelector('input[type="checkbox"]').checked?e.classList.add("cart-item--checkout"):e.parentElement.classList.add("cart-form__products-item--hidden")})),setTimeout((()=>{this.#a.scrollTo({top:this.#E.offsetTop-this.#t.offsetHeight,behavior:"smooth"})}),100)};#q=()=>{this.#c.querySelector(".cart__heading").remove(),this.formElement.remove()};showResult=({heading:e,text:t,buttonText:o,buttonHref:n})=>{this.#q(),this.#c.insertAdjacentHTML("beforeend",`\n      <div class="cart-result">\n        <div class="cart-result__inner container">\n          <h1 class="cart-result__heading heading">${e}</h1>\n          <p class="cart-result__text">${t}</p>\n          <a class="button cart-result__button button--primary" href="${n}">${o}</a>\n        </div>\n      </div>\n    `)};#C(){const e=this.formElement.querySelector(".cart-form__item--name .text-field__control"),t=this.formElement.querySelector(".cart-form__item--phone .text-field__control"),o=this.formElement.querySelector(".cart-form__item--email .text-field__control"),n=this.formElement.querySelector(".cart-form__item--city .text-field__control"),r=this.formElement.querySelector(".cart-form__item--street .text-field__control"),i=this.formElement.querySelector(".cart-form__item--house .text-field__control");e&&(e.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),e.dataset.pristineRequiredMessage="Заполните это поле.",e.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),t&&(t.dataset.pristineRequiredMessage="Заполните это поле."),o&&(o.dataset.pristineRequiredMessage="Заполните это поле.",o.dataset.pristineEmailMessage="Введите корректный e-mail адрес."),n&&(n.dataset.pristineRequiredMessage="Заполните это поле."),r&&(r.dataset.pristineRequiredMessage="Заполните это поле."),i&&(i.dataset.pristineRequiredMessage="Заполните это поле.")}#x=()=>{this.#v=new Pristine(this.formElement,{classTo:"cart-form__item",errorClass:"invalid",errorTextParent:"cart-form__item",errorTextTag:"p",errorTextClass:"prompt-text"})};#F=()=>{this.#a.scrollHeight-this.#a.scrollTop===this.#a.clientHeight?this.#d.classList.remove("cart-form__info--sticked"):this.#d.classList.add("cart-form__info--sticked")};#L=throttle(this.#F,100);#M=throttle(this.#F,100);#T=e=>{const t=e.target.closest(".cart-form__checkout-link"),o=e.target.closest(".cart-form__promocode-button"),n=e.target.closest(".cart-form__choose-all-button"),r=e.target.closest(".text-field__clear-button"),i=e.target.closest(".counter__button");if(t)return e.preventDefault(),this.#w(),void this.#F();if(o)this.#u.classList.toggle("cart-form__promocode--hidden");else{if(n){const e=this.formElement.querySelectorAll(".cart-item__checkbox .checker__control");let t=n.classList.contains("cart-form__choose-all-button--active");return e.forEach((e=>{e.checked=!t,e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0}))})),void this.#f.classList.toggle("cart-form__choose-all-button--active",!t)}if(r){const e=r.closest(".text-field").querySelector(".text-field__control");return e.value="",void e.focus()}if(i){const e=i.closest(".counter").querySelector(".counter__control"),t=e.value;i.classList.contains("counter__button--plus")?e.stepUp():e.stepDown(),t!==e.value&&(e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})))}}};#k=()=>{const e=this.formElement.querySelectorAll(".cart-item__checkbox .checker__control"),t=Array.from(e).filter((e=>e.checked)),o=e.length===t.length;this.#f.classList.toggle("cart-form__choose-all-button--active",o),this.#S.disabled=!t.length};#R=e=>{e.target.closest(".cart-item__checkbox")&&this.#k()};#A=({target:e})=>{e.closest(".cart-form__receiving-radiobutton--pickup")?(this.#_.classList.remove("cart-form__section-inner-group--hidden"),this.#h.remove(),this.#x()):(this.#_.classList.add("cart-form__section-inner-group--hidden"),this.#m.appendChild(this.#h),this.#x())};#P=()=>{resetCartForm(),showCartResult({heading:"Heading",text:"text",buttonText:"button",buttonHref:"#"})};#D=()=>{this.#r(this.#n,{status:"error",heading:"Ошибка",text:"Текст ошибки."})};#$=e=>{e.preventDefault();const t="button--pending",o=this.#v.validate(),n=this.formElement.getAttribute("action");if(o)this.#g.disabled=!0,this.#g.classList.add(t),this.#y(n,new FormData(e.target),(e=>{(this.#i??this.#P)(e),this.#e.scrollTo({top:0,behavior:"instant"})}),(e=>{(this.#s??this.#D)(e)}),(()=>{this.#g.disabled=!1,this.#g.classList.remove(t)}));else{const e=this.formElement.querySelector(".invalid");e.querySelector("input").focus(),this.#a.scrollTo({top:e.offsetTop-this.#t.offsetHeight,behavior:"smooth"})}};initForm(){this.#e=document.querySelector(".page__inner"),this.#t=document.querySelector(".site-header"),this.#a=document.querySelector(".page__inner"),this.#c=this.#o.querySelector(".cart__inner"),this.#d=this.formElement.querySelector(".cart-form__info"),this.#f=this.formElement.querySelector(".cart-form__choose-all-button"),this.#m=this.formElement.querySelector(".cart-form__section--receiving .cart-form__section-inner"),this.#p=this.#m.querySelector(".cart-form__radiobuttons-list--receiving"),this.#h=this.#m.querySelector(".cart-form__section-inner-group--delivery"),this.#_=this.#m.querySelector(".cart-form__section-inner-group--pickup"),this.#u=this.#d.querySelector(".cart-form__promocode"),this.#g=this.formElement.querySelector(".cart-form__submit-button"),this.#S=this.formElement.querySelector(".cart-form__checkout-link"),this.#E=this.formElement.querySelector(".cart-form__section--checkout"),this.#b=this.formElement.querySelectorAll(".cart-item"),this.#C(),this.#x(),this.formElement.addEventListener("click",this.#T),this.formElement.addEventListener("change",this.#R),this.#p.addEventListener("change",this.#A),this.formElement.addEventListener("submit",this.#$),this.#a.addEventListener("scroll",this.#L),window.addEventListener("resize",this.#M),this.#k(),this.#F()}}function initCart(e,t,o,n,r){const i=new Cart({cartElement:e,openModal:t,showAlert:o,onCartFormSuccessSubmit:n,onCartFormErrorSubmit:r});return i.formElement&&i.initForm(),i}class CatalogFiltersModal{#B=new Event("change",{bubbles:!0});#I=null;#H=null;#n=null;#O=null;#V=null;#W=null;#G=null;#j=null;constructor({modalElement:e,initScrollContainer:t,openModal:o,toggleFoldState:n}){this.#I=e,this.#H=t,this.#n=o,this.#O=n}#z=e=>{e.preventDefault(),this.#n(this.#I);const t=e.target.dataset.foldName;if(t){const e=this.#V.querySelector(`[data-fold-name="${t}"]`);"true"!==e.ariaExpanded&&this.#O(e);const o=this.#W.scrollHeight-this.#W.offsetHeight;if(o>0){const t=Math.min(o,e.offsetTop);this.#G.setTranslate(-t)}}setTimeout((()=>this.#G.update()),300)};#N=e=>{const t=e.target.closest(".catalog-filter__box-toggle-button"),o=e.target.closest(".catalog-filters__folds-button");if(t){t.closest(".catalog-filter__box").classList.toggle("catalog-filter__box--expand"),setTimeout((()=>this.#G.update()),300)}else o&&setTimeout((()=>this.#G.update()),300)};#U=e=>{const t=e.target.closest(".catalog-filters__folds-item");if(t)if(t.classList.contains("catalog-filters__folds-item--range")){const e=t.querySelector('.number-range__field-control[data-range-limit="min"]'),o=t.querySelector('.number-range__field-control[data-range-limit="max"]'),n=e.value,r=o.value,i=t.querySelector(".catalog-filters__folds-value-label"),s=t.dataset.rangeName;i.textContent=n&&r?`${s} от ${n} до ${r}`:n?`${s} от ${n}`:r?`${s} до ${r}`:""}else if(t.classList.contains("catalog-filters__folds-item--checkers")){const e=t.querySelector(".catalog-filters__folds-value-label"),o=Array.from(t.querySelectorAll(".checker, .color"));e.textContent=o.filter((e=>e.querySelector("input").checked)).map((e=>e.querySelector(".checker__label, .color__name").textContent)).join(", ")}};#K=()=>{this.#V.action=this.#V.dataset.url,setTimeout((()=>{this.#j.forEach((e=>{e.dispatchEvent(this.#B)}))}),0)};init=()=>{this.#V=this.#I.querySelector(".catalog-filters"),this.#W=this.#V.querySelector(".catalog-filters__scroll-container"),this.#G=this.#H(this.#W),this.#j=Array.from(this.#V.querySelectorAll("input"));document.querySelectorAll(".catalog__filter-opener-button").forEach((e=>{e.addEventListener("click",this.#z)})),this.#V.addEventListener("click",this.#N),this.#V.addEventListener("change",this.#U),this.#V.addEventListener("reset",this.#K)}}function initCatalogFiltersModal(e,t,o,n){const r=new CatalogFiltersModal({modalElement:e,initScrollContainer:t,openModal:o,toggleFoldState:n});return r.init(),r}function initCatalogSorting(e){const t=e.querySelector(".catalog-sorting__toggle-button"),o=e.querySelector(".catalog-sorting__close-button");t.addEventListener("click",(t=>{t.preventDefault(),e.classList.toggle("catalog-sorting--open")})),o.addEventListener("click",(t=>{t.preventDefault(),e.classList.remove("catalog-sorting--open")}))}class CitiesModal{#I=null;#H=null;#n=null;#Q=null;#Y=null;#J=null;#X=null;#Z=null;#ee=null;constructor({modalElement:e,initScrollContainer:t,openModal:o}){this.#I=e,this.#H=t,this.#n=o}open=e=>{e.preventDefault();const t=e.target.closest(".popup");t&&t.remove(),this.#n(this.#I),this.#I.querySelector("input").focus()};#T=e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",this.#J.classList.remove("cities__scroll-container--hidden"),e.focus()}};init(){this.#Q=this.#I.querySelector(".cities__form"),this.#Y=this.#I.querySelector(".cities__list--found"),this.#J=this.#I.querySelector(".cities__scroll-container--popular"),this.#X=this.#I.querySelector(".cities__scroll-container--found"),this.#Z=this.#H(this.#J),this.#ee=this.#H(this.#X),this.#Q.addEventListener("click",this.#T);new MutationObserver((()=>{this.#Z.update(),this.#ee.update()})).observe(this.#Y,{subtree:!0,characterData:!0,attributes:!0,childList:!0}),document.querySelectorAll('[data-modal-opener="cities"]').forEach((e=>{e.addEventListener("click",this.open)}))}}function initCitiesModal(e,t,o){const n=new CitiesModal({modalElement:e,initScrollContainer:t,openModal:o});return n.init(),n}function initCooperationModal(e,t,o,n,r,i,s){i(e,t,o,n,r,{success:{heading:"Спасибо! Ваша заявка успешно отправлена",text:"Наш менеджер свяжется с вами в течении 3 рабочих дней для обсуждения деталей"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}},s)}function initDateField(e,t){const o=e.querySelector(".text-field__control"),n=e.querySelector(".text-field__calendar-button");let r=null;const i=new AirDatepicker(e,{classes:"calendar text-field__calendar",dateFormat:"dd.MM.yyyy",minDate:e.closest('[data-modal="salon"]')?Date.now():"",navTitles:{classes:"text-field__calendar",days:'MMMM <span class="calendar__title-accent">yyyy</span>',weekends:[0,6]},onSelect({formattedDate:e}){o.value=e||"",o.dispatchEvent(new Event("input",{bubbles:!0})),l()}});function s(e){e&&i.selectDate(e,{updateTime:!1,silent:!0})}function l(){r.classList.remove("text-field__calendar--open"),document.removeEventListener("click",d),n.classList.remove("text-field__calendar-button--active")}function a(){r.classList.contains("text-field__calendar--open")?l():(s(c(o.value)),i.setViewDate(c(o.value)||Date.now()),i.setCurrentView("days"),r.classList.add("text-field__calendar--open"),document.addEventListener("click",d),n.classList.add("text-field__calendar-button--active"))}function c(e){return e.split(".").reverse().join("-")}function d({target:e}){e.closest(".text-field--date")||e.closest(".calendar__title-accent")||l()}r=e.querySelector(".text-field__calendar"),o.addEventListener("input",(()=>{if(!o.value)return;const e=c(o.value);s(e),r.classList.contains("text-field__calendar--open")&&(i.setViewDate(e),i.setCurrentView("days"))})),n.addEventListener("click",(()=>{a()})),o.addEventListener("keydown",(e=>{isSpaceEvent(e)&&(e.preventDefault(),a())})),t(o)}function initDocumentModal(e,t){const o=e.dataset.modal;document.querySelectorAll(`[data-modal-opener="${o}"]`).forEach((o=>{o.addEventListener("click",(o=>{o.preventDefault(),t(e)}))}))}function initFeed(e){const t=e.querySelector(".swiper"),o=e.querySelector(".slider-arrows__button--prev"),n=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:10,navigation:{prevEl:o,nextEl:n},breakpoints:{1900:{spaceBetween:16}}})}function initFeedbackForm(e,t,o,n,r){const i="button--pending",s=e.querySelector(".feedback-form__item--name .text-field__control"),l=e.querySelector(".feedback-form__item--email .text-field__control"),a=e.querySelector(".feedback-form__item--phone .text-field__control"),c=e.querySelector(".feedback-form__item--comment .textarea__control"),d=e.querySelector(".feedback-form__submit-button"),u=e.getAttribute("action");s&&(s.pattern=/^[a-zа-яЁё -]+$/i,s.dataset.pristineRequiredMessage="Заполните это поле.",s.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),a&&(a.dataset.pristineRequiredMessage="Заполните это поле."),l&&(l.dataset.pristineRequiredMessage="Заполните это поле.",l.dataset.pristineEmailMessage="Введите корректный e-mail адрес."),c&&(c.dataset.pristineRequiredMessage="Заполните это поле.");const m=new Pristine(e,{classTo:"feedback-form__item",errorClass:"invalid",errorTextParent:"feedback-form__item",errorTextTag:"p",errorTextClass:"prompt-text"});const p=r??function(){n(o,{heading:"Спасибо за обратную связь!"})};e.addEventListener("click",(e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",e.focus()}})),e.addEventListener("submit",(r=>{r.preventDefault();m.validate()?(d.disabled=!0,d.classList.add(i),t(u,new FormData(r.target),(t=>{e.reset(),p(t)}),(()=>{n(o,{status:"error",heading:"Ошибка",text:"Не удалось отправить сообщение, попробуйте снова."})}),(()=>{d.disabled=!1,d.classList.remove(i)}))):(e.classList.remove("feedback-form--error"),setTimeout((()=>e.classList.add("feedback-form--error")),50))}))}function initFeedbackModal(e,t,o,n,r,i,s){i(e,t,o,n,r,{success:{heading:"Заявка успешно отправлена",text:"Наш менеджер свяжется с вами"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}},s)}function initFileField(e){const t=e.querySelector(".file-field__control");e.addEventListener("change",(({target:t})=>{e.classList.toggle("file-field--empty",!t.value)})),e.addEventListener("click",(({target:o})=>{o.closest(".file-field__reset-button")&&(e.classList.add("file-field--empty"),t.value="")}))}function initFilterSlider(e){new Swiper(e,{slidesPerView:"auto",spaceBetween:10,breakpoints:{1346:{spaceBetween:20}}})}function toggleFoldState(e){const t=e.closest(".folds__item"),o=t.querySelector(".folds__content-wrapper"),n=o.querySelector(".folds__content").getBoundingClientRect().height;o.style.height=`${n}px`,setTimeout((()=>{t.classList.toggle("folds__item--open")}),20),e.ariaExpanded="true"===e.ariaExpanded?"false":"true"}function initFolds(e){e.addEventListener("click",(({target:e})=>{const t=e.closest(".folds__button");t&&toggleFoldState(t)})),e.addEventListener("transitionend",(({target:e})=>{const t=e.closest(".folds__item");t&&t.classList.contains("folds__item--open")&&e.classList.contains("folds__content-wrapper")&&setTimeout((()=>{e.style.height="auto"}),0)}))}function createGalleryModalTemplate(e){return`\n    <div class="modal modal--with_gallery modal--with_review-gallery">\n      <div class="modal__inner">\n        <button class="modal__close-button" type="button"><span class="visually-hidden">Закрыть</span></button>\n        <div class="gallery modal__gallery">\n          <div class="gallery__inner">\n            <div class="gallery__slider">\n              <ul class="slider-arrows gallery__slider-arrows slider-arrows--with-background">\n                <li class="slider-arrows__item">\n                  <button class="slider-arrows__button slider-arrows__button--prev" type="button"><span class="visually-hidden">Предыдущий</span></button>\n                </li>\n                <li class="slider-arrows__item">\n                  <button class="slider-arrows__button slider-arrows__button--next" type="button"><span class="visually-hidden">Следующий</span></button>\n                </li>\n              </ul>\n              <div class="gallery__slider-wrapper swiper">\n                <ul class="gallery__slider-list swiper-wrapper">\n                  ${e.map((e=>`\n                    <li class="gallery__slider-item swiper-slide">\n                      ${"video"===e.type?`\n                        <div class="video gallery__video">\n                          <video class="video__player" src="${e.src}" playsinline controls></video>\n                          <img class="video__poster" src="${e.posterSrc}" alt="">\n                          <div class="video__play-button-wrapper">\n                            <button class="video__play-button"><span class="visually-hidden">Воспроизвести</span></button>\n                          </div>\n                        </div>\n                      `:`\n                        <picture class="gallery__image-wrapper">\n                          <img class="gallery__image" src="${e.src}" alt="">\n                        </picture>\n                      `}\n                    </li>\n                  `)).join("")}\n                </ul>\n              </div>\n            </div>\n            <div class="gallery__thumbnails-slider">\n              <ul class="slider-arrows gallery__thumbnails-slider-arrows">\n                <li class="slider-arrows__item">\n                  <button class="slider-arrows__button slider-arrows__button--prev" type="button"><span class="visually-hidden">Предыдущий</span></button>\n                </li>\n                <li class="slider-arrows__item">\n                  <button class="slider-arrows__button slider-arrows__button--next" type="button"><span class="visually-hidden">Следующий</span></button>\n                </li>\n              </ul>\n              <div class="gallery__thumbnails-slider-wrapper swiper">\n                <ul class="gallery__thumbnails-slider-list swiper-wrapper">\n                  ${e.map((e=>`\n                    <li class="gallery__thumbnails-slider-item swiper-slide">\n                      ${"video"===e.type?`\n                        <div class="gallery__image-wrapper gallery__image-wrapper--video">\n                          <img class="gallery__thumbnails-image" src="${e.posterSrc}" alt=""/>\n                        </div>\n                      `:`\n                        <picture class="gallery__image-wrapper">\n                          <img class="gallery__thumbnails-image" src="${e.src}" alt=""/>\n                        </picture>\n                      `}\n                    </li>\n                  `)).join("")}\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  `}class GalleryModal{#I=null;#n=null;#te=null;constructor({content:e,openModal:t,initGallery:o,initVideo:n}){this.#n=t,this.#I=createElementByString(createGalleryModalTemplate(e)),document.body.append(this.#I),this.#te=o(this.#I.querySelector(".gallery")),this.#I.querySelectorAll(".video").forEach(n)}open=(e=0)=>{this.#te.slideTo(e,0),this.#n(this.#I)}}function initGallery(e){const t=e.querySelector(".gallery__slider-wrapper"),o=e.querySelector(".gallery__slider .slider-arrows__button--prev"),n=e.querySelector(".gallery__slider .slider-arrows__button--next"),r=e.querySelector(".gallery__thumbnails-slider-wrapper"),i=e.querySelector(".gallery__thumbnails-slider .slider-arrows__button--prev"),s=e.querySelector(".gallery__thumbnails-slider .slider-arrows__button--next"),l=t.querySelectorAll("video"),a=new Swiper(r,{spaceBetween:10,watchSlidesProgress:!0,slidesPerView:"auto",breakpoints:{768:{slidesPerView:3},1346:{spaceBetween:20}}});return new Swiper(t,{effect:"fade",fadeEffect:{crossFade:!0},navigation:{prevEl:[o,i],nextEl:[n,s]},thumbs:{swiper:a,slideThumbActiveClass:"gallery__thumbnails-slider-item--active"},on:{slideChange:()=>{l.forEach((e=>e.pause()))}}})}function setInputDateMask(e){function t(e){const t=getDigitsFromString(e);let o="";if(t.length){const e=+t[0];if(e<=3){if(o=e,t.length>1){const e=+t.substring(0,2);o=0===e?"01":e<=31?e.toString().padStart(2,"0"):31}if(t.length>2){const e=+t[2];if(e<=1){if(o=`${o}.${e}`,t.length>3){const e=t.substring(0,2),n=+t.substring(2,4);o=0===n?`${e}.01`:`${e}.${n<=12?n.toString().padStart(2,"0"):12}`}if(t.length>4){o+=`.${t.substring(4,8)}`}}else{if(o=`${t.substring(0,2)}.0${e}`,t.length>3){o+=`.${t.substring(3,7)}`}}}}else if(o=`0${e}`,t.length>1){const e=+t[1];if(e<=1){if(o=`${o}.${e}`,t.length>2){const e=t.substring(0,1).padStart(2,"0"),n=+t.substring(1,3);o=0===n?`${e}.01`:`${e}.${n<=12?n.toString().padStart(2,"0"):12}`}if(t.length>3){o+=`.${t.substring(3,7)}`}}else if(o=`${o}.0${e}`,t.length>2){o+=`.${t.substring(2,6)}`}}}return o}e.addEventListener("input",(o=>{(e.value.length===e.selectionStart||o.data&&/\D/g.test(o.data))&&(e.value=t(e.value))})),e.addEventListener("change",(()=>{e.value=t(e.value)}))}function initInstallmentRequestModal(e,t,o,n,r,i,s){i(e,t,o,n,r,{success:{heading:"Заявка успешно отправлена",text:"Наш менеджер свяжется с вами в течении 3 рабочих дней"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}},s)}async function initMap(e){const t=[44.008906,56.323592],o=e.querySelector(".map__inner");o.classList.remove("map__inner--hidden"),o.style.filter="grayscale(1)",await ymaps3.ready;const{YMap:n,YMapDefaultSchemeLayer:r,YMapMarker:i,YMapDefaultFeaturesLayer:s}=ymaps3,l=new n(o,{location:{center:t,zoom:15}});l.addChild(new r),l.addChild(new s);const a=new i({coordinates:t},document.querySelector("#map-marker-template").content.querySelector(".map-marker").cloneNode(!0)),c=setInterval((()=>{const t=e.querySelector("canvas");t&&(clearInterval(c),t.style.filter="grayscale(1)",o.style.filter="",l.addChild(a))}),1e3)}const MODAL_DISAPPEARANCE_TIME=100,openedModals=[];function openModal(e){e.classList.remove("modal--hidden"),openedModals.push(e),document.addEventListener("keydown",onModalEscapeEvent),document.addEventListener("click",onModalClick),setTimeout((()=>{e.classList.add("modal--open")}),100)}function closeModal(e){e.classList.remove("modal--error"),e.classList.remove("modal--open"),openedModals.pop(),openedModals.length||(document.removeEventListener("keydown",onModalEscapeEvent),document.removeEventListener("click",onModalClick)),setTimeout((()=>{e.classList.add("modal--hidden"),(e.classList.contains("modal--with_alert")||e.classList.contains("modal--with_review-gallery"))&&e.remove()}),MODAL_DISAPPEARANCE_TIME)}function onModalEscapeEvent(e){isEscapeEvent(e)&&(e.preventDefault(),closeModal(openedModals[openedModals.length-1]))}function onModalClick({target:e}){(e.classList.contains("modal__close-button")||e.classList.contains("alert__button"))&&closeModal(openedModals[openedModals.length-1])}function initNavigationShortcuts(e){const t=e.querySelector(".swiper");new Swiper(t,{slidesPerView:"auto",spaceBetween:10})}function initOneClickModal(e,t,o,n,r,i,s){i(e,t,o,n,r,{success:{heading:"Заявка успешно отправлена",text:"Наш менеджер свяжется с вами"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}},s)}class PhoneChangeModal{#oe="button--pending";#ne=60;#re=0;#I=null;#n=null;#ie=null;#se=null;#le=null;#ae=null;#ce=null;#de=null;#ue=null;#me=null;#pe=null;#he=null;#_e=null;#fe=null;#ge=null;#Se=null;#Ee=null;#be=null;#ve=null;#ye=null;#we=null;#qe=null;#Ce=null;#xe=null;constructor({modalElement:e,openModal:t,closeModal:o}){this.#I=e,this.#n=t,this.#ie=o}setRequestCodeTimeInterval=e=>{this.#ne=e};close=()=>{this.#ie(this.#I)};open=()=>{this.#n(this.#I)};setExternalPhone=e=>{this.#se&&(this.#se.value=e),this.#le&&(this.#le.textContent=e)};getPhoneFieldValue=()=>this.#ue.value;resetCodeRequestForm=()=>{this.#ae.reset()};resetCodeSendingForm=()=>{this.#me.reset()};sendData=async(e,t,o,n,r)=>{try{const n=await fetch(e,{method:"POST",body:t});if(!n.ok)throw new Error(`${n.status} – ${n.statusText}`);o(await n.json())}catch(e){n(e)}finally{r()}};#C(){this.#ue.dataset.pristineRequiredMessage="Заполните это поле.",this.#fe.dataset.pristineRequiredMessage="Заполните это поле."}#x=()=>{this.#de=new Pristine(this.#ae,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"}),this.#he=new Pristine(this.#me,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"})};finishWaitingForResend=()=>{this.#ge.prepend(this.#Se),this.#Ee.remove()};startWaitingForResend=()=>{if(this.#re<=0){this.#re=this.#ne,this.#be.textContent=this.#re;const e=setInterval((()=>{this.#re--,this.#be.textContent=this.#re,this.#re<=0&&(clearInterval(e),this.finishWaitingForResend())}),1e3);this.#Se.remove(),this.#ge.prepend(this.#Ee)}};goToCodeRequestForm=()=>{this.#ae.classList.remove("modal-form__form--hidden"),this.#me.classList.add("modal-form__form--hidden")};goToCodeSendingForm=()=>{this.#ae.classList.add("modal-form__form--hidden"),this.#me.classList.remove("modal-form__form--hidden");const e=this.#ue.value.replace(/[()]/g,"").replace(/-/g," ");this.#_e.textContent=e,this.startWaitingForResend()};#Fe=e=>{e.target.value.length>4&&(e.target.value=e.target.value.slice(0,4))};#Le=e=>{const t=e.target.closest(".text-field__clear-button"),o=e.target.closest(".modal-form__back-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");return e.value="",void e.focus()}o&&(e.preventDefault(),this.goToCodeRequestForm())};#Me=e=>{if(e.preventDefault(),this.#re>0)this.goToCodeSendingForm();else{const t=this.#ae.getAttribute("action");this.#de.validate()?(this.#ce.disabled=!0,this.#ce.classList.add(this.#oe),this.sendData(t,new FormData(e.target),this.#ve,this.#ye,(()=>{this.#ce.disabled=!1,this.#ce.classList.remove(this.#oe)}))):(this.#I.classList.remove("modal--error"),setTimeout((()=>this.#I.classList.add("modal--error")),50))}};#Te=e=>{e.preventDefault(),this.#Se.disabled=!0;const t=this.#ae.getAttribute("action");this.sendData(t,new FormData(this.#ae),this.#we,this.#qe,(()=>{this.#Se.disabled=!1}))};#ke=e=>{e.preventDefault();const t=this.#me.getAttribute("action");this.#he.validate()?(this.#pe.disabled=!0,this.#pe.classList.add(this.#oe),this.sendData(t,new FormData(e.target),this.#Ce,this.#xe,(()=>{this.#pe.disabled=!1,this.#pe.classList.remove(this.#oe)}))):(this.#I.classList.remove("modal--error"),setTimeout((()=>this.#I.classList.add("modal--error")),50))};#Re=e=>{e.preventDefault(),this.open()};setCodeRequestSubmitHandlers=(e,t)=>{this.#ve=e,this.#ye=t};setCodeReRequestSubmitHandlers=(e,t)=>{this.#we=e,this.#qe=t};setCodeSendingSubmitHandlers=(e,t)=>{this.#Ce=e,this.#xe=t};init(){this.#se=document.querySelector(".profile-form__item--phone .text-field__control"),this.#le=document.querySelector(".account__phone"),this.#ae=this.#I.querySelector(".modal-form__form--code-request"),this.#ce=this.#ae.querySelector(".modal-form__submit-button"),this.#ue=this.#ae.querySelector(".modal-form__item--tel .text-field__control"),this.#me=this.#I.querySelector(".modal-form__form--code-sending"),this.#pe=this.#me.querySelector(".modal-form__submit-button"),this.#_e=this.#me.querySelector(".modal-form__phone-text"),this.#fe=this.#me.querySelector(".modal-form__item--code .text-field__control"),this.#ge=this.#me.querySelector(".modal-form__footer"),this.#Se=this.#me.querySelector(".modal-form__footer-button--resend-code"),this.#Ee=this.#me.querySelector(".modal-form__footer-text--resend-code"),this.#be=this.#Ee.querySelector(".modal-form__footer-text-timer"),this.#C(),this.#x(),this.#fe.addEventListener("input",this.#Fe),this.#I.addEventListener("click",this.#Le),this.#ae.addEventListener("submit",this.#Me),this.#me.addEventListener("submit",this.#ke),this.#Se.addEventListener("click",this.#Te),document.querySelectorAll('[data-modal-opener="phone-change"]').forEach((e=>{e.addEventListener("click",this.#Re)}))}}function initPhoneChangeModal(e,t,o){const n=new PhoneChangeModal({modalElement:e,openModal:t,closeModal:o});return n.init(),n}function initPremiumBrandsSlider(e){const t=e.querySelector(".swiper"),o=e.querySelector(".slider-arrows__button--prev"),n=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",loop:!0,navigation:{prevEl:o,nextEl:n}})}function createProductCardTemplate(e,t){const o=new Intl.NumberFormat("ru");let n,r=null,i=null;switch(e.discount?(i=o.format(e.price),r=o.format(e.price*(100-e.discount)/100)):r=o.format(e.price),e.status){case"in-stock":n='<p class="product-card__label product-card__label--in-stock">В наличии</p>';break;case"arrival-expected":n='<p class="product-card__label product-card__label--arrival-expected">Ожидает поступления</p>';break;case"to-order":n='<p class="product-card__label product-card__label--to-order">Под заказ</p>'}return`\n    <article class="product-card product-card-popup__card ${t||""}">\n      <div class="product-card__heading-and-signs">\n        <h3 class="product-card__heading">\n          <a class="product-card__link" href="${e.href}">${e.title}</a>\n        </h3>\n        ${e.dimensions?`<p class="product-card__signs">${e.dimensions}</p>`:""}\n      </div>\n      <div class="product-card__prices">\n        <p class="product-card__price ${e.discount?"accent":""}">${r} ₽</p>\n        ${e.discount?`<s class="product-card__old-price">${i} ₽</s><p class="producr-card__discount">-${e.discount}%</p>`:""}\n      </div>\n      <a class="product-card__slider swiper" href="${e.href}">\n        <ul class="product-card__slider-list swiper-wrapper">\n          ${e.images.map(((e,t)=>`\n            <li class="product-card__slider-item swiper-slide">\n              <img class="product-card__image" src="${e}" alt="" loading="lazy"/>\n            </li>\n          `)).join("")}\n        </ul>\n        <p class="product-card__slider-pagination"></p>\n      </a>\n      <div class="product-card__labels-wrapper">\n        <div class="product-card__labels">\n          ${e.isPremium?'<p class="product-card__premium-label"><span class="product-card__premium-label-text">Premium</span></p>':""}\n          ${n||""}\n          <p class="product-card__like-button-wrapper">\n            <button class="like-button product-card__like-button ${e.isFavorite?"like-button--active":""}" type="button" data-id="${e.id}">\n              <span class="visually-hidden">Нравится</span>\n            </button>\n          </p>\n        </div>\n      </div>\n      <a class="product-card__brand" href="${e.brandHref}">\n        Бренд <span class="product-card__brand-name">${e.brand}</span>\n      </a>\n    </article>\n  `}function initProductCard(e){const t=e.querySelector(".product-card__slider"),o=t.querySelector(".product-card__slider-pagination");new Swiper(t,{pagination:{el:o,bulletClass:"product-card__slider-pagination-button",bulletActiveClass:"product-card__slider-pagination-button--current",renderBullet:getPaginationButtonCreator()}})}function initProductHeaderStickyActionButtons(e){const t=document.querySelector(".page__inner"),o=()=>{t.scrollHeight-t.scrollTop===t.clientHeight?e.classList.remove("product-header__action-buttons--sticked"):e.classList.add("product-header__action-buttons--sticked")};t.addEventListener("scroll",throttle(o,100)),window.addEventListener("resize",throttle(o,100)),o()}function setSliderMode(e,t){e.itself.classList.add(e.modeClass,"swiper"),e.list.classList.add("swiper-wrapper"),e.slides.forEach((e=>e.classList.add("swiper-slide"))),e.swiper=new Swiper(e.itself,t)}function setSliderSimpleMode(e){setSliderMode(e,{pagination:{el:e.pagination,bulletClass:"product-images__slider-pagination-button",bulletActiveClass:"product-images__slider-pagination-button--current",renderBullet:getPaginationButtonCreator()},grabCursor:!0})}function resetSliderMode(e){e?.swiper?.destroy(!0,!0),e.itself.classList.remove("swiper"),e.list.classList.remove("swiper-wrapper"),e.slides.forEach((e=>{e.removeAttribute("aria-label"),e.removeAttribute("role"),e.classList.remove("swiper-slide")})),e.list.removeAttribute("aria-live"),e.pagination.innerHTML="",e.swiper=null}function initProductImages(e){const t={itself:e.querySelector(".product-images__slider"),list:e.querySelector(".product-images__slider-list"),slides:e.querySelectorAll(".product-images__slider-item"),pagination:e.querySelector(".product-images__slider-pagination")},o=window.matchMedia("(min-width: 1346px)"),n=()=>{o.matches?resetSliderMode(t):setSliderSimpleMode(t)};o.addEventListener("change",(()=>{n()})),n()}function initProductQuestionModal(e,t,o,n,r,i,s){i(e,t,o,n,r,{success:{heading:"Ваш вопрос успешно отправлен",text:"Наш менеджер свяжется с вами"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить вопрос, попробуйте снова."}},s)}function initProducts(e){const t=e.querySelector(".swiper"),o=e.querySelector(".slider-arrows__button--prev"),n=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:15,navigation:{prevEl:o,nextEl:n},breakpoints:{768:{spaceBetween:20},1346:{spaceBetween:30},1900:{spaceBetween:40}}})}function initProfileForm(e,t,o,n,r){const i="button--pending",s=e.querySelector(".profile-form__item--name .text-field__control"),l=e.querySelector(".profile-form__item--surname .text-field__control"),a=e.querySelector(".profile-form__item--patronymic .text-field__control"),c=e.querySelector(".profile-form__item--email .text-field__control"),d=e.querySelector(".profile-form__item--date .text-field__control"),u=e.querySelector(".profile-form__item--city .text-field__control"),m=e.querySelector(".profile-form__item--street .text-field__control"),p=e.querySelector(".profile-form__item--house .text-field__control"),h=e.querySelector(".profile-form__submit-button"),_=e.getAttribute("action");function f(){const t=[];return e.querySelectorAll("input").forEach((e=>{"checkbox"===e.type?t.push(e.checked):t.push(e.value.trim())})),t}s&&(s.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),s.dataset.pristineRequiredMessage="Заполните это поле.",s.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),l&&(l.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),l.dataset.pristineRequiredMessage="Заполните это поле.",l.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),a&&(a.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),a.dataset.pristineRequiredMessage="Заполните это поле.",a.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),c&&(c.dataset.pristineRequiredMessage="Заполните это поле.",c.dataset.pristineEmailMessage="Введите корректный e-mail адрес."),d&&(d.pattern=/^(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[0-2])\.\d{4}$/,d.dataset.pristineRequiredMessage="Заполните это поле.",d.dataset.pristinePatternMessage="Введите дату в формате дд.мм.гггг"),u&&(u.dataset.pristineRequiredMessage="Заполните это поле."),m&&(m.dataset.pristineRequiredMessage="Заполните это поле."),p&&(p.dataset.pristineRequiredMessage="Заполните это поле.");let g=f();const S=new Pristine(e,{classTo:"profile-form__item",errorClass:"invalid",errorTextParent:"profile-form__item",errorTextTag:"p",errorTextClass:"prompt-text"});e.addEventListener("click",(e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",e.focus(),e.dispatchEvent(new Event("input",{bubbles:!0}))}})),e.addEventListener("change",(()=>{e.classList.remove("profile-form--error")})),e.addEventListener("input",(()=>{h.disabled=!function(){const e=f().join();return g.join()!==e}()}));const E=r??function(){n(o,{heading:"Данные успешно обновлены"})};e.addEventListener("submit",(r=>{r.preventDefault();S.validate()?(h.disabled=!0,h.classList.add(i),t(_,new FormData(r.target),(e=>{g=f(),E(e)}),(()=>{n(o,{status:"error",heading:"Ошибка",text:"Не удалось обновить данные, попробуйте снова."})}),(()=>{h.disabled=!1,h.classList.remove(i)}))):(e.classList.remove("profile-form--error"),setTimeout((()=>e.classList.add("profile-form--error")),50))}))}const productMockData={id:"1",title:"Тумба Mock",isPremium:!0,isFavorite:!1,status:"in-stock",price:100,discount:0,dimensions:{width:"15",length:"20",height:"60"},images:["img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp"],images2x:["img/products/product-3@2x.webp","img/products/product-3@2x.webp","img/products/product-3@2x.webp","img/products/product-3@2x.webp","img/products/product-3@2x.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"};function createProductCardPopupTemplate(e,t,o){return`\n    <div class="product-card-popup pin__popup">\n      <div class="product-card-popup__inner">\n        <button class="product-card-popup__close-button" type="button"><span class="visually-hidden">Закрыть</span></button>\n        ${t(e,o)}\n        <a class="product-card-popup__link" href="${e.href}">Подробнее</a>\n      </div>\n    </div>\n  `}function closeActivePin(e){const t=e.querySelector(".pin__popup"),o=e.querySelector(".plus-button");t.classList.add("pin__popup--closing"),setTimeout((()=>{t.remove()}),100),o.classList.remove("plus-button--active"),e.classList.remove("pin--active")}function closeAllActivePins(e){e.forEach((e=>{e.classList.contains("pin--active")&&closeActivePin(e)}))}function initProject(e,t,o,n,r){const i=e.querySelectorAll(".pin");e.addEventListener("click",(e=>{const s=e.target.closest(".plus-button"),l=e.target.closest(".product-card-popup__close-button");if(s){const e=s.closest(".pin");if(s.classList.contains("plus-button--active"))closeActivePin(e);else{closeAllActivePins(i),s.disabled=!0;(async(e,t,o,n)=>{try{const o=await fetch(e);if(!o.ok)throw new Error(`${o.status} – ${o.statusText}`);t(await o.json())}catch(e){o()}finally{n()}})(`https://fakestoreapi.com/products/${e.dataset.productId}`,(n=>{const r=createElementByString(createProductCardPopupTemplate(n&&productMockData,t,"product-card--popup"));o(r.querySelector(".product-card")),e.append(r),s.classList.add("plus-button--active"),e.classList.add("pin--active");if(!window.matchMedia("(min-width: 1024px)").matches)return;if(r.getBoundingClientRect().x<100){r.querySelector(".product-card-popup__inner").style.transformOrigin="left bottom",r.style.right="auto",r.style.left="20px"}}),(()=>{r(n,{status:"error",heading:"Ошибка",text:"Не удалось загрузить данные товара, попробуйте снова."})}),(()=>{s.disabled=!1}))}}if(l){closeActivePin(l.closest(".pin"))}}))}function initProjectsSlider(e){const t=e.querySelector(".swiper"),o=e.querySelector(".slider-arrows__button--prev"),n=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:20,navigation:{prevEl:o,nextEl:n},breakpoints:{1346:{spaceBetween:30},1900:{spaceBetween:40}}})}function initReviewModal(e,t,o,n,r,i,s){i(e,t,o,n,r,{success:{heading:"Спасибо, что оценили нашу работу",text:"Ваш отзыв будет проверен модератором сайта, и опубликован в течение 2 рабочих дней"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить отзыв, попробуйте снова."}},s)}const mockReviewGalleryData=[{type:"video",src:"files/video.mp4",posterSrc:"img/reviews/review-1.webp"},{type:"image",src:"img/reviews/review-1.webp"},{type:"image",src:"img/reviews/review-2.webp"},{type:"image",src:"img/reviews/review-3.webp"},{type:"image",src:"img/reviews/review-1.webp"},{type:"image",src:"img/reviews/review-2.webp"},{type:"image",src:"img/reviews/review-3.webp"}];class ReviewsList{#Ae=null;#Pe=null;#De=null;#$e=null;#n=null;#Be=null;constructor({listElement:e,galleryModal:t,initGallery:o,initVideo:n,openModal:r}){this.#Ae=e,this.#Pe=t,this.#De=o,this.#$e=n,this.#n=r}updateReviewsTextWrappersList=()=>{this.#Be=this.#Ae.querySelectorAll(".review__text-wrapper")};#Ie=()=>{this.#Be.forEach((e=>{const t=e.classList.contains("review__text-wrapper--clipped");e.classList.add("review__text-wrapper--clipped");const o=e.querySelector(".review__text");o.scrollHeight>o.offsetHeight?e.classList.add("review__text-wrapper--clippable"):e.classList.remove("review__text-wrapper--clippable"),t||e.classList.remove("review__text-wrapper--clipped")}))};#M=throttle(this.#Ie,500);#He=e=>{const t=e.target.closest(".review__toggle-button"),o=e.target.closest(".feed__slider-item");if(t){t.closest(".review__text-wrapper").classList.toggle("review__text-wrapper--clipped")}if(o){e.preventDefault();const t=o.parentElement;t.classList.add("no-click");const n=Array.from(t.children).indexOf(o),r=o.closest(".review");new this.#Pe({content:reviewsGalleryData[r.dataset.id],openModal:this.#n,initGallery:this.#De,initVideo:this.#$e}).open(n),t.classList.remove("no-click")}};init=()=>{this.updateReviewsTextWrappersList(),this.#Ie(),window.addEventListener("resize",this.#M),this.#Ae.addEventListener("click",this.#He)}}function initReviewsList(e,t,o,n,r){const i=new ReviewsList({listElement:e,galleryModal:t,initGallery:o,initVideo:n,openModal:r});return i.init(),i}function initSalonModal(e,t,o,n,r,i,s){i(e,t,o,n,r,{success:{heading:"Заявка успешно отправлена",text:"Наш менеджер свяжется с вами"},error:{status:"error",heading:"Ошибка",text:"Не удалось отправить заявку, попробуйте снова."}},s)}function initScrollContainer(e){const t=e.querySelector(".swiper-scrollbar");return new Swiper(e,{direction:"vertical",slidesPerView:"auto",freeMode:!0,autoHeight:!0,scrollbar:{el:t,draggable:!0},mousewheel:!0})}function initSearchFormWithSubmitButton(e){const t=e.querySelector(".text-field__control"),o=e.querySelector(".search-form__submit-button");t.addEventListener("input",(e=>{o.disabled=0===e.target.value.length})),o.disabled=0===t.value.length}const searchResultMockData={products:[{id:"1",title:"Стул Tosca",isPremium:!0,isFavorite:!1,price:12e3,discount:0,images:["img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"},{id:"2",title:"Стул Tosca",isPremium:!0,isFavorite:!1,status:"in-stock",price:15e3,discount:0,dimensions:"15x20x60",images:["img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"},{id:"3",title:"Тумба Mock",isPremium:!0,isFavorite:!1,status:"arrival-expected",price:2e4,discount:10,dimensions:"15x20x60",images:["img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp","img/products/product-3.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"},{id:"1",title:"Стул Tosca",isPremium:!0,isFavorite:!1,status:"to-order",price:12e3,discount:0,dimensions:"15x20x60",images:["img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp","img/products/product-1.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"},{id:"2",title:"Стул Tosca",isPremium:!0,isFavorite:!1,status:"arrival-expected",price:15e3,discount:0,dimensions:"15x20x60",images:["img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"},{id:"2",title:"Стул Tosca",isPremium:!0,isFavorite:!1,status:"to-order",price:15e3,discount:0,dimensions:"15x20x60",images:["img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp","img/products/product-2.webp"],href:"product.html",brand:"Calligaris",brandHref:"brand.html"}],articles:[{title:"Смена экспозиции в&nbsp;выставочном зале",type:"Блог",image:"img/articles/previews/preview-1.webp",image2x:"img/articles/previews/preview-1@2x.webp 2x",date:"2023-05-10",href:"article.html"}]};class SearchModal{#Oe=4;#I=null;#n=null;#Ve=null;#We=null;#Q=null;#Ge=null;#je=null;#ze=null;#Ne=null;constructor({modalElement:e,openModal:t,createProductCardTemplate:o,initProductCard:n,createArticlePreviewTemplate:r}){this.#I=e,this.#n=t,this.#je=o,this.#ze=n,this.#Ne=r}#y=async(e,t,o,n)=>{try{const n=await fetch(e,{method:"POST",body:t});if(!n.ok)throw new Error(`${n.status} – ${n.statusText}`);o(await n.json())}catch(e){n()}};#Le=e=>{const t=e.target.closest(".text-field__clear-button"),o=e.target.closest(".search-modal__popular-list-link");t&&(this.#We.value="",this.#We.focus(),this.#We.dispatchEvent(new Event("input",{bubbles:!0}))),o&&(this.#We.value=o.textContent,this.#We.focus(),this.#We.dispatchEvent(new Event("input",{bubbles:!0})))};#Ue(e,t,o){return`\n      <section class="search-modal__result-group">\n        <header class="search-modal__result-group-header">\n          <h3 class="search-modal__result-group-heading">По вашему запросу найдены «${e}»</h3>\n          ${t?`\n      <a class="search-modal__result-group__link link link--small" href="${t}">Ещё результаты</a>\n    `:""}\n        </header>\n        ${o}\n      </section>\n    `}#Ke=()=>{if(this.#We.value.trim().length<3)return this.#Ve.classList.remove("search-modal--with-result"),void(this.#Ge.innerHTML="");this.#Ve.classList.add("search-modal--with-result");const e=this.#Q.getAttribute("action");this.#y(e,new FormData(this.#Q),(e=>{this.#Ge.innerHTML="";const t=e;if(t?.products?.length||t?.articles?.length){if(t?.products?.length){const e=`\n            <ul class="products-list products-list--size_xs search-modal__result-group-list">\n              ${t.products.slice(0,this.#Oe).map((e=>this.#je(e,"product-card--size_xs"))).join("")}\n            </ul>\n          `,o=t.products.length>this.#Oe?`/search_articles/?q${this.#We.value.trim()}`:null,n=createElementByString(this.#Ue("Товары",o,e));n.querySelectorAll(".product-card").forEach(this.#ze),this.#Ge.append(n)}if(t?.articles?.length){const e=`\n            <ul class="articles-list articles-list--size_s search-modal__result-group-list">\n              ${t.articles.map((e=>this.#Ne(e,"article-preview--size_s"))).join("")}\n            </ul>\n          `,o=t.articles.length>this.#Oe?`/search/?q=${this.#We.value.trim()}`:null,n=createElementByString(this.#Ue("Статьи",o,e));this.#Ge.append(n)}}else this.#Ge.insertAdjacentHTML("beforeend",'<p class="search-modal__result-placeholder">По вашему запросу ничего не найдено</p>')}),(()=>{this.#Ge.innerHTML="",this.#Ge.insertAdjacentHTML("beforeend",'<p class="search-modal__result-placeholder search-modal__result-placeholder--error">Ошибка. Не удалось произвести поиск.</p>')}))};#Qe=debounce(this.#Ke,500);open=e=>{e.preventDefault(),this.#n(this.#I),this.#I.querySelector("input").focus()};init=()=>{this.#Ve=this.#I.querySelector(".search-modal"),this.#Q=this.#Ve.querySelector(".search-modal__form"),this.#We=this.#Q.querySelector(".text-field__control"),this.#Ge=this.#Ve.querySelector(".search-modal__result"),document.querySelectorAll('[data-modal-opener="search"]').forEach((e=>{e.addEventListener("click",this.open)})),this.#Ve.addEventListener("click",this.#Le),this.#We.addEventListener("input",this.#Qe)}}function initSearchModal(e,t,o,n,r){const i=new SearchModal({modalElement:e,openModal:t,createProductCardTemplate:o,initProductCard:n,createArticlePreviewTemplate:r});return i.init(),i}function initSelectionSlider(e){const t=e.querySelector(".swiper"),o=e.querySelector(".slider-arrows__button--prev"),n=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:20,navigation:{prevEl:o,nextEl:n},breakpoints:{1346:{spaceBetween:30},1900:{spaceBetween:40}}})}class SignInModal{#oe="button--pending";#ne=60;#re=0;#I=null;#n=null;#ie=null;#ae=null;#ce=null;#de=null;#ue=null;#me=null;#pe=null;#he=null;#_e=null;#fe=null;#ge=null;#Se=null;#Ee=null;#be=null;#ve=null;#ye=null;#we=null;#qe=null;#Ce=null;#xe=null;constructor({modalElement:e,openModal:t,closeModal:o}){this.#I=e,this.#n=t,this.#ie=o}setRequestCodeTimeInterval=e=>{this.#ne=e};close=()=>{this.#ie(this.#I)};open=()=>{this.#n(this.#I)};resetCodeRequestForm=()=>{this.#ae.reset()};resetCodeSendingForm=()=>{this.#me.reset()};sendData=async(e,t,o,n,r)=>{try{const n=await fetch(e,{method:"POST",body:t});if(!n.ok)throw new Error(`${n.status} – ${n.statusText}`);o(await n.json())}catch(e){n(e)}finally{r()}};#C(){this.#ue.dataset.pristineRequiredMessage="Заполните это поле.",this.#fe.dataset.pristineRequiredMessage="Заполните это поле."}#x=()=>{this.#de=new Pristine(this.#ae,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"}),this.#he=new Pristine(this.#me,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"})};finishWaitingForResend=()=>{this.#ge.prepend(this.#Se),this.#Ee.remove()};startWaitingForResend=()=>{if(this.#re<=0){this.#re=this.#ne,this.#be.textContent=this.#re;const e=setInterval((()=>{this.#re--,this.#be.textContent=this.#re,this.#re<=0&&(clearInterval(e),this.finishWaitingForResend())}),1e3);this.#Se.remove(),this.#ge.prepend(this.#Ee)}};goToCodeRequestForm=()=>{this.#ae.classList.remove("modal-form__form--hidden"),this.#me.classList.add("modal-form__form--hidden")};goToCodeSendingForm=()=>{this.#ae.classList.add("modal-form__form--hidden"),this.#me.classList.remove("modal-form__form--hidden");const e=this.#ue.value.replace(/[()]/g,"").replace(/-/g," ");this.#_e.textContent=e,this.startWaitingForResend()};#Fe=e=>{e.target.value.length>4&&(e.target.value=e.target.value.slice(0,4))};#Le=e=>{const t=e.target.closest(".text-field__clear-button"),o=e.target.closest(".modal-form__back-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");return e.value="",void e.focus()}o&&(e.preventDefault(),this.goToCodeRequestForm())};#Me=e=>{if(e.preventDefault(),this.#re>0)this.goToCodeSendingForm();else{const t=this.#ae.getAttribute("action");this.#de.validate()?(this.#ce.disabled=!0,this.#ce.classList.add(this.#oe),this.sendData(t,new FormData(e.target),this.#ve,this.#ye,(()=>{this.#ce.disabled=!1,this.#ce.classList.remove(this.#oe)}))):(this.#I.classList.remove("modal--error"),setTimeout((()=>this.#I.classList.add("modal--error")),50))}};#Te=e=>{e.preventDefault(),this.#Se.disabled=!0;const t=this.#ae.getAttribute("action");this.sendData(t,new FormData(this.#ae),this.#we,this.#qe,(()=>{this.#Se.disabled=!1}))};#ke=e=>{e.preventDefault();const t=this.#me.getAttribute("action");this.#he.validate()?(this.#pe.disabled=!0,this.#pe.classList.add(this.#oe),this.sendData(t,new FormData(e.target),this.#Ce,this.#xe,(()=>{this.#pe.disabled=!1,this.#pe.classList.remove(this.#oe)}))):(this.#I.classList.remove("modal--error"),setTimeout((()=>this.#I.classList.add("modal--error")),50))};#Re=e=>{e.preventDefault(),this.open()};setCodeRequestSubmitHandlers=(e,t)=>{this.#ve=e,this.#ye=t};setCodeReRequestSubmitHandlers=(e,t)=>{this.#we=e,this.#qe=t};setCodeSendingSubmitHandlers=(e,t)=>{this.#Ce=e,this.#xe=t};init(){this.#ae=this.#I.querySelector(".modal-form__form--code-request"),this.#ce=this.#ae.querySelector(".modal-form__submit-button"),this.#ue=this.#ae.querySelector(".modal-form__item--tel .text-field__control"),this.#me=this.#I.querySelector(".modal-form__form--code-sending"),this.#pe=this.#me.querySelector(".modal-form__submit-button"),this.#_e=this.#me.querySelector(".modal-form__phone-text"),this.#fe=this.#me.querySelector(".modal-form__item--code .text-field__control"),this.#ge=this.#me.querySelector(".modal-form__footer"),this.#Se=this.#me.querySelector(".modal-form__footer-button--resend-code"),this.#Ee=this.#me.querySelector(".modal-form__footer-text--resend-code"),this.#be=this.#Ee.querySelector(".modal-form__footer-text-timer"),this.#C(),this.#x(),this.#fe.addEventListener("input",this.#Fe),this.#I.addEventListener("click",this.#Le),this.#ae.addEventListener("submit",this.#Me),this.#me.addEventListener("submit",this.#ke),this.#Se.addEventListener("click",this.#Te),document.querySelectorAll('[data-modal-opener="sign-in"]').forEach((e=>{e.addEventListener("click",this.#Re)}))}}function initSignInModal(e,t,o){const n=new SignInModal({modalElement:e,openModal:t,closeModal:o});return n.init(),n}function initSimpleModalForm(e,t,o,n,r,i,s){const l="button--pending",a=e.dataset.modal,c=e.querySelector(".modal__form"),d=c.querySelector(".modal-form__submit-button"),u=e.querySelector(".modal-form__item--name .text-field__control"),m=e.querySelector(".modal-form__item--surname .text-field__control"),p=e.querySelector(".modal-form__item--patronymic .text-field__control"),h=e.querySelector(".modal-form__item--phone .text-field__control"),_=e.querySelector(".modal-form__item--email .text-field__control"),f=e.querySelector(".modal-form__item--date .text-field__control"),g=e.querySelector(".modal-form__item--comment .textarea__control");u&&(u.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),u.dataset.pristineRequiredMessage="Заполните это поле.",u.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),m&&(m.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),m.dataset.pristineRequiredMessage="Заполните это поле.",m.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),p&&(p.setAttribute("data-pristine-pattern","/^[a-zа-яЁё -]+$/i"),p.dataset.pristineRequiredMessage="Заполните это поле.",p.dataset.pristinePatternMessage="Допустимы только буквы, дефисы и пробелы."),h&&(h.dataset.pristineRequiredMessage="Заполните это поле.",h.dataset.pristineEmailMessage="Введите корректный номер телефона."),_&&(_.dataset.pristineRequiredMessage="Заполните это поле.",_.dataset.pristineEmailMessage="Введите корректный e-mail адрес."),f&&(f.pattern=/^(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[0-2])\.\d{4}$/,f.dataset.pristineRequiredMessage="Заполните это поле.",f.dataset.pristinePatternMessage="Введите дату в формате дд.мм.гггг"),g&&(g.dataset.pristineRequiredMessage="Заполните это поле.");const S=c.getAttribute("action"),E=new Pristine(c,{classTo:"modal-form__item",errorClass:"invalid",errorTextParent:"modal-form__item",errorTextTag:"p",errorTextClass:"prompt-text"});const b=s??function(){r(o,i.success)};c.addEventListener("click",(e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",e.focus()}})),c.addEventListener("submit",(s=>{s.preventDefault();E.validate()?(d.disabled=!0,d.classList.add(l),t(S,new FormData(s.target),(t=>{n(e),b(t),c.reset()}),(()=>{n(e),r(o,i.error)}),(()=>{d.disabled=!1,d.classList.remove(l)}))):(e.classList.remove("modal--error"),setTimeout((()=>e.classList.add("modal--error")),50))})),document.querySelectorAll(`[data-modal-opener="${a}"]`).forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault(),E.reset(),e.classList.remove("modal--error"),o(e),e.querySelector("input").focus()}))}))}function initSiteHeader(e){const t=e.querySelector(".site-header__menu-button"),o=e.querySelector(".site-header__navigation"),n=window.matchMedia("(min-width: 1260px)");t.addEventListener("click",(()=>{t.classList.toggle("site-header__menu-button--close"),t.ariaExpanded="true"===t.ariaExpanded?"false":"true",o.classList.toggle("site-header__navigation--open"),e.classList.toggle("page__site-header--expand"),togglePageScroll()}));const r=o.querySelector(".site-navigation__panels"),i=o.querySelector(".site-navigation__back-button"),s=o.querySelector(".site-navigation__title");o.querySelector(".site-navigation__close-button").addEventListener("click",(n=>{n.preventDefault(),o.classList.remove("site-header__navigation--open"),e.classList.remove("page__site-header--expand"),t.classList.remove("site-header__menu-button--animated"),t.classList.remove("site-header__menu-button--close"),t.ariaExpanded="false"}));const l=o.querySelector(".site-navigation__top-link--opener");let a=null,c=null,d=null;function u(e){const t=r.querySelector(`#${e.dataset.panelId}`);t&&(a&&m(),d&&p(),s.textContent=e.textContent,e.classList.add("site-navigation__top-link--active"),t.classList.add("site-navigation__panel--active"),o.classList.add("site-navigation--inside"),a=t,c=e)}function m(){a.classList.remove("site-navigation__panel--active"),c.classList.remove("site-navigation__top-link--active"),o.classList.remove("site-navigation--inside"),a=null,c=null}function p(){d.classList.remove("site-navigation__item--opened");const e=d.parentElement.children;s.textContent=c?.textContent;for(const t of e)t!==d&&t.classList.remove("site-navigation__item--hidden");d=null}!a&&n.matches&&u(l),n.addEventListener("change",(()=>{!a&&n.matches&&u(l)})),o.addEventListener("click",(e=>{if(!n.matches){const t=e.target.closest(".site-navigation__top-link--opener"),o=e.target.closest(".site-navigation__middle-link--opener");t&&(e.preventDefault(),u(t)),o&&(e.preventDefault(),d&&p(),function(e){d&&p();s.textContent=e.textContent,d=e.parentElement;const t=d.parentElement.children;d.classList.add("site-navigation__item--opened");for(const e of t)e!==d&&e.classList.add("site-navigation__item--hidden")}(o))}})),o.addEventListener("mouseover",(e=>{if(n.matches){const t=e.target.closest(".site-navigation__top-link--opener");t&&u(t)}})),i.addEventListener("click",(e=>{e.preventDefault(),d?p():a&&m()}));let h=0;const _=document.querySelector(".page__inner");_.addEventListener("scroll",throttle((()=>{const t=e.offsetHeight;_.scrollTop>0&&e.classList.add("site-header--sticked"),_.scrollTop>h&&_.scrollTop>t?e.classList.add("page__site-header--hidden"):(e.classList.remove("page__site-header--hidden"),0===_.scrollTop&&e.classList.remove("site-header--sticked")),h=_.scrollTop}),100))}function initStaticGalleryModal(e,t,o,n){const r=e.querySelector(".modal__gallery");let i=null;r&&(i=o(r)),document.querySelectorAll(n).forEach((o=>{o.addEventListener("click",(o=>{o.preventDefault();const n=o.target.closest("li");if(n&&i){const e=n.parentElement,t=Array.from(e.children).indexOf(n);i.slideTo(t,0)}t(e),i&&setTimeout((()=>{i.update()}),100)}))}))}function initSubscriptionForm(e,t,o,n,r){const i="button--pending",s=e.querySelector(".subscription__form-item .text-field__control"),l=e.querySelector(".subscription__form-submit-button"),a=e.getAttribute("action");s.dataset.pristineRequiredMessage="Заполните это поле.",s.dataset.pristineEmailMessage="Введите корректный e-mail адрес.";const c=new Pristine(e,{classTo:"subscription__form-item",errorClass:"invalid",errorTextParent:"subscription__form-item",errorTextTag:"p",errorTextClass:"prompt-text"});const d=r??function(){n(o,{heading:"Вы подписались"})};e.addEventListener("click",(e=>{const t=e.target.closest(".text-field__clear-button");if(t){const e=t.closest(".text-field").querySelector(".text-field__control");e.value="",e.focus()}})),e.addEventListener("submit",(r=>{r.preventDefault();c.validate()?(l.disabled=!0,l.classList.add(i),t(a,new FormData(r.target),(t=>{e.reset(),d(t)}),(()=>{n(o,{status:"error",heading:"Ошибка",text:"Не удалось подписаться, попробуйте снова."})}),(()=>{l.disabled=!1,l.classList.remove(i)}))):(e.classList.remove("subscription__form--error"),setTimeout((()=>e.classList.add("subscription__form--error")),50))}))}function initTaber(e,t){const o=e.querySelector(".taber__list"),n=Array.from(o.querySelectorAll(".taber__tab")),r=e.querySelectorAll(".taber__panel");o.setAttribute("role","tablist"),n.forEach(((e,o)=>{e.role="tab",e.id=`${t}-tab-${o+1}`,e.tabIndex=-1,e.parentNode.role="presentation"})),r.forEach(((e,t)=>{e.role="tabpanel",e.tabIndex=-1,e.setAttribute("aria-labelledby",n[t].id),e.classList.add("taber__panel--hidden")}));const i=(e,t,o)=>{if(e){e.ariaSelected=null,e.tabIndex=-1,e.classList.remove("taber__tab--active");const t=n.indexOf(e);r[t].classList.add("taber__panel--hidden")}o||t.focus(),t.tabIndex=0,t.ariaSelected=!0,t.classList.add("taber__tab--active");const i=n.indexOf(t);r[i].classList.remove("taber__panel--hidden")};(()=>{const e=window.location.hash,t=n.find((t=>t.hash===e));i(null,t||n[0],!0)})(),o.addEventListener("click",(e=>{e.preventDefault();const t=e.target.closest(".taber__tab");if(!t)return;const n=o.querySelector("[aria-selected]");t!==n&&i(n,t)}));const s=window.matchMedia("(min-width: 1346px)");o.addEventListener("keydown",(t=>{const o=n.indexOf(t.target);if(e.classList.contains("taber--vertical")&&s.matches){if(!isDownArrowEvent(t)&&!isRightArrowEvent(t)&&!isUpArrowEvent(t))return;if(t.preventDefault(),isRightArrowEvent(t))r[o].focus();else{const e=isUpArrowEvent(t)?o-1:o+1;if(!n[e])return;i(t.target,n[e])}}else if(isDownArrowEvent(t)||isLeftArrowEvent(t)||isRightArrowEvent(t))if(t.preventDefault(),isDownArrowEvent(t))r[o].focus();else{const e=isLeftArrowEvent(t)?o-1:o+1;if(!n[e])return;i(t.target,n[e])}}))}function initTelField(e){function t(e){return e.value.replace(/\D/g,"")}e.addEventListener("input",(function(e){const o=e.target;let n=t(o),r="";const i=o.selectionStart;if(!n)return void(o.value="");if(o.value.length!==i)return void(e.data&&/\D/g.test(e.data)&&(o.value=n));if(!["7","8","9"].includes(n[0]))return void(o.value=`+${n}`.substring(0,16));"9"===n[0]&&(n=`7${n}`),r=`${"8"===n[0]?"8":"+7"} `,n.length>1&&(r+=`(${n.substring(1,4)}`),n.length>=5&&(r+=`) ${n.substring(4,7)}`),n.length>=8&&(r+=`-${n.substring(7,9)}`),n.length>=10&&(r+=`-${n.substring(9,11)}`),o.value=r})),e.addEventListener("keydown",(function(e){const o=e.target;"Backspace"===e.code&&1===t(o).length&&(o.value="")})),e.addEventListener("paste",(function(e){const o=e.clipboardData||window.clipboardData,n=e.target,r=t(n);if(o){const e=o.getData("Text");/\D/g.test(e)&&(n.value=r)}}))}function initTextFieldWithList(e){const t=e.querySelector(".text-field__control"),o=e.querySelector(".text-field__data-list");function n(){o.classList.remove("text-field__data-list--open"),document.removeEventListener("click",r)}function r({target:e}){e.closest(".text-field")||n()}t.addEventListener("click",(()=>{o.classList.add("text-field__data-list--open"),document.addEventListener("click",r)})),o.addEventListener("click",(({target:e})=>{const o=e.closest(".text-field__data-link");o&&(t.value=o.textContent,t.dispatchEvent(new Event("input",{bubbles:!0})),n())}))}function initUserNavigation(e){const t=document.querySelector(".shortcuts__link--user");function o({target:e}){e.closest(".user-navigation")||e===t||n()}function n(){e.classList.remove("site-header__user-navigation--open"),document.removeEventListener("click",o)}t.addEventListener("click",(r=>{t.dataset.modalOpener||(r.preventDefault(),e.classList.contains("site-header__user-navigation--open")?n():(e.classList.add("site-header__user-navigation--open"),document.addEventListener("click",o)))}))}function initVideoReiewsSlider(e){const t=e.querySelector(".swiper"),o=e.querySelector(".slider-arrows__button--prev"),n=e.querySelector(".slider-arrows__button--next");new Swiper(t,{slidesPerView:"auto",spaceBetween:20,navigation:{prevEl:o,nextEl:n},watchSlidesProgress:!0,breakpoints:{1346:{spaceBetween:30},1900:{spaceBetween:40}}})}function initVideo(e){const t=e.querySelector(".video__poster"),o=e.querySelector(".video__play-button-wrapper"),n=e.querySelector(".video__play-button"),r=e.querySelector(".video__player");n.addEventListener("click",(()=>{r.play(),o.classList.add("video__play-button-wrapper--hidden"),t.classList.add("video__poster--hidden")})),r.addEventListener("ended",(()=>{o.classList.remove("video__play-button-wrapper--hidden"),t.classList.remove("video__poster--hidden")})),r.addEventListener("play",(()=>{document.querySelectorAll("video").forEach((e=>{e!==r&&e.pause()}))}))}document.querySelectorAll(".cart").forEach((e=>{initCart(e,openModal,showAlert,"undefined"!=typeof onCartFormSuccessSubmit?onCartFormSuccessSubmit:null,"undefined"!=typeof onCartFormErrorSubmit?onCartFormErrorSubmit:null)})),document.querySelectorAll(".reviews__list").forEach((e=>{initReviewsList(e,GalleryModal,initGallery,initVideo,openModal)})),document.querySelectorAll(".site-header").forEach(initSiteHeader),document.querySelectorAll(".premium-brands__slider").forEach(initPremiumBrandsSlider),document.querySelectorAll(".selection__slider").forEach(initSelectionSlider),document.querySelectorAll(".taber").forEach(((e,t)=>{initTaber(e,`taber-${t+1}`)})),document.querySelectorAll(".filter__slider").forEach(initFilterSlider),document.querySelectorAll(".banners").forEach(initBanners),document.querySelectorAll(".map").forEach(initMap),document.querySelectorAll(".product-card").forEach(initProductCard),document.querySelectorAll(".products").forEach(initProducts),document.querySelectorAll(".articles--with-slider").forEach(initArticlesSlider),document.querySelectorAll(".navigation-shortcuts").forEach(initNavigationShortcuts),document.querySelectorAll(".catalog-sorting").forEach(initCatalogSorting),document.querySelectorAll(".product-images").forEach(initProductImages),document.querySelectorAll(".product-header__action-buttons").forEach(initProductHeaderStickyActionButtons),document.querySelectorAll(".folds").forEach(initFolds),document.querySelectorAll(".text-field--date").forEach((e=>{initDateField(e,setInputDateMask)})),document.querySelectorAll(".scroll-container").forEach(initScrollContainer),document.querySelectorAll(".file-field").forEach(initFileField),document.querySelectorAll(".feed").forEach(initFeed),document.querySelectorAll(".video-reviews").forEach(initVideoReiewsSlider),document.querySelectorAll(".video").forEach(initVideo),document.querySelectorAll(".projects-slider").forEach(initProjectsSlider),document.querySelectorAll('input[type="tel"]').forEach(initTelField),document.querySelectorAll(".all-brands").forEach(initAllBrands),document.querySelectorAll(".profile-form").forEach((e=>{initProfileForm(e,sendData,openModal,showAlert,"undefined"!=typeof onProfileFormSuccessSubmit?onProfileFormSuccessSubmit:null)})),document.querySelectorAll(".feedback-form").forEach((e=>{initFeedbackForm(e,sendData,openModal,showAlert,"undefined"!=typeof onFeedbackFormSuccessSubmit?onFeedbackFormSuccessSubmit:null)})),document.querySelectorAll(".subscription__form").forEach((e=>{initSubscriptionForm(e,sendData,openModal,showAlert,"undefined"!=typeof onSubscriptionFormSuccessSubmit?onSubscriptionFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="cooperation"]').forEach((e=>{initCooperationModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onCooperationFormSuccessSubmit?onCooperationFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="feedback"]').forEach((e=>{initFeedbackModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onFeedbackFormSuccessSubmit?onFeedbackFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="salon"]').forEach((e=>{initSalonModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onSalonFormSuccessSubmit?onSalonFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="installment-request"]').forEach((e=>{initInstallmentRequestModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onInstallmentRequestFormSuccessSubmit?onInstallmentRequestFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="product-question"]').forEach((e=>{initProductQuestionModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onProductQuestionFormSuccessSubmit?onProductQuestionFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="one-click"]').forEach((e=>{initOneClickModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onOneClickFormSuccessSubmit?onOneClickFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="review"]').forEach((e=>{initReviewModal(e,sendData,openModal,closeModal,showAlert,initSimpleModalForm,"undefined"!=typeof onReviewFormSuccessSubmit?onReviewFormSuccessSubmit:null)})),document.querySelectorAll('[data-modal="catalog-filters"]').forEach((e=>{initCatalogFiltersModal(e,initScrollContainer,openModal,toggleFoldState)})),document.querySelectorAll(".modal--with_product-gallery").forEach((e=>{initStaticGalleryModal(e,openModal,initGallery,".product__images")})),document.querySelectorAll(".modal--with_selection-gallery").forEach((e=>{initStaticGalleryModal(e,openModal,initGallery,".selection__slider-list")})),document.querySelectorAll('[data-modal$="-document"]').forEach((e=>{initDocumentModal(e,openModal)})),document.querySelectorAll(".project").forEach((e=>{initProject(e,createProductCardTemplate,initProductCard,openModal,showAlert)})),document.querySelectorAll('[data-modal="search"]').forEach((e=>{initSearchModal(e,openModal,createProductCardTemplate,initProductCard,createArticlePreviewTemplate)})),document.querySelectorAll(".user-navigation").forEach(initUserNavigation),document.querySelectorAll('[data-modal="cities"]').forEach((e=>{initCitiesModal(e,initScrollContainer,openModal)})),document.querySelectorAll(".document-actions__button--print").forEach(initButtonPrintPdf);const signInModalElement=document.querySelector('[data-modal="sign-in"]');let signInModal;signInModalElement&&(signInModal=initSignInModal(signInModalElement,openModal,closeModal));const phoneChangeModalElement=document.querySelector('[data-modal="phone-change"]');let phoneChangeModal;phoneChangeModalElement&&(phoneChangeModal=initPhoneChangeModal(phoneChangeModalElement,openModal,closeModal)),document.querySelectorAll(".search-form--with-submit-button").forEach(initSearchFormWithSubmitButton);